!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SimpleViewerBundle={})}(this,function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}"function"==typeof SuppressedError&&SuppressedError;var n,a,o,r,i,l,s,u,d,c,f,h,m,g,v,$={exports:{}},p=f?$.exports:(f=1,n=$,window,o=function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.degToRad=function(e){return e*(Math.PI/180)},t.radToDeg=function(e){return e*(180/Math.PI)},t.sign=function(e){return"number"==typeof e?e?e<0?-1:1:e==e?0:NaN:NaN}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a,o,r,i,l,s,u,d,c=(a=n(3))&&a.__esModule?a:{default:a},f=n(0),h=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};h.prototype={constructor:h,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyAxisAngle:(s=void 0,function(e,t){return void 0===s&&(s=new c.default),this.applyQuaternion(s.setFromAxisAngle(e.normalize(),t)),this}),applyMatrix3:function(e){var t=this.x,n=this.y,a=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*a,this.y=o[1]*t+o[4]*n+o[7]*a,this.z=o[2]*t+o[5]*n+o[8]*a,this},applyMatrix4:function(e){var t=this.x,n=this.y,a=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*a+o[12],this.y=o[1]*t+o[5]*n+o[9]*a+o[13],this.z=o[2]*t+o[6]*n+o[10]*a+o[14],this},applyProjection:function(e){var t=this.x,n=this.y,a=this.z,o=e.elements,r=1/(o[3]*t+o[7]*n+o[11]*a+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*a+o[12])*r,this.y=(o[1]*t+o[5]*n+o[9]*a+o[13])*r,this.z=(o[2]*t+o[6]*n+o[10]*a+o[14])*r,this},applyQuaternion:function(e){var t=this.x,n=this.y,a=this.z,o=e.x,r=e.y,i=e.z,l=e.w,s=l*t+r*a-i*n,u=l*n+i*t-o*a,d=l*a+o*n-r*t,c=-o*t-r*n-i*a;return this.x=s*l+-(c*o)+-(u*i)- -(d*r),this.y=u*l+-(c*r)+-(d*o)- -(s*i),this.z=d*l+-(c*i)+-(s*r)- -(u*o),this},transformDirection:function(e){var t=this.x,n=this.y,a=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*a,this.y=o[1]*t+o[5]*n+o[9]*a,this.z=o[2]*t+o[6]*n+o[10]*a,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:(i=void 0,l=void 0,function(e,t){return void 0===i&&(i=new h,l=new h),i.set(e,e,e),l.set(t,t,t),this.clamp(i,l)}),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,a=this.y,o=this.z;return this.x=a*e.z-o*e.y,this.y=o*e.x-n*e.z,this.z=n*e.y-a*e.x,this},crossVectors:function(e,t){var n=e.x,a=e.y,o=e.z,r=t.x,i=t.y,l=t.z;return this.x=a*l-o*i,this.y=o*r-n*l,this.z=n*i-a*r,this},projectOnVector:(o=void 0,r=void 0,function(e){return void 0===o&&(o=new h),o.copy(e).normalize(),r=this.dot(o),this.copy(o).multiplyScalar(r)}),projectOnPlane:(u=void 0,function(e){return void 0===u&&(u=new h),u.copy(this).projectOnVector(e),this.sub(u)}),reflect:(d=void 0,function(e){return void 0===d&&(d=new h),this.sub(d.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos((0,f.clamp)(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,a=this.z-e.z;return t*t+n*n+a*a},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),a=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=a,this},setFromMatrixColumn:function(e,t){var n=4*e,a=t.elements;return this.x=a[n],this.y=a[n+1],this.z=a[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new h(this.x,this.y,this.z)}},t.default=h},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);function o(e){return e*e}function r(e,t){var n,a;return(n=e.x-t.x)*n+(a=e.y-t.y)*a}t.default={distanceToPoint:function(e,t){return Math.sqrt(function(e,t){var n=r(e.start,e.end);if(0===n)return r(t,e.start);var a=((t.x-e.start.x)*(e.end.x-e.start.x)+(t.y-e.start.y)*(e.end.y-e.start.y))/n;return r(t,a<0?e.start:a>1?e.end:{x:e.start.x+a*(e.end.x-e.start.x),y:e.start.y+a*(e.end.y-e.start.y)})}(e,t))},intersectLine:function(e,t){var n,o,r,i,l,s,u,d,c,f,h,m={},g=e.start.x,v=e.start.y,$=e.end.x,p=e.end.y,_=t.start.x,y=t.start.y,x=t.end.x,T=t.end.y,b=void 0;if(f=(n=p-v)*x+(r=g-$)*T+(l=$*v-g*p),(0===(c=n*_+r*y+l)||0===f||(0,a.sign)(c)!==(0,a.sign)(f))&&(d=(o=T-y)*$+(i=_-x)*p+(s=x*y-_*T),0===(u=o*g+i*v+s)||0===d||(0,a.sign)(u)!==(0,a.sign)(d))){h=n*i-o*r;var w=parseFloat((b=r*s-i*l)/h),C=parseFloat((b=o*l-n*s)/h);return m.x=w,m.y=C,m}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t,n,a){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==a?a:1};a.prototype.setFromAxisAngle=function(e,t){var n=t/2,a=Math.sin(n);return this.x=e.x*a,this.y=e.y*a,this.z=e.z*a,this.w=Math.cos(n),this},a.prototype.multiplyQuaternions=function(e,t){var n=e.x,a=e.y,o=e.z,r=e.w,i=t.x,l=t.y,s=t.z,u=t.w;return this.x=n*u+r*i+a*s-o*l,this.y=a*u+r*l+o*i-n*s,this.z=o*u+r*s+n*l-a*i,this.w=r*u-n*i-a*l-o*s,this},a.prototype.setFromRotationMatrix=function(e){var t=e.elements,n=t[0],a=t[4],o=t[8],r=t[1],i=t[5],l=t[9],s=t[2],u=t[6],d=t[10],c=n+i+d,f=void 0;return c>0?(f=.5/Math.sqrt(c+1),this.w=.25/f,this.x=(u-l)*f,this.y=(o-s)*f,this.z=(r-a)*f):n>i&&n>d?(f=2*Math.sqrt(1+n-i-d),this.w=(u-l)/f,this.x=.25*f,this.y=(a+r)/f,this.z=(o+s)/f):i>d?(f=2*Math.sqrt(1+i-n-d),this.w=(o-s)/f,this.x=(a+r)/f,this.y=.25*f,this.z=(l+u)/f):(f=2*Math.sqrt(1+d-n-i),this.w=(r-a)/f,this.x=(o+s)/f,this.y=(l+u)/f,this.z=.25*f),this},t.default=a},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a,o=(a=n(2))&&a.__esModule?a:{default:a};function r(e){return{topLeft:{x:e.left,y:e.top},bottomRight:{x:e.left+e.width,y:e.top+e.height}}}t.default={distanceToPoint:function(e,t){var n,a=655535;return[{start:{x:(n=e).left,y:n.top},end:{x:n.left+n.width,y:n.top}},{start:{x:n.left+n.width,y:n.top},end:{x:n.left+n.width,y:n.top+n.height}},{start:{x:n.left+n.width,y:n.top+n.height},end:{x:n.left,y:n.top+n.height}},{start:{x:n.left,y:n.top+n.height},end:{x:n.left,y:n.top}}].forEach(function(e){var n=o.default.distanceToPoint(e,t);n<a&&(a=n)}),a},getIntersectionRect:function(e,t){var n,a,o,i,l,s,u={topLeft:{},bottomRight:{}};if(n=e,a=t,o=void 0,i=void 0,l=r(n),s=r(a),o=n.width>=0?a.width>=0?!(l.bottomRight.x<=s.topLeft.x||s.bottomRight.x<=l.topLeft.x):!(l.bottomRight.x<=s.bottomRight.x||s.topLeft.x<=l.topLeft.x):a.width>=0?!(l.topLeft.x<=s.topLeft.x||s.bottomRight.x<=l.bottomRight.x):!(l.topLeft.x<=s.bottomRight.x||s.topLeft.x<=l.bottomRight.x),i=n.height>=0?a.height>=0?!(l.bottomRight.y<=s.topLeft.y||s.bottomRight.y<=l.topLeft.y):!(l.bottomRight.y<=s.bottomRight.y||s.topLeft.y<=l.topLeft.y):a.height>=0?!(l.topLeft.y<=s.topLeft.y||s.bottomRight.y<=l.bottomRight.y):!(l.topLeft.y<=s.bottomRight.y||s.top<=l.bottomRight.y),o&&i){var d=r(e),c=r(t);return e.width>=0?t.width>=0?(u.topLeft.x=Math.max(d.topLeft.x,c.topLeft.x),u.bottomRight.x=Math.min(d.bottomRight.x,c.bottomRight.x)):(u.topLeft.x=Math.max(d.topLeft.x,c.bottomRight.x),u.bottomRight.x=Math.min(d.bottomRight.x,c.topLeft.x)):t.width>=0?(u.topLeft.x=Math.min(d.topLeft.x,c.bottomRight.x),u.bottomRight.x=Math.max(d.bottomRight.x,c.topLeft.x)):(u.topLeft.x=Math.min(d.topLeft.x,c.topLeft.x),u.bottomRight.x=Math.max(d.bottomRight.x,c.bottomRight.x)),e.height>=0?t.height>=0?(u.topLeft.y=Math.max(d.topLeft.y,c.topLeft.y),u.bottomRight.y=Math.min(d.bottomRight.y,c.bottomRight.y)):(u.topLeft.y=Math.max(d.topLeft.y,c.bottomRight.y),u.bottomRight.y=Math.min(d.bottomRight.y,c.topLeft.y)):t.height>=0?(u.topLeft.y=Math.min(d.topLeft.y,c.bottomRight.y),u.bottomRight.y=Math.max(d.bottomRight.y,c.topLeft.y)):(u.topLeft.y=Math.min(d.topLeft.y,c.topLeft.y),u.bottomRight.y=Math.max(d.bottomRight.y,c.bottomRight.y)),u}}}},function(e,t,n){function a(e,t){return{x:e.x-t.x,y:e.y-t.y}}function o(e,t){return Math.sqrt(r(e,t))}function r(e,t){var n=a(e,t);return n.x*n.x+n.y*n.y}Object.defineProperty(t,"__esModule",{value:!0}),t.default={subtract:a,copy:function(e){return{x:e.x,y:e.y}},pageToPoint:function(e){return{x:e.pageX,y:e.pageY}},distance:o,distanceSquared:r,insideRect:function(e,t){return!(e.x<t.left||e.x>t.left+t.width||e.y<t.top||e.y>t.top+t.height)},findClosestPoint:function(e,t){var n=[],a=void 0;return e.forEach(function(e,r){var i=o(e,t);n.push(i),a=0===r?i:Math.min(i,a)}),e[n.indexOf(a)]}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a,o,r,i,l=(a=n(1))&&a.__esModule?a:{default:a},s=function(e,t){this.normal=void 0!==e?e:new l.default(1,0,0),this.constant=void 0!==t?t:0};s.prototype={constructor:s,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,a){return this.normal.set(e,t,n),this.constant=a,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(o=new l.default,r=new l.default,function(e,t,n){var a=o.subVectors(n,t).cross(r.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e);return(t||new l.default).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectLine:(i=new l.default,function(e,t){var n=t||new l.default,a=e.delta(i),o=this.normal.dot(a);if(0===o)return 0===this.distanceToPoint(e.start)?n.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/o;return r<0||r>1?void 0:n.copy(a).multiplyScalar(r).add(e.start)}),intersectPlane:function(e){var t=this.normal.clone().cross(e.normal),n={origin:new l.default,direction:t};if(this.normal.clone().cross(e.normal).length<1e-10)return n.direction=new l.default,n;var a=this.constant,o=e.constant,r=this.normal.clone().dot(e.normal);return n.origin=this.normal.clone().multiplyScalar(-(a-o*r)/(1-r*r)).add(e.normal.clone().multiplyScalar(-(o-a*r)/(1-r*r))),n},coplanarPoint:function(e){return(e||new l.default).copy(this.normal).multiplyScalar(-this.constant)},translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},clone:function(){return(new s).copy(this)}},t.default=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a,o=(a=n(1))&&a.__esModule?a:{default:a},r=function(e,t,n,a,o,r,i,l,s,u,d,c,f,h,m,g){this.elements=new Float32Array(16);var v=this.elements;v[0]=void 0!==e?e:1,v[4]=t||0,v[8]=n||0,v[12]=a||0,v[1]=o||0,v[5]=void 0!==r?r:1,v[9]=i||0,v[13]=l||0,v[2]=s||0,v[6]=u||0,v[10]=void 0!==d?d:1,v[14]=c||0,v[3]=f||0,v[7]=h||0,v[11]=m||0,v[15]=void 0!==g?g:1};r.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,n=e.x,a=e.y,o=e.z,r=e.w,i=n+n,l=a+a,s=o+o,u=n*i,d=n*l,c=n*s,f=a*l,h=a*s,m=o*s,g=r*i,v=r*l,$=r*s;return t[0]=1-(f+m),t[4]=d-$,t[8]=c+v,t[1]=d+$,t[5]=1-(u+m),t[9]=h-g,t[2]=c-v,t[6]=h+g,t[10]=1-(u+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},r.prototype.multiplyMatrices=function(e,t){var n=e.elements,a=t.elements,o=this.elements,r=n[0],i=n[4],l=n[8],s=n[12],u=n[1],d=n[5],c=n[9],f=n[13],h=n[2],m=n[6],g=n[10],v=n[14],$=n[3],p=n[7],_=n[11],y=n[15],x=a[0],T=a[4],b=a[8],w=a[12],C=a[1],E=a[5],j=a[9],S=a[13],I=a[2],P=a[6],M=a[10],k=a[14],D=a[3],L=a[7],R=a[11],A=a[15];return o[0]=r*x+i*C+l*I+s*D,o[4]=r*T+i*E+l*P+s*L,o[8]=r*b+i*j+l*M+s*R,o[12]=r*w+i*S+l*k+s*A,o[1]=u*x+d*C+c*I+f*D,o[5]=u*T+d*E+c*P+f*L,o[9]=u*b+d*j+c*M+f*R,o[13]=u*w+d*S+c*k+f*A,o[2]=h*x+m*C+g*I+v*D,o[6]=h*T+m*E+g*P+v*L,o[10]=h*b+m*j+g*M+v*R,o[14]=h*w+m*S+g*k+v*A,o[3]=$*x+p*C+_*I+y*D,o[7]=$*T+p*E+_*P+y*L,o[11]=$*b+p*j+_*M+y*R,o[15]=$*w+p*S+_*k+y*A,this},r.prototype.multiply=function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},r.prototype.getInverse=function(e,t){var n=this.elements,a=e.elements,o=a[0],r=a[4],i=a[8],l=a[12],s=a[1],u=a[5],d=a[9],c=a[13],f=a[2],h=a[6],m=a[10],g=a[14],v=a[3],$=a[7],p=a[11],_=a[15];n[0]=d*g*$-c*m*$+c*h*p-u*g*p-d*h*_+u*m*_,n[4]=l*m*$-i*g*$-l*h*p+r*g*p+i*h*_-r*m*_,n[8]=i*c*$-l*d*$+l*u*p-r*c*p-i*u*_+r*d*_,n[12]=l*d*h-i*c*h-l*u*m+r*c*m+i*u*g-r*d*g,n[1]=c*m*v-d*g*v-c*f*p+s*g*p+d*f*_-s*m*_,n[5]=i*g*v-l*m*v+l*f*p-o*g*p-i*f*_+o*m*_,n[9]=l*d*v-i*c*v-l*s*p+o*c*p+i*s*_-o*d*_,n[13]=i*c*f-l*d*f+l*s*m-o*c*m-i*s*g+o*d*g,n[2]=u*g*v-c*h*v+c*f*$-s*g*$-u*f*_+s*h*_,n[6]=l*h*v-r*g*v-l*f*$+o*g*$+r*f*_-o*h*_,n[10]=r*c*v-l*u*v+l*s*$-o*c*$-r*s*_+o*u*_,n[14]=l*u*f-r*c*f-l*s*h+o*c*h+r*s*g-o*u*g,n[3]=d*h*v-u*m*v-d*f*$+s*m*$+u*f*p-s*h*p,n[7]=r*m*v-i*h*v+i*f*$-o*m*$-r*f*p+o*h*p,n[11]=i*u*v-r*d*v-i*s*$+o*d*$+r*s*p-o*u*p,n[15]=r*d*f-i*u*f+i*s*h-o*d*h-r*s*m+o*u*m;var y=o*n[0]+s*n[4]+f*n[8]+v*n[12];if(0===y){var x="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw Error(x);return console.warn(x),this.identity(),this}return this.multiplyScalar(1/y),this},r.prototype.applyToVector3Array=function(){var e=new o.default;return function(t,n,a){void 0===n&&(n=0),void 0===a&&(a=t.length);for(var o=0,r=n;o<a;o+=3,r+=3)e.x=t[r],e.y=t[r+1],e.z=t[r+2],e.applyMatrix4(this),t[r]=e.x,t[r+1]=e.y,t[r+2]=e.z;return t}},r.prototype.makeTranslation=function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},r.prototype.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},r.prototype.set=function(e,t,n,a,o,r,i,l,s,u,d,c,f,h,m,g){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=a,v[1]=o,v[5]=r,v[9]=i,v[13]=l,v[2]=s,v[6]=u,v[10]=d,v[14]=c,v[3]=f,v[7]=h,v[11]=m,v[15]=g,this},r.prototype.makeScale=function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},t.default=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=(a=n(1))&&a.__esModule?a:{default:a},i=n(0),l=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),this.start=void 0!==t?t:new r.default,this.end=void 0!==n?n:new r.default}return o(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"center",value:function(e){return(e||new r.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return(e||new r.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){var n=t||new r.default;return this.delta(n).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){var n=new r.default,a=new r.default;n.subVectors(e,this.start),a.subVectors(this.end,this.start);var o=a.dot(a),l=a.dot(n)/o;return t&&(l=(0,i.clamp)(l,0,1)),l}},{key:"closestPointToPoint",value:function(e,t,n){var a=this.closestPointToPointParameter(e,t),o=n||new r.default;return this.delta(o).multiplyScalar(a).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"intersectLine",value:function(e){var t=this.end.clone().sub(this.start),n=e.end.clone().sub(e.start),a=e.start.clone().sub(this.start),o=t.clone().cross(n),r=a.clone().cross(n);if(0!==a.dot(t)){var i=r.dot(o)/o.lengthSq();if(!(i>1||isNaN(i))){var l=this.start.clone().add(t.clone().multiplyScalar(i));return l.clone().sub(e.start).lengthSq()+l.clone().sub(e.end).lengthSq()<=e.distanceSq()?l:void 0}}}}]),e}();t.default=l},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Vector3=t.rect=t.quaternion=t.point=t.Plane=t.Matrix4=t.sign=t.radToDeg=t.degToRad=t.clamp=t.lineSegment=t.Line3=void 0;var a=f(n(8)),o=f(n(2)),r=n(0),i=f(n(7)),l=f(n(6)),s=f(n(5)),u=f(n(3)),d=f(n(4)),c=f(n(1));function f(e){return e&&e.__esModule?e:{default:e}}var h={Line3:a.default,lineSegment:o.default,clamp:r.clamp,degToRad:r.degToRad,radToDeg:r.radToDeg,sign:r.sign,Matrix4:i.default,Plane:l.default,point:s.default,quaternion:u.default,rect:d.default,Vector3:c.default};t.Line3=a.default,t.lineSegment=o.default,t.clamp=r.clamp,t.degToRad=r.degToRad,t.radToDeg=r.radToDeg,t.sign=r.sign,t.Matrix4=i.default,t.Plane=l.default,t.point=s.default,t.quaternion=u.default,t.rect=d.default,t.Vector3=c.default,t.default=h}])},n.exports=o(),$.exports),_=t(p),y={exports:{}},x=h?y.exports:(h=1,r=y,!function(e,t,n,a){var o,i=["","webkit","Moz","MS","ms","o"],l=t.createElement("div"),s=Math.round,u=Math.abs,d=Date.now;function c(e,t,n){return setTimeout(p(e,n),t)}function f(e,t,n){return!!Array.isArray(e)&&(h(e,n[t],n),!0)}function h(e,t,n){var o;if(e){if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(o=0;o<e.length;)t.call(n,e[o],o,e),o++;else for(o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e)}}function m(t,n,a){var o="DEPRECATED METHOD: "+n+"\n"+a+" AT \n";return function(){var n=Error("get-stack-trace"),a=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=e.console&&(e.console.warn||e.console.log);return r&&r.call(e.console,o,a),t.apply(this,arguments)}}o="function"!=typeof Object.assign?function e(t){if(t===a||null===t)throw TypeError("Cannot convert undefined or null to object");for(var n=Object(t),o=1;o<arguments.length;o++){var r=arguments[o];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])}return n}:Object.assign;var g=m(function e(t,n,o){for(var r=Object.keys(n),i=0;i<r.length;)(!o||o&&t[r[i]]===a)&&(t[r[i]]=n[r[i]]),i++;return t},"extend","Use `assign`."),v=m(function e(t,n){return g(t,n,!0)},"merge","Use `assign`.");function $(e,t,n){var a,r=t.prototype;(a=e.prototype=Object.create(r)).constructor=e,a._super=r,n&&o(a,n)}function p(e,t){return function n(){return e.apply(t,arguments)}}function _(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function y(e,t){return e===a?t:e}function x(e,t,n){h(C(t),function(t){e.addEventListener(t,n,!1)})}function T(e,t,n){h(C(t),function(t){e.removeEventListener(t,n,!1)})}function b(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function w(e,t){return e.indexOf(t)>-1}function C(e){return e.trim().split(/\s+/g)}function E(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var a=0;a<e.length;){if(n&&e[a][n]==t||!n&&e[a]===t)return a;a++}return -1}function j(e){return Array.prototype.slice.call(e,0)}function S(e,t,n){for(var a=[],o=[],r=0;r<e.length;){var i=e[r][t];0>E(o,i)&&a.push(e[r]),o[r]=i,r++}return a.sort(function e(n,a){return n[t]>a[t]})}function I(e,t){for(var n,o,r=t[0].toUpperCase()+t.slice(1),l=0;l<i.length;){if((o=(n=i[l])?n+r:t)in e)return o;l++}return a}var P=1;function M(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var k="ontouchstart"in e,D=I(e,"PointerEvent")!==a,L=k&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),R="touch",A="mouse",O=30,H=["x","y"],B=["clientX","clientY"];function U(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){_(e.options.enable,[e])&&n.handler(t)},this.init()}function F(e,t,n){var o,r,i,l,s,c,f,h,m,g,v,$,p,_,y,x,T,w,C,E,j,S=n.pointers.length,I=n.changedPointers.length,P=1&t&&S-I==0;n.isFirst=!!P,n.isFinal=!!(12&t&&S-I==0),P&&(e.session={}),n.eventType=t,o=e,r=n,i=o.session,s=(l=r.pointers).length,i.firstInput||(i.firstInput=N(r)),s>1&&!i.firstMultiple?i.firstMultiple=N(r):1===s&&(i.firstMultiple=!1),c=i.firstInput,h=(f=i.firstMultiple)?f.center:c.center,m=r.center=z(l),r.timeStamp=d(),r.deltaTime=r.timeStamp-c.timeStamp,r.angle=G(h,m),r.distance=W(h,m),g=i,$=(v=r).center,p=g.offsetDelta||{},_=g.prevDelta||{},y=g.prevInput||{},(1===v.eventType||4===y.eventType)&&(_=g.prevDelta={x:y.deltaX||0,y:y.deltaY||0},p=g.offsetDelta={x:$.x,y:$.y}),v.deltaX=_.x+($.x-p.x),v.deltaY=_.y+($.y-p.y),r.offsetDirection=q(r.deltaX,r.deltaY),x=V(r.deltaTime,r.deltaX,r.deltaY),r.overallVelocityX=x.x,r.overallVelocityY=x.y,r.overallVelocity=u(x.x)>u(x.y)?x.x:x.y,r.scale=f?(T=f.pointers,w=l,W(w[0],w[1],B)/W(T[0],T[1],B)):1,r.rotation=f?(C=f.pointers,E=l,G(E[1],E[0],B)+G(C[1],C[0],B)):0,r.maxPointers=i.prevInput?r.pointers.length>i.prevInput.maxPointers?r.pointers.length:i.prevInput.maxPointers:r.pointers.length,function e(t,n){var o,r,i,l,s=t.lastInterval||n,d=n.timeStamp-s.timeStamp;if(8!=n.eventType&&(d>25||s.velocity===a)){var c=n.deltaX-s.deltaX,f=n.deltaY-s.deltaY,h=V(d,c,f);r=h.x,i=h.y,o=u(h.x)>u(h.y)?h.x:h.y,l=q(c,f),t.lastInterval=n}else o=s.velocity,r=s.velocityX,i=s.velocityY,l=s.direction;n.velocity=o,n.velocityX=r,n.velocityY=i,n.direction=l}(i,r),j=o.element,b(r.srcEvent.target,j)&&(j=r.srcEvent.target),r.target=j,e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function N(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:s(e.pointers[n].clientX),clientY:s(e.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:t,center:z(t),deltaX:e.deltaX,deltaY:e.deltaY}}function z(e){var t=e.length;if(1===t)return{x:s(e[0].clientX),y:s(e[0].clientY)};for(var n=0,a=0,o=0;o<t;)n+=e[o].clientX,a+=e[o].clientY,o++;return{x:s(n/t),y:s(a/t)}}function V(e,t,n){return{x:t/e||0,y:n/e||0}}function q(e,t){return e===t?1:u(e)>=u(t)?e<0?2:4:t<0?8:16}function W(e,t,n){n||(n=H);var a=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(a*a+o*o)}function G(e,t,n){n||(n=H);var a=t[n[0]]-e[n[0]];return 180*Math.atan2(t[n[1]]-e[n[1]],a)/Math.PI}U.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(M(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4};function X(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,U.apply(this,arguments)}$(X,U,{handler:function e(t){var n=Y[t.type];1&n&&0===t.button&&(this.pressed=!0),2&n&&1!==t.which&&(n=4),this.pressed&&(4&n&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[t],changedPointers:[t],pointerType:A,srcEvent:t}))}});var Z={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},K={2:R,3:"pen",4:A,5:"kinect"},J="pointerdown",Q="pointermove pointerup pointercancel";function ee(){this.evEl=J,this.evWin=Q,U.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(J="MSPointerDown",Q="MSPointerMove MSPointerUp MSPointerCancel"),$(ee,U,{handler:function e(t){var n=this.store,a=!1,o=Z[t.type.toLowerCase().replace("ms","")],r=K[t.pointerType]||t.pointerType,i=E(n,t.pointerId,"pointerId");1&o&&(0===t.button||r==R)?i<0&&(n.push(t),i=n.length-1):12&o&&(a=!0),!(i<0)&&(n[i]=t,this.callback(this.manager,o,{pointers:n,changedPointers:[t],pointerType:r,srcEvent:t}),a&&n.splice(i,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function en(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,U.apply(this,arguments)}function ea(e,t){var n=j(e.touches),a=j(e.changedTouches);return 12&t&&(n=S(n.concat(a),"identifier")),[n,a]}$(en,U,{handler:function e(t){var n=et[t.type];if(1===n&&(this.started=!0),this.started){var a=ea.call(this,t,n);12&n&&a[0].length-a[1].length==0&&(this.started=!1),this.callback(this.manager,n,{pointers:a[0],changedPointers:a[1],pointerType:R,srcEvent:t})}}});var eo={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function er(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},U.apply(this,arguments)}function ei(e,t){var n=j(e.touches),a=this.targetIds;if(3&t&&1===n.length)return a[n[0].identifier]=!0,[n,n];var o,r,i=j(e.changedTouches),l=[],s=this.target;if(r=n.filter(function(e){return b(e.target,s)}),1===t)for(o=0;o<r.length;)a[r[o].identifier]=!0,o++;for(o=0;o<i.length;)a[i[o].identifier]&&l.push(i[o]),12&t&&delete a[i[o].identifier],o++;if(l.length)return[S(r.concat(l),"identifier"),l]}function el(){U.apply(this,arguments);var e=p(this.handler,this);this.touch=new er(this.manager,e),this.mouse=new X(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function es(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,eu.call(this,t)):12&e&&eu.call(this,t)}function eu(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var a=this.lastTouches;setTimeout(function(){var e=a.indexOf(n);e>-1&&a.splice(e,1)},2500)}}function ed(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var o=this.lastTouches[a],r=Math.abs(t-o.x),i=Math.abs(n-o.y);if(r<=25&&i<=25)return!0}return!1}$(er,U,{handler:function e(t){var n=eo[t.type],a=ei.call(this,t,n);a&&this.callback(this.manager,n,{pointers:a[0],changedPointers:a[1],pointerType:R,srcEvent:t})}}),$(el,U,{handler:function e(t,n,a){var o=a.pointerType==R,r=a.pointerType==A;if(!r||!a.sourceCapabilities||!a.sourceCapabilities.firesTouchEvents){if(o)es.call(this,n,a);else if(r&&ed.call(this,a))return;this.callback(t,n,a)}},destroy:function e(){this.touch.destroy(),this.mouse.destroy()}});var ec=I(l.style,"touchAction"),ef=ec!==a,eh="compute",em="auto",eg="manipulation",ev="none",e$="pan-x",ep="pan-y",e3=function t(){if(!ef)return!1;var n={},a=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(t){n[t]=!a||e.CSS.supports("touch-action",t)}),n}();function e_(e,t){this.manager=e,this.set(t)}function e0(e){this.options=o({},this.defaults,e||{}),this.id=P++,this.manager=null,this.options.enable=y(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ey(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ex(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function eT(e,t){var n=t.manager;return n?n.get(e):e}function eb(){e0.apply(this,arguments)}function ew(){eb.apply(this,arguments),this.pX=null,this.pY=null}function eC(){eb.apply(this,arguments)}function eE(){e0.apply(this,arguments),this._timer=null,this._input=null}function ej(){eb.apply(this,arguments)}function e2(){eb.apply(this,arguments)}function eS(){e0.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eI(e,t){return(t=t||{}).recognizers=y(t.recognizers,eI.defaults.preset),new e6(e,t)}function e6(e,t){var n,a,r;this.options=o({},eI.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=(n=this,new(a=(r=n.options.inputClass)||(D?ee:L?er:k?el:X))(n,F)),this.touchAction=new e_(this,this.options.touchAction),e4(this,!0),h(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function e4(e,t){var n,a=e.element;a.style&&(h(e.options.cssProps,function(o,r){n=I(a.style,r),t?(e.oldCssProps[n]=a.style[n],a.style[n]=o):a.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}e_.prototype={set:function(e){e==eh&&(e=this.compute()),ef&&this.manager.element.style&&e3[e]&&(this.manager.element.style[ec]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return h(this.manager.recognizers,function(t){_(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function e(t){if(w(t,ev))return ev;var n=w(t,e$),a=w(t,ep);return n&&a?ev:n||a?n?e$:ep:w(t,eg)?eg:em}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var a=this.actions,o=w(a,ev)&&!e3[ev],r=w(a,ep)&&!e3[ep],i=w(a,e$)&&!e3[e$];if(o){var l=1===e.pointers.length,s=e.distance<2,u=e.deltaTime<250;if(l&&s&&u)return}if((!i||!r)&&(o||r&&6&n||i&&24&n))return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},e0.prototype={defaults:{},set:function(e){return o(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(f(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=eT(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return f(e,"dropRecognizeWith",this)||(e=eT(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(f(e,"requireFailure",this))return this;var t=this.requireFail;return -1===E(t,e=eT(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(f(e,"dropRequireFailure",this))return this;e=eT(e,this);var t=E(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function a(n){t.manager.emit(n,e)}n<8&&a(t.options.event+ey(n)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),n>=8&&a(t.options.event+ey(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=o({},e);if(!_(this.options.enable,[this,t])){this.reset(),this.state=32;return}56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},$(eb,e0,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,a=6&t,o=this.attrTest(e);return a&&(8&n||!o)?16|t:a||o?4&n?8|t:2&t?4|t:2:32}}),$(ew,eb,{defaults:{event:"pan",threshold:10,pointers:1,direction:O},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(ep),24&e&&t.push(e$),t},directionTest:function(e){var t=this.options,n=!0,a=e.distance,o=e.direction,r=e.deltaX,i=e.deltaY;return o&t.direction||(6&t.direction?(o=0===r?1:r<0?2:4,n=r!=this.pX,a=Math.abs(e.deltaX)):(o=0===i?1:i<0?8:16,n=i!=this.pY,a=Math.abs(e.deltaY))),e.direction=o,n&&a>t.threshold&&o&t.direction},attrTest:function(e){return eb.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ex(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),$(eC,eb,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ev]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),$(eE,e0,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[em]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,a&&n&&(!(12&e.eventType)||o)){if(1&e.eventType)this.reset(),this._timer=c(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8}else this.reset();return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),$(ej,eb,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ev]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),$(e2,eb,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ew.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&u(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ex(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),$(eS,e0,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[eg]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(a&&o&&n){if(4!=e.eventType)return this.failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,i=!this.pCenter||W(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,i&&r?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=c(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=c(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eI.VERSION="2.0.7",eI.defaults={domEvents:!1,touchAction:eh,enable:!0,inputTarget:null,inputClass:null,preset:[[ej,{enable:!1}],[eC,{enable:!1},["rotate"]],[e2,{direction:6}],[ew,{direction:6},["swipe"]],[eS],[eS,{event:"doubletap",taps:2},["tap"]],[eE]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e6.prototype={set:function(e){return o(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t,n=this.session;if(!n.stopped){this.touchAction.preventDefaults(e);var a=this.recognizers,o=n.curRecognizer;(!o||o&&8&o.state)&&(o=n.curRecognizer=null);for(var r=0;r<a.length;)t=a[r],2!==n.stopped&&(!o||t==o||t.canRecognizeWith(o))?t.recognize(e):t.reset(),!o&&14&t.state&&(o=n.curRecognizer=t),r++}},get:function(e){if(e instanceof e0)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(f(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(f(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=E(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return h(C(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==a){var n=this.handlers;return h(C(e),function(e){t?n[e]&&n[e].splice(E(n[e],t),1):delete n[e]}),this}},emit:function(e,n){this.options.domEvents&&(a=e,o=n,r=t.createEvent("Event"),r.initEvent(a,!0,!0),r.gesture=o,o.target.dispatchEvent(r));var a,o,r,i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var l=0;l<i.length;)i[l](n),l++}},destroy:function(){this.element&&e4(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},o(eI,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:O,Manager:e6,Input:U,TouchAction:e_,TouchInput:er,MouseInput:X,PointerEventInput:ee,TouchMouseInput:el,SingleTouchInput:en,Recognizer:e0,AttrRecognizer:eb,Tap:eS,Pan:ew,Swipe:e2,Pinch:eC,Rotate:ej,Press:eE,on:x,off:T,each:h,merge:v,extend:g,assign:o,inherit:$,bindFn:p,prefixed:I}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=eI,r.exports?r.exports=eI:e[n]=eI}(window,document,"Hammer"),y.exports),T=t(x),b={exports:{}},w=m?b.exports:(m=1,i=b,window,s=function(){return function(e){var t,n,a,o,r=window.webpackHotUpdate;window.webpackHotUpdate=function e(t,n){(function e(t,n){if(_[t]&&p[t]){for(var o in p[t]=!1,n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o]);0==--g&&0===v&&b()}})(t,n),r&&r(t,n)};var i=!0,l="4d8d88ba53621f59b9a9",s={},u=[],d=[];function c(e){var n=C[e];if(!n)return E;var a=function(a){return n.hot.active?(C[a]?-1===C[a].parents.indexOf(e)&&C[a].parents.push(e):(u=[e],t=a),-1===n.children.indexOf(a)&&n.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),u=[]),E(a)},o=function e(t){return{configurable:!0,enumerable:!0,get:function(){return E[t]},set:function(e){E[t]=e}}};for(var r in E)Object.prototype.hasOwnProperty.call(E,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(a,r,o(r));return a.e=function(e){return"ready"===h&&m("prepare"),v++,E.e(e).then(t,function(e){throw t(),e});function t(){v--,"prepare"===h&&($[e]||T(e),0===v&&0===g&&b())}},a.t=function(e,t){return 1&t&&(e=a(e)),E.t(e,-2&t)},a}var f=[],h="idle";function m(e){h=e;for(var t=0;t<f.length;t++)f[t].call(null,e)}var g=0,v=0,$={},p={},_={};function y(e){return+e+""===e?+e:e}function x(e){if("idle"!==h)throw Error("check() is only allowed in idle status");i=e,m("check");var t=1e4;return(t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(Error("No browser support"));try{var a=new XMLHttpRequest,o=E.p+""+l+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(r){return n(r)}a.onreadystatechange=function(){if(4===a.readyState){if(0===a.status)n(Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){n(r);return}e(t)}}}})).then(function(e){if(!e)return m("idle"),null;p={},$={},_=e.c,o=e.h,m("prepare");var t=new Promise(function(e,t){n={resolve:e,reject:t}});return a={},T("cornerstone"),"prepare"===h&&0===v&&0===g&&b(),t})}function T(e){if(_[e]){var t,n,a;p[e]=!0,g++,t=e,n=document.getElementsByTagName("head")[0],(a=document.createElement("script")).charset="utf-8",a.src=E.p+""+t+"."+l+".hot-update.js",n.appendChild(a)}else $[e]=!0}function b(){m("ready");var e=n;if(n=null,e){if(i)Promise.resolve().then(function(){return w(i)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&t.push(y(o));e.resolve(t)}}}function w(t){if("ready"!==h)throw Error("apply() is only allowed in ready status");function n(e){for(var t=[e],n={},a=t.slice().map(function(e){return{chain:[e],id:e}});a.length>0;){var o=a.pop(),i=o.id,l=o.chain;if((w=C[i])&&!w.hot._selfAccepted){if(w.hot._selfDeclined)return{type:"self-declined",chain:l,moduleId:i};if(w.hot._main)return{type:"unaccepted",chain:l,moduleId:i};for(var s=0;s<w.parents.length;s++){var u=w.parents[s],d=C[u];if(d){if(d.hot._declinedDependencies[i])return{type:"declined",chain:l.concat([u]),moduleId:i,parentId:u};if(-1===t.indexOf(u)){if(d.hot._acceptedDependencies[i]){n[u]||(n[u]=[]),r(n[u],[i]);continue}delete n[u],t.push(u),a.push({chain:l.concat([u]),id:u})}}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var i,d,c,f={},g=[],v={},$=function e(){console.warn("[HMR] unexpected require("+S.moduleId+") to disposed module")};for(var p in a)if(Object.prototype.hasOwnProperty.call(a,p)){j=y(p),S=a[p]?n(j):{type:"disposed",moduleId:p};var x,T,b,w,j,S,I=!1,P=!1,M=!1,k="";switch(S.chain&&(k="\nUpdate propagation: "+S.chain.join(" -> ")),S.type){case"self-declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(I=Error("Aborted because of self decline: "+S.moduleId+k));break;case"declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(I=Error("Aborted because of declined dependency: "+S.moduleId+" in "+S.parentId+k));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(S),t.ignoreUnaccepted||(I=Error("Aborted because "+j+" is not accepted"+k));break;case"accepted":t.onAccepted&&t.onAccepted(S),P=!0;break;case"disposed":t.onDisposed&&t.onDisposed(S),M=!0;break;default:throw Error("Unexception type "+S.type)}if(I)return m("abort"),Promise.reject(I);if(P)for(j in v[j]=a[j],r(g,S.outdatedModules),S.outdatedDependencies)Object.prototype.hasOwnProperty.call(S.outdatedDependencies,j)&&(f[j]||(f[j]=[]),r(f[j],S.outdatedDependencies[j]));M&&(r(g,[S.moduleId]),v[j]=$)}var D=[];for(T=0;T<g.length;T++)C[j=g[T]]&&C[j].hot._selfAccepted&&D.push({module:j,errorHandler:C[j].hot._selfAccepted});m("dispose"),Object.keys(_).forEach(function(e){if(!1===_[e]){var t;t=e,delete installedChunks[t]}});for(var L=g.slice();L.length>0;)if(w=C[j=L.pop()]){var R={},A=w.hot._disposeHandlers;for(b=0;b<A.length;b++)(x=A[b])(R);for(s[j]=R,w.hot.active=!1,delete C[j],delete f[j],b=0;b<w.children.length;b++){var O=C[w.children[b]];O&&(i=O.parents.indexOf(j))>=0&&O.parents.splice(i,1)}}for(j in f)if(Object.prototype.hasOwnProperty.call(f,j)&&(w=C[j]))for(b=0,c=f[j];b<c.length;b++)d=c[b],(i=w.children.indexOf(d))>=0&&w.children.splice(i,1);for(j in m("apply"),l=o,v)Object.prototype.hasOwnProperty.call(v,j)&&(e[j]=v[j]);var H=null;for(j in f)if(Object.prototype.hasOwnProperty.call(f,j)&&(w=C[j])){c=f[j];var B=[];for(T=0;T<c.length;T++)if(d=c[T],x=w.hot._acceptedDependencies[d]){if(-1!==B.indexOf(x))continue;B.push(x)}for(T=0;T<B.length;T++){x=B[T];try{x(c)}catch(U){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:j,dependencyId:c[T],error:U}),t.ignoreErrored||H||(H=U)}}}for(T=0;T<D.length;T++){var F=D[T];u=[j=F.module];try{E(j)}catch(N){if("function"==typeof F.errorHandler)try{F.errorHandler(N)}catch(z){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:j,error:z,originalError:N}),t.ignoreErrored||H||(H=z),H||(H=N)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:j,error:N}),t.ignoreErrored||H||(H=N)}}return H?(m("fail"),Promise.reject(H)):(m("idle"),new Promise(function(e){e(g)}))}var C={};function E(n){if(C[n])return C[n].exports;var a,o,r=C[n]={i:n,l:!1,exports:{},hot:(a=n,o={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:t!==a,active:!0,accept:function(e,t){if(void 0===e)o._selfAccepted=!0;else if("function"==typeof e)o._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)o._acceptedDependencies[e[n]]=t||function(){};else o._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)o._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)o._declinedDependencies[e[t]]=!0;else o._declinedDependencies[e]=!0},dispose:function(e){o._disposeHandlers.push(e)},addDisposeHandler:function(e){o._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=o._disposeHandlers.indexOf(e);t>=0&&o._disposeHandlers.splice(t,1)},check:x,apply:w,status:function(e){if(!e)return h;f.push(e)},addStatusHandler:function(e){f.push(e)},removeStatusHandler:function(e){var t=f.indexOf(e);t>=0&&f.splice(t,1)},data:s[a]},t=void 0,o),parents:(d=u,u=[],d),children:[]};return e[n].call(r.exports,r,r.exports,c(n)),r.l=!0,r.exports}return E.m=e,E.c=C,E.d=function(e,t,n){E.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},E.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},E.t=function(e,t){if(1&t&&(e=E(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(E.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)E.d(n,a,(function(t){return e[t]}).bind(null,a));return n},E.n=function(e){var t=e&&e.__esModule?function t(){return e.default}:function t(){return e};return E.d(t,"a",t),t},E.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},E.p="",E.h=function(){return l},c("./index.js")(E.s="./index.js")}({"./canvasToPixel.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/getTransform.js */ "./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),r=Object(o.default)(n);return r.invert(),r.transformPoint(t.x,t.y)}},"./colors/colormap.js":function(e,t,n){n.r(t),n.d(t,"getColormapsList",function(){return s}),n.d(t,"getColormap",function(){return u});var a=n(/*! ./lookupTable.js */ "./colors/lookupTable.js"),o=[0,0,0,0],r={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};function i(e,t){for(var n=0,a=e.length-1;n<=a;){var o=n+Math.floor((a-n)/2),r=e[o];if(r===t)return o;t<r?a=o-1:n=o+1}return n}function l(e,t,n){var a,o=[],r=[],l=[],s=[];for(a=0,n=null===n?1:n;a<t.length;a++){var u=t[a];o.push((e-1)*u[0]),r.push(u[1]),l.push(u[1])}var d=function e(t,n,a){for(var o=(n-t)/((a=null===a?100:a)-1),r=[];a-- >0;)r.push(t),t+=o;return r[r.length-1]=n,r}(0,1,e);for(a=0;a<e;a++)d[a]=(e-1)*Math.pow(d[a],n);var c=function e(t,n){var a,o=[],r=n.length;for(t.sort(function(e,t){return e-t}),a=0;a<r;a++)o[a]=i(t,n[a]);return o}(o,d);for(a=1;a<e-1;a++){var f=c[a],h=(d[a]-o[f-1])/(o[f]-o[f-1]),m=r[f]-l[f-1];s[a]=h*m+l[f-1]}return s[0]=l[0],s[e-1]=r[t.length-1],s}function s(){var e=[];return Object.keys(r).forEach(function(t){if(r.hasOwnProperty(t)){var n=r[t];e.push({id:t,name:n.name})}}),e.sort(function(e,t){var n=e.name.toLowerCase(),a=t.name.toLowerCase();return n===a?0:n<a?-1:1}),e}function u(e,t){var n=r[e];return n||(n=r[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function e(t,n,a){var o,r=[];n=null===n?256:n,a=null===a?1:a;var i=l(n,t.red,a),s=l(n,t.green,a),u=l(n,t.blue,a);for(o=0;o<n;o++){var d,c=Math.round(255*i[o]),f=[c,Math.round(255*s[o]),Math.round(255*u[o]),255];r.push(f)}return r}(n.segmentedData,n.numColors,n.gamma)),{getId:function t(){return e},getColorSchemeName:function e(){return n.name},setColorSchemeName:function e(t){n.name=t},getNumberOfColors:function e(){return n.colors.length},setNumberOfColors:function e(t){for(;n.colors.length<t;)n.colors.push(o);n.colors.length=t},getColor:function e(t){return this.isValidIndex(t)?n.colors[t]:o},getColorRepeating:function e(t){var a=n.colors.length;return t=a?t%a:0,this.getColor(t)},setColor:function e(t,a){this.isValidIndex(t)&&(n.colors[t]=a)},addColor:function e(t){n.colors.push(t)},insertColor:function e(t,a){this.isValidIndex(t)&&n.colors.splice(t,1,a)},removeColor:function e(t){this.isValidIndex(t)&&n.colors.splice(t,1)},clearColors:function e(){n.colors=[]},buildLookupTable:function e(t){if(t){var a=n.colors.length;t.setNumberOfTableValues(a);for(var o=0;o<a;o++)t.setTableValue(o,n.colors[o])}},createLookupTable:function e(){var t=new a.default;return this.buildLookupTable(t),t},isValidIndex:function e(t){return t>=0&&t<n.colors.length}}}},"./colors/index.js":function(e,t,n){n.r(t);var a=n(/*! ./colormap.js */ "./colors/colormap.js"),o=n(/*! ./lookupTable.js */ "./colors/lookupTable.js");t.default={getColormap:a.getColormap,getColormapsList:a.getColormapsList,LookupTable:o.default}},"./colors/lookupTable.js":function(e,t,n){function a(e,t,n){if(e>1)throw Error("HSVToRGB expects hue < 1");var a=[];if(0===t)return a[0]=n,a[1]=n,a[2]=n,a;var o=Math.floor(6*e),r=6*e-o,i=n*(1-t),l=n*(1-t*r),s=n*(1-t*(1-r));switch(o){case 0:case 6:a[0]=n,a[1]=s,a[2]=i;break;case 1:a[0]=l,a[1]=n,a[2]=i;break;case 2:a[0]=i,a[1]=n,a[2]=s;break;case 3:a[0]=i,a[1]=l,a[2]=n;break;case 4:a[0]=s,a[1]=i,a[2]=n;break;case 5:a[0]=n,a[1]=i,a[2]=l}return a}n.r(t);var o=function(){var e,t;function n(){(function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,n),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}return e=n,t=[{key:"setNumberOfTableValues",value:function e(t){this.NumberOfColors=t}},{key:"setRamp",value:function e(t){this.Ramp=t}},{key:"setTableRange",value:function e(t,n){this.TableRange[0]=t,this.TableRange[1]=n}},{key:"setHueRange",value:function e(t,n){this.HueRange[0]=t,this.HueRange[1]=n}},{key:"setSaturationRange",value:function e(t,n){this.SaturationRange[0]=t,this.SaturationRange[1]=n}},{key:"setValueRange",value:function e(t,n){this.ValueRange[0]=t,this.ValueRange[1]=n}},{key:"setRange",value:function e(t,n){this.InputRange[0]=t,this.InputRange[1]=n}},{key:"setAlphaRange",value:function e(t,n){this.AlphaRange[0]=t,this.AlphaRange[1]=n}},{key:"getColor",value:function e(t){return this.mapValue(t)}},{key:"build",value:function e(t){if(!(this.Table.length>1)||t){this.Table=[];var n,o,r,i,l=this.NumberOfColors-1;l?(n=(this.HueRange[1]-this.HueRange[0])/l,o=(this.SaturationRange[1]-this.SaturationRange[0])/l,r=(this.ValueRange[1]-this.ValueRange[0])/l,i=(this.AlphaRange[1]-this.AlphaRange[0])/l):n=o=r=i=0;for(var s=0;s<=l;s++){var u=this.HueRange[0]+s*n,d=this.SaturationRange[0]+s*o,c=this.ValueRange[0]+s*r,f=this.AlphaRange[0]+s*i,h=a(u,d,c),m=[];switch(this.Ramp){case"scurve":m[0]=Math.floor(127.5*(1+Math.cos((1-h[0])*Math.PI))),m[1]=Math.floor(127.5*(1+Math.cos((1-h[1])*Math.PI))),m[2]=Math.floor(127.5*(1+Math.cos((1-h[2])*Math.PI))),m[3]=Math.floor(255*f);break;case"linear":m[0]=Math.floor(255*h[0]+.5),m[1]=Math.floor(255*h[1]+.5),m[2]=Math.floor(255*h[2]+.5),m[3]=Math.floor(255*f+.5);break;case"sqrt":m[0]=Math.floor(255*Math.sqrt(h[0])+.5),m[1]=Math.floor(255*Math.sqrt(h[1])+.5),m[2]=Math.floor(255*Math.sqrt(h[2])+.5),m[3]=Math.floor(255*Math.sqrt(f)+.5);break;default:throw Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(m)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function e(){var t=this.NumberOfColors,n=t+0,a=t+1,o=t+2;this.UseBelowRangeColor||0===t?this.Table[n]=this.BelowRangeColor:this.Table[n]=this.Table[0],this.UseAboveRangeColor||0===t?this.Table[a]=this.AboveRangeColor:this.Table[a]=this.Table[t-1],this.Table[o]=this.NaNColor}},{key:"mapValue",value:function e(t){var n=this.getIndex(t);if(n<0)return this.NaNColor;if(0===n){if(this.UseBelowRangeColor&&t<this.TableRange[0])return this.BelowRangeColor}else if(n===this.NumberOfColors-1&&this.UseAboveRangeColor&&t>this.TableRange[1])return this.AboveRangeColor;return this.Table[n]}},{key:"getIndex",value:function e(t){var n={};if(n.Range=[],n.MaxIndex=this.NumberOfColors-1,n.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?n.Scale=Number.MAX_VALUE:n.Scale=n.MaxIndex/(this.TableRange[1]-this.TableRange[0]),n.Range[0]=this.TableRange[0],n.Range[1]=this.TableRange[1],isNaN(t))return -1;var a,o,r,i=(a=t,o=n,Math.floor(r=a<o.Range[0]?o.MaxIndex+0+1.5:a>o.Range[1]?o.MaxIndex+1+1.5:(a+o.Shift)*o.Scale));return i===this.NumberOfColors+0?i=0:i===this.NumberOfColors+1&&(i=this.NumberOfColors-1),i}},{key:"setTableValue",value:function e(t,n){if(5===arguments.length&&(n=Array.prototype.slice.call(arguments,1)),t<0)throw Error("Can't set the table value for negative index (".concat(t,")"));t>=this.NumberOfColors&&Error("Index ".concat(t," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[t]=n,(0===t||t===this.NumberOfColors-1)&&this.buildSpecialColors()}}],function e(t,n){for(var a=0;a<n.length;a++){var o=n[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(e.prototype,t),n}();t.default=o},"./disable.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),r=n(/*! ./events.js */ "./events.js");t.default=function(e){if(void 0===e)throw Error("disable: element must not be undefined");for(var t=Object(a.getEnabledElements)(),n=0;n<t.length;n++)if(t[n].element===e){var i={element:e};Object(o.default)(e,r.default.ELEMENT_DISABLED,i),Object(o.default)(r.events,r.default.ELEMENT_DISABLED,i),t[n].element.removeChild(t[n].canvas),t[n].canvas=void 0,t.splice(n,1);break}}},"./displayImage.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js"),r=n(/*! ./updateImage.js */ "./updateImage.js"),i=n(/*! ./internal/now.js */ "./internal/now.js"),l=n(/*! ./layers.js */ "./layers.js"),s=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),u=n(/*! ./events.js */ "./events.js");t.default=function(e,t,n){if(void 0===e)throw Error("displayImage: parameter element must not be undefined");if(void 0===t)throw Error("displayImage: parameter image must not be undefined");var d,c=Object(a.getEnabledElement)(e),f=c.image;if(c.image=t,c.layers&&c.layers.length&&Object(l.setLayerImage)(e,t),void 0===c.viewport&&(c.viewport=Object(o.default)(c.canvas,t)),n)for(var h in n)null!==n[h]&&(c.viewport[h]=n[h]);void 0!==c.lastImageTimeStamp&&(d=(1e3/(Object(i.default)()-c.lastImageTimeStamp)).toFixed()),c.lastImageTimeStamp=Object(i.default)();var m={viewport:c.viewport,element:c.element,image:c.image,oldImage:f,enabledElement:c,frameRate:d};Object(s.default)(c.element,u.default.NEW_IMAGE,m),Object(r.default)(e)}},"./draw.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/drawImage.js */ "./internal/drawImage.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);Object(o.default)(t)}},"./drawInvalidated.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/drawImage.js */ "./internal/drawImage.js");t.default=function(){for(var e=Object(a.getEnabledElements)(),t=0;t<e.length;t++){var n=e[t];!0===n.invalid&&Object(o.default)(n,!0)}}},"./enable.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./resize.js */ "./resize.js"),r=n(/*! ./internal/drawImageSync.js */ "./internal/drawImageSync.js"),i=n(/*! ./internal/requestAnimationFrame.js */ "./internal/requestAnimationFrame.js"),l=n(/*! ./internal/tryEnableWebgl.js */ "./internal/tryEnableWebgl.js"),s=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),u=n(/*! ./generateUUID.js */ "./generateUUID.js"),d=n(/*! ./events.js */ "./events.js"),c=n(/*! ./internal/getCanvas.js */ "./internal/getCanvas.js");t.default=function(e,t){if(void 0===e)throw Error("enable: parameter element cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&Object(l.default)(t);var n=Object(c.default)(e),f={element:e,canvas:n,image:void 0,invalid:!1,needsRedraw:!0,options:Object.assign({},t),layers:[],data:{},renderingTools:{},uuid:Object(u.default)()};Object(a.addEnabledElement)(f),Object(s.default)(d.events,d.default.ELEMENT_ENABLED,f),Object(o.default)(e,!0),!function e(t){var n;void 0!==f.canvas&&(Object(s.default)(f.element,d.default.PRE_RENDER,{enabledElement:f,timestamp:void 0}),f.needsRedraw&&(void 0!==(n=f).image||n.layers.length>0)&&Object(r.default)(f,f.invalid),Object(i.default)(e))}()}},"./enabledElementData.js":function(e,t,n){n.r(t),n.d(t,"getElementData",function(){return o}),n.d(t,"removeElementData",function(){return r});var a=n(/*! ./enabledElements.js */ "./enabledElements.js");function o(e,t){var n=Object(a.getEnabledElement)(e);return!1===n.data.hasOwnProperty(t)&&(n.data[t]={}),n.data[t]}function r(e,t){delete Object(a.getEnabledElement)(e).data[t]}},"./enabledElements.js":function(e,t,n){n.r(t),n.d(t,"getEnabledElement",function(){return o}),n.d(t,"addEnabledElement",function(){return r}),n.d(t,"getEnabledElementsByImageId",function(){return i}),n.d(t,"getEnabledElements",function(){return l});var a=[];function o(e){if(void 0===e)throw Error("getEnabledElement: parameter element must not be undefined");for(var t=0;t<a.length;t++)if(a[t].element===e)return a[t];throw Error("element not enabled")}function r(e){if(void 0===e)throw Error("getEnabledElement: enabledElement element must not be undefined");a.push(e)}function i(e){var t=[];return a.forEach(function(n){n.image&&n.image.imageId===e&&t.push(n)}),t}function l(){return a}},"./events.js":function(e,t,n){n.r(t),n.d(t,"events",function(){return a}),t.default={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_PROGRESS:"cornerstoneimageloadprogress",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};var a=new(function(){var e,t;function n(){(function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,n),this.listeners={},this.namespaces={}}return e=n,t=[{key:"addEventNamespaceListener",value:function e(t,n){!(0>=t.indexOf("."))&&(this.namespaces[t]=n,this.addEventListener(t.split(".")[0],n))}},{key:"removeEventNamespaceListener",value:function e(t){!(0>=t.indexOf("."))&&this.namespaces[t]&&(this.removeEventListener(t.split(".")[0],this.namespaces[t]),delete this.namespaces[t])}},{key:"addEventListener",value:function e(t,n){if(t.indexOf(".")>0){this.addEventNamespaceListener(t,n);return}t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(n)}},{key:"removeEventListener",value:function e(t,n){if(t.indexOf(".")>0){this.removeEventNamespaceListener(t);return}if(t in this.listeners){for(var a=this.listeners[t],o=0,r=a.length;o<r;o++)if(a[o]===n){a.splice(o,1);return}}}},{key:"dispatchEvent",value:function e(t){if(!(t.type in this.listeners))return!0;for(var n=this.listeners[t.type].slice(),a=0,o=n.length;a<o;a++)n[a].call(this,t);return!t.defaultPrevented}}],function e(t,n){for(var a=0;a<n.length;a++){var o=n[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(e.prototype,t),n}())},"./falseColorMapping.js":function(e,t,n){n.r(t),n.d(t,"convertImageToFalseColorImage",function(){return l}),n.d(t,"convertToFalseColorImage",function(){return s}),n.d(t,"restoreImage",function(){return i});var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./pixelDataToFalseColorData.js */ "./pixelDataToFalseColorData.js"),r=n(/*! ./colors/colormap.js */ "./colors/colormap.js");function i(e){return!!e.restore&&"function"==typeof e.restore&&(e.restore(),!0)}function l(e,t){if(e.color&&!e.falseColor)throw Error("Color transforms are not implemented yet");var n,a=(t=((n=t)&&"string"==typeof n&&(n=Object(r.getColormap)(n)),n)).getId();if(e.colormapId===a)return!1;if(i(e),a){var l=e.minPixelValue||0,s=e.maxPixelValue||255;e.restore=function e(t){if(t.restore)return t.restore;var n=t.color,a=t.rgba,o=t.cachedLut,r=t.slope,i=t.windowWidth,l=t.windowCenter,s=t.minPixelValue,u=t.maxPixelValue;return function(){if(t.color=n,t.rgba=a,t.cachedLut=o,t.slope=r,t.windowWidth=i,t.windowCenter=l,t.minPixelValue=s,t.maxPixelValue=u,t.origPixelData){var e=t.origPixelData;t.getPixelData=function(){return e}}t.origPixelData=void 0,t.colormapId=void 0,t.falseColor=void 0}}(e);var u=t.createLookupTable();u.setTableRange(l,s),Object(o.default)(e,u);var d=function e(t){for(var n,a=Number.MAX_VALUE,o=Number.MIN_VALUE,r=t.length,i=0;i<r;i++)a=a<(n=t[i])?a:n,o=o>n?o:n;return{minPixelValue:a,maxPixelValue:o}}(e.getPixelData());e.minPixelValue=d.minPixelValue,e.maxPixelValue=d.maxPixelValue,e.windowWidth=255,e.windowCenter=128,e.colormapId=a}return!0}function s(e,t){return l(Object(a.getEnabledElement)(e).image,t)}},"./fitToWindow.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./updateImage.js */ "./updateImage.js"),r=n(/*! ./internal/getImageFitScale.js */ "./internal/getImageFitScale.js");t.default=function(e){var t=Object(a.getEnabledElement)(e),n=t.image;t.viewport.scale=Object(r.default)(t.canvas,n,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0,Object(o.default)(e)}},"./generateUUID.js":function(e,t,n){n.r(t),t.default=function(){var e=new Date().getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}},"./getDefaultViewportForImage.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(o.default)(n.canvas,t)}},"./getImage.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js");t.default=function(e){return Object(a.getEnabledElement)(e).image}},"./getPixels.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./getStoredPixels.js */ "./getStoredPixels.js"),r=n(/*! ./internal/getModalityLUT.js */ "./internal/getModalityLUT.js");t.default=function(e,t,n,i,l){var s=Object(o.default)(e,t,n,i,l),u=Object(a.getEnabledElement)(e),d=Object(r.default)(u.image.slope,u.image.intercept,u.viewport.modalityLUT);return s.map(d)}},"./getStoredPixels.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js");t.default=function(e,t,n,o,r){if(void 0===e)throw Error("getStoredPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);for(var i=Object(a.getEnabledElement)(e),l=[],s=0,u=i.image.getPixelData(),d=0;d<r;d++)for(var c=0;c<o;c++){var f=(d+n)*i.image.columns+(c+t);l[s++]=u[f]}return l}},"./getViewport.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js");t.default=function(e){var t=Object(a.getEnabledElement)(e).viewport;if(void 0!==t)return Object.assign({},t)}},"./imageCache.js":function(e,t,n){n.r(t),n.d(t,"cachedImages",function(){return s}),n.d(t,"setMaximumSizeBytes",function(){return u}),n.d(t,"putImageLoadObject",function(){return c}),n.d(t,"getImageLoadObject",function(){return f}),n.d(t,"removeImageLoadObject",function(){return h}),n.d(t,"getCacheInfo",function(){return m}),n.d(t,"purgeCache",function(){return g}),n.d(t,"changeImageIdCacheSize",function(){return v});var a=n(/*! ./events.js */ "./events.js"),o=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),r=1073741824,i=0,l={},s=[];function u(e){if(void 0===e)throw Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw Error("setMaximumSizeBytes: parameter numBytes must be a number");r=e,Object(o.default)(a.events,a.default.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),d()}function d(){if(!(i<=r)){for(s.sort(function e(t,n){return t.timeStamp>n.timeStamp?-1:t.timeStamp<n.timeStamp?1:0});i>r;){var e=s[s.length-1].imageId;h(e),Object(o.default)(a.events,a.default.IMAGE_CACHE_PROMISE_REMOVED,{imageId:e})}var t=m();Object(o.default)(a.events,a.default.IMAGE_CACHE_FULL,t)}}function c(e,t){if(void 0===e)throw Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(!0===l.hasOwnProperty(e))throw Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};l[e]=n,s.push(n),t.promise.then(function(e){if(-1!==s.indexOf(n)){if(n.loaded=!0,n.image=e,void 0===e.sizeInBytes)throw Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw Error("putImageLoadObject: image.sizeInBytes is not a number");n.sizeInBytes=e.sizeInBytes,i+=n.sizeInBytes,Object(o.default)(a.events,a.default.IMAGE_CACHE_CHANGED,{action:"addImage",image:n}),n.sharedCacheKey=e.sharedCacheKey,d()}},function(){var t=l[e];s.splice(s.indexOf(t),1),delete l[e]})}function f(e){if(void 0===e)throw Error("getImageLoadObject: imageId must not be undefined");var t=l[e];if(void 0!==t)return t.timeStamp=Date.now(),t.imageLoadObject}function h(e){if(void 0===e)throw Error("removeImageLoadObject: imageId must not be undefined");var t=l[e];if(void 0===t)throw Error("removeImageLoadObject: imageId was not present in imageCache");s.splice(s.indexOf(t),1),i-=t.sizeInBytes,Object(o.default)(a.events,a.default.IMAGE_CACHE_CHANGED,{action:"deleteImage",image:t}),function e(t){t.promise.then(function(){t.decache&&t.decache()},function(){t.decache&&t.decache()})}(t.imageLoadObject),delete l[e]}function m(){return{maximumSizeInBytes:r,cacheSizeInBytes:i,numberOfImagesCached:s.length}}function g(){for(;s.length>0;)h(s[0].imageId)}function v(e,t){var n=l[e];n&&n.imageLoadObject.promise.then(function(e){var r=t-e.sizeInBytes;e.sizeInBytes=t,n.sizeInBytes=t,i+=r,Object(o.default)(a.events,a.default.IMAGE_CACHE_CHANGED,{action:"changeImageSize",image:e})})}t.default={imageCache:l,cachedImages:s,setMaximumSizeBytes:u,putImageLoadObject:c,getImageLoadObject:f,removeImageLoadObject:h,getCacheInfo:m,purgeCache:g,changeImageIdCacheSize:v}},"./imageLoader.js":function(e,t,n){n.r(t),n.d(t,"loadImage",function(){return u}),n.d(t,"loadAndCacheImage",function(){return d}),n.d(t,"registerImageLoader",function(){return c}),n.d(t,"registerUnknownImageLoader",function(){return f});var a,o=n(/*! ./imageCache.js */ "./imageCache.js"),r=n(/*! ./events.js */ "./events.js"),i=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),l={};function s(e,t){var n=e.indexOf(":"),o=l[e.substring(0,n)];if(null==o){if(void 0!==a)return a(e);throw Error("loadImageFromImageLoader: no image loader for imageId")}var s=o(e,t);return s.promise.then(function(e){Object(i.default)(r.events,r.default.IMAGE_LOADED,{image:e})},function(t){Object(i.default)(r.events,r.default.IMAGE_LOAD_FAILED,{imageId:e,error:t})}),s}function u(e,t){if(void 0===e)throw Error("loadImage: parameter imageId must not be undefined");var n=Object(o.getImageLoadObject)(e);return void 0!==n?n.promise:s(e,t).promise}function d(e,t){if(void 0===e)throw Error("loadAndCacheImage: parameter imageId must not be undefined");var n=Object(o.getImageLoadObject)(e);return void 0!==n||(n=s(e,t),Object(o.putImageLoadObject)(e,n)),n.promise}function c(e,t){l[e]=t}function f(e){var t=a;return a=e,t}},"./index.js":function(e,t,n){n.r(t);var a=n(/*! ./events.js */ "./events.js");n.d(t,"EVENTS",function(){return a.default}),n.d(t,"events",function(){return a.events});var o=n(/*! ./enabledElements.js */ "./enabledElements.js");n.d(t,"getEnabledElement",function(){return o.getEnabledElement}),n.d(t,"addEnabledElement",function(){return o.addEnabledElement}),n.d(t,"getEnabledElementsByImageId",function(){return o.getEnabledElementsByImageId}),n.d(t,"getEnabledElements",function(){return o.getEnabledElements});var r=n(/*! ./layers.js */ "./layers.js");n.d(t,"addLayer",function(){return r.addLayer}),n.d(t,"removeLayer",function(){return r.removeLayer}),n.d(t,"getLayer",function(){return r.getLayer}),n.d(t,"getLayers",function(){return r.getLayers}),n.d(t,"getVisibleLayers",function(){return r.getVisibleLayers}),n.d(t,"setActiveLayer",function(){return r.setActiveLayer}),n.d(t,"getActiveLayer",function(){return r.getActiveLayer}),n.d(t,"purgeLayers",function(){return r.purgeLayers}),n.d(t,"setLayerImage",function(){return r.setLayerImage});var i=n(/*! ./falseColorMapping.js */ "./falseColorMapping.js");n.d(t,"convertImageToFalseColorImage",function(){return i.convertImageToFalseColorImage}),n.d(t,"convertToFalseColorImage",function(){return i.convertToFalseColorImage}),n.d(t,"restoreImage",function(){return i.restoreImage});var l=n(/*! ./enabledElementData.js */ "./enabledElementData.js");n.d(t,"getElementData",function(){return l.getElementData}),n.d(t,"removeElementData",function(){return l.removeElementData});var s=n(/*! ./imageLoader.js */ "./imageLoader.js");n.d(t,"loadImage",function(){return s.loadImage}),n.d(t,"loadAndCacheImage",function(){return s.loadAndCacheImage}),n.d(t,"registerImageLoader",function(){return s.registerImageLoader}),n.d(t,"registerUnknownImageLoader",function(){return s.registerUnknownImageLoader});var u=n(/*! ./requestPool/imageLoadPoolManager.ts */ "./requestPool/imageLoadPoolManager.ts");n.d(t,"imageLoadPoolManager",function(){return u.default});var d=n(/*! ./requestPool/imageRetrievalPoolManager.ts */ "./requestPool/imageRetrievalPoolManager.ts");n.d(t,"imageRetrievalPoolManager",function(){return d.default});var c=n(/*! ./requestPool/RequestPoolManager.ts */ "./requestPool/RequestPoolManager.ts");n.d(t,"RequestPoolManager",function(){return c.RequestPoolManager});var f=n(/*! ./canvasToPixel.js */ "./canvasToPixel.js");n.d(t,"canvasToPixel",function(){return f.default});var h=n(/*! ./colors/index.js */ "./colors/index.js");n.d(t,"colors",function(){return h.default});var m=n(/*! ./disable.js */ "./disable.js");n.d(t,"disable",function(){return m.default});var g=n(/*! ./displayImage.js */ "./displayImage.js");n.d(t,"displayImage",function(){return g.default});var v=n(/*! ./draw.js */ "./draw.js");n.d(t,"draw",function(){return v.default});var $=n(/*! ./internal/drawImage.js */ "./internal/drawImage.js");n.d(t,"drawImage",function(){return $.default});var p=n(/*! ./drawInvalidated.js */ "./drawInvalidated.js");n.d(t,"drawInvalidated",function(){return p.default});var _=n(/*! ./enable.js */ "./enable.js");n.d(t,"enable",function(){return _.default});var y=n(/*! ./fitToWindow.js */ "./fitToWindow.js");n.d(t,"fitToWindow",function(){return y.default});var x=n(/*! ./internal/generateLut.js */ "./internal/generateLut.js");n.d(t,"generateLut",function(){return x.default});var T=n(/*! ./internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js");n.d(t,"getDefaultViewport",function(){return T.default});var b=n(/*! ./getDefaultViewportForImage.js */ "./getDefaultViewportForImage.js");n.d(t,"getDefaultViewportForImage",function(){return b.default});var w=n(/*! ./internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js");n.d(t,"getDisplayedArea",function(){return w.default});var C=n(/*! ./getImage.js */ "./getImage.js");n.d(t,"getImage",function(){return C.default});var E=n(/*! ./getPixels.js */ "./getPixels.js");n.d(t,"getPixels",function(){return E.default});var j=n(/*! ./getStoredPixels.js */ "./getStoredPixels.js");n.d(t,"getStoredPixels",function(){return j.default});var S=n(/*! ./getViewport.js */ "./getViewport.js");n.d(t,"getViewport",function(){return S.default});var I=n(/*! ./imageCache.js */ "./imageCache.js");n.d(t,"imageCache",function(){return I.default});var P=n(/*! ./internal/index.js */ "./internal/index.js");n.d(t,"internal",function(){return P.default});var M=n(/*! ./invalidate.js */ "./invalidate.js");n.d(t,"invalidate",function(){return M.default});var k=n(/*! ./invalidateImageId.js */ "./invalidateImageId.js");n.d(t,"invalidateImageId",function(){return k.default});var D=n(/*! ./metaData.js */ "./metaData.js");n.d(t,"metaData",function(){return D.default});var L=n(/*! ./pageToPixel.js */ "./pageToPixel.js");n.d(t,"pageToPixel",function(){return L.default});var R=n(/*! ./pixelDataToFalseColorData.js */ "./pixelDataToFalseColorData.js");n.d(t,"pixelDataToFalseColorData",function(){return R.default});var A=n(/*! ./pixelToCanvas.js */ "./pixelToCanvas.js");n.d(t,"pixelToCanvas",function(){return A.default});var O=n(/*! ./rendering/renderColorImage.js */ "./rendering/renderColorImage.js");n.d(t,"renderColorImage",function(){return O.renderColorImage});var H=n(/*! ./rendering/renderGrayscaleImage.js */ "./rendering/renderGrayscaleImage.js");n.d(t,"renderGrayscaleImage",function(){return H.renderGrayscaleImage});var B=n(/*! ./rendering/renderLabelMapImage.js */ "./rendering/renderLabelMapImage.js");n.d(t,"renderLabelMapImage",function(){return B.renderLabelMapImage});var U=n(/*! ./rendering/renderPseudoColorImage.js */ "./rendering/renderPseudoColorImage.js");n.d(t,"renderPseudoColorImage",function(){return U.renderPseudoColorImage});var F=n(/*! ./rendering/renderToCanvas.js */ "./rendering/renderToCanvas.js");n.d(t,"renderToCanvas",function(){return F.default});var N=n(/*! ./rendering/renderWebImage.js */ "./rendering/renderWebImage.js");n.d(t,"renderWebImage",function(){return N.renderWebImage});var z=n(/*! ./rendering/index.js */ "./rendering/index.js");n.d(t,"rendering",function(){return z.default});var V=n(/*! ./internal/requestAnimationFrame.js */ "./internal/requestAnimationFrame.js");n.d(t,"requestAnimationFrame",function(){return V.default});var q=n(/*! ./reset.js */ "./reset.js");n.d(t,"reset",function(){return q.default});var W=n(/*! ./resize.js */ "./resize.js");n.d(t,"resize",function(){return W.default});var G=n(/*! ./internal/setDefaultViewport.js */ "./internal/setDefaultViewport.js");n.d(t,"setDefaultViewport",function(){return G.default});var Y=n(/*! ./setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js");n.d(t,"setToPixelCoordinateSystem",function(){return Y.default});var X=n(/*! ./setViewport.js */ "./setViewport.js");n.d(t,"setViewport",function(){return X.default});var Z=n(/*! ./internal/storedColorPixelDataToCanvasImageData.js */ "./internal/storedColorPixelDataToCanvasImageData.js");n.d(t,"storedColorPixelDataToCanvasImageData",function(){return Z.default});var K=n(/*! ./internal/storedPixelDataToCanvasImageData.js */ "./internal/storedPixelDataToCanvasImageData.js");n.d(t,"storedPixelDataToCanvasImageData",function(){return K.default});var J=n(/*! ./internal/storedPixelDataToCanvasImageDataColorLUT.js */ "./internal/storedPixelDataToCanvasImageDataColorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataColorLUT",function(){return J.default});var Q=n(/*! ./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js */ "./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataPseudocolorLUT",function(){return Q.default});var ee=n(/*! ./triggerEvent.js */ "./triggerEvent.js");n.d(t,"triggerEvent",function(){return ee.default});var et=n(/*! ./updateImage.js */ "./updateImage.js");n.d(t,"updateImage",function(){return et.default});var en=n(/*! ./webgl/index.js */ "./webgl/index.js");n.d(t,"webGL",function(){return en.default});var ea={drawImage:$.default,generateLut:x.default,getDefaultViewport:T.default,requestAnimationFrame:V.default,storedPixelDataToCanvasImageData:K.default,storedColorPixelDataToCanvasImageData:Z.default,storedPixelDataToCanvasImageDataColorLUT:J.default,storedPixelDataToCanvasImageDataPseudocolorLUT:Q.default,internal:P.default,renderLabelMapImage:B.renderLabelMapImage,renderPseudoColorImage:U.renderPseudoColorImage,renderColorImage:O.renderColorImage,renderGrayscaleImage:H.renderGrayscaleImage,renderWebImage:N.renderWebImage,renderToCanvas:F.default,canvasToPixel:f.default,disable:m.default,displayImage:g.default,draw:v.default,drawInvalidated:p.default,enable:_.default,getElementData:l.getElementData,removeElementData:l.removeElementData,getEnabledElement:o.getEnabledElement,addEnabledElement:o.addEnabledElement,getEnabledElementsByImageId:o.getEnabledElementsByImageId,getEnabledElements:o.getEnabledElements,addLayer:r.addLayer,removeLayer:r.removeLayer,getLayer:r.getLayer,getLayers:r.getLayers,getVisibleLayers:r.getVisibleLayers,setActiveLayer:r.setActiveLayer,getActiveLayer:r.getActiveLayer,purgeLayers:r.purgeLayers,setLayerImage:r.setLayerImage,fitToWindow:y.default,getDefaultViewportForImage:b.default,getDisplayedArea:w.default,setDefaultViewport:G.default,getImage:C.default,getPixels:E.default,getStoredPixels:j.default,getViewport:S.default,loadImage:s.loadImage,loadAndCacheImage:s.loadAndCacheImage,registerImageLoader:s.registerImageLoader,registerUnknownImageLoader:s.registerUnknownImageLoader,invalidate:M.default,invalidateImageId:k.default,pageToPixel:L.default,pixelToCanvas:A.default,reset:q.default,resize:W.default,setToPixelCoordinateSystem:Y.default,setViewport:X.default,updateImage:et.default,pixelDataToFalseColorData:R.default,rendering:z.default,imageCache:I.default,metaData:D.default,webGL:en.default,colors:h.default,convertImageToFalseColorImage:i.convertImageToFalseColorImage,convertToFalseColorImage:i.convertToFalseColorImage,restoreImage:i.restoreImage,EVENTS:a.default,events:a.events,triggerEvent:ee.default,imageLoadPoolManager:u.default,imageRetrievalPoolManager:d.default,RequestPoolManager:c.RequestPoolManager};t.default=ea},"./internal/calculateTransform.js":function(e,t,n){n.r(t);var a=n(/*! ./transform.js */ "./internal/transform.js"),o=n(/*! ./getDisplayedArea.js */ "./internal/getDisplayedArea.js");t.default=function(e,t){var n=new a.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var r=e.viewport.rotation;0!==r&&n.rotate(r*Math.PI/180);var i=e.viewport.scale,l=e.viewport.scale,s=Object(o.default)(e.image,e.viewport),u=s.tlhc.x-1,d=s.tlhc.y-1,c=s.brhc.x-u,f=s.brhc.y-d;if("NONE"===s.presentationSizeMode)e.image.rowPixelSpacing<e.image.columnPixelSpacing?i*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(l*=e.image.rowPixelSpacing/e.image.columnPixelSpacing);else if(i=s.columnPixelSpacing,l=s.rowPixelSpacing,"SCALE TO FIT"===s.presentationSizeMode){var h=e.canvas.height/(f*l);i=l=Math.min(e.canvas.width/(c*i),h),s.rowPixelSpacing<s.columnPixelSpacing?i*=s.columnPixelSpacing/s.rowPixelSpacing:s.columnPixelSpacing<s.rowPixelSpacing&&(l*=s.rowPixelSpacing/s.columnPixelSpacing)}return n.scale(i,l),0!==r&&n.rotate(-r*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==r&&n.rotate(r*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-c/2,-f/2),n.translate(-u,-d),n}},"./internal/computeAutoVoi.js":function(e,t,n){function a(e,t){var n;if(n=e,(!n.voiLUT||!n.voiLUT.lut||!(n.voiLUT.lut.length>0))&&(void 0===n.voi.windowWidth||void 0===n.voi.windowCenter)){var a=t.maxPixelValue*t.slope+t.intercept,o=t.minPixelValue*t.slope+t.intercept,r=a-o,i=(a+o)/2;void 0===e.voi?e.voi={windowWidth:r,windowCenter:i}:(e.voi.windowWidth=r,e.voi.windowCenter=i)}}n.r(t),n.d(t,"default",function(){return a})},"./internal/createViewport.js":function(e,t,n){n.r(t);var a=n(/*! ./setDefaultViewport.js */ "./internal/setDefaultViewport.js");t.default=function(){return Object.assign({},{scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:void 0},a.state.viewport)}},"./internal/drawCompositeImage.js":function(e,t,n){n.r(t);var a=n(/*! ../layers.js */ "./layers.js"),o=n(/*! ../rendering/renderGrayscaleImage.js */ "./rendering/renderGrayscaleImage.js"),r=n(/*! ../rendering/renderColorImage.js */ "./rendering/renderColorImage.js"),i=n(/*! ../rendering/renderPseudoColorImage.js */ "./rendering/renderPseudoColorImage.js"),l=n(/*! ../rendering/renderLabelMapImage.js */ "./rendering/renderLabelMapImage.js"),s=n(/*! ../setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js"),u=n(/*! ./getDisplayedArea.js */ "./internal/getDisplayedArea.js");function d(e){var t=e.syncProps||{};t.originalScale=e.viewport.scale,e.syncProps=t}t.default=function(e,t){var n=e.element,c=Object(a.getLayers)(n),f=Object(a.getActiveLayer)(n),h=Object(a.getVisibleLayers)(n),m=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,m&&c.forEach(function(e){e.viewport&&d(e)}),!0===e.syncViewports&&function e(t,n){t.forEach(function(e){if(e!==n&&e.viewport&&n.viewport){e.syncProps||d(e);var t,a,o=(t=n,a=e,t.syncProps||d(t),a.syncProps||d(a),a.syncProps.originalScale/t.syncProps.originalScale);e.viewport.scale=n.viewport.scale*o,e.viewport.rotation=n.viewport.rotation,e.viewport.translation={x:n.viewport.translation.x/o,y:n.viewport.translation.y/o},e.viewport.hflip=n.viewport.hflip,e.viewport.vflip=n.viewport.vflip}})}(h,f);var g=e.canvas.getContext("2d",{desynchronized:!0});g.setTransform(1,0,0,1,0,0),g.fillStyle="black",g.fillRect(0,0,e.canvas.width,e.canvas.height),function e(t,n,a){n.forEach(function(e,n){if(e.image){t.save(),e.canvas=t.canvas,Object(s.default)(e,t);var d=e.viewport.colormap||e.options.colormap,c=e.viewport.labelmap,f=e.invalid||a;d&&""!==d&&!0===c?Object(l.addLabelMapLayer)(e,f):d&&""!==d?Object(i.addPseudoColorLayer)(e,f):!0===e.image.color?Object(r.addColorLayer)(e,f):Object(o.addGrayscaleLayer)(e,f,0===n),e.options&&e.options.opacity?t.globalAlpha=e.options.opacity:t.globalAlpha=1,e.options&&e.options.fillStyle&&(t.fillStyle=e.options.fillStyle),t.imageSmoothingEnabled=!e.viewport.pixelReplication,t.mozImageSmoothingEnabled=t.imageSmoothingEnabled;var h=Object(u.default)(e.image,e.viewport),m=h.tlhc.x-1,g=h.tlhc.y-1,v=h.brhc.x-m,$=h.brhc.y-g;t.drawImage(e.canvas,m,g,v,$,m,g,v,$),t.restore(),e.invalid=!1}})}(g,h,t)}},"./internal/drawImage.js":function(e,t,n){n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.needsRedraw=!0,t&&(e.invalid=!0)}},"./internal/drawImageSync.js":function(e,t,n){n.r(t);var a=n(/*! ./now.js */ "./internal/now.js"),o=n(/*! ./drawCompositeImage.js */ "./internal/drawCompositeImage.js"),r=n(/*! ../rendering/renderColorImage.js */ "./rendering/renderColorImage.js"),i=n(/*! ../rendering/renderGrayscaleImage.js */ "./rendering/renderGrayscaleImage.js"),l=n(/*! ../rendering/renderPseudoColorImage.js */ "./rendering/renderPseudoColorImage.js"),s=n(/*! ../rendering/renderLabelMapImage.js */ "./rendering/renderLabelMapImage.js"),u=n(/*! ../triggerEvent.js */ "./triggerEvent.js"),d=n(/*! ../events.js */ "./events.js");t.default=function(e,t){var n=e.image,c=e.element,f=e.layers||[];if(e.canvas&&e.image){var h=Object(a.default)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},f&&f.length)Object(o.default)(e,t);else if(n){var m=n.render;m||(m=e.viewport.colormap&&""!==e.viewport.colormap&&!0===e.image.labelmap?s.renderLabelMapImage:e.viewport.colormap&&""!==e.viewport.colormap?l.renderPseudoColorImage:n.color?r.renderColorImage:i.renderGrayscaleImage),m(e,t)}var g=Object(a.default)()-h,v={viewport:e.viewport,element:c,image:n,enabledElement:e,canvasContext:e.canvas.getContext("2d",{desynchronized:!0}),renderTimeInMs:g};n.stats.lastRenderTime=g,e.invalid=!1,e.needsRedraw=!1,Object(u.default)(c,d.default.IMAGE_RENDERED,v)}}},"./internal/generateColorLut.js":function(e,t,n){n.r(t);var a=n(/*! ./getVOILut.js */ "./internal/getVOILut.js");t.default=function(e,t,n,o,r){var i=e.maxPixelValue,l=e.minPixelValue,s=Math.min(l,0);void 0===e.cachedLut&&(e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(i-s+1));var u=e.cachedLut.lutArray,d=Object(a.default)(t,n,r);if(!0===o)for(var c=l;c<=i;c++)u[c+-s]=255-d(c);else for(var f=l;f<=i;f++)u[f+-s]=d(f);return u}},"./internal/generateLut.js":function(e,t,n){n.r(t);var a=n(/*! ./getModalityLUT.js */ "./internal/getModalityLUT.js"),o=n(/*! ./getVOILut.js */ "./internal/getVOILut.js");t.default=function(e,t,n,r,i,l){var s=e.maxPixelValue,u=e.minPixelValue,d=Math.min(u,0);void 0===e.cachedLut&&(e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(s-d+1));var c=e.cachedLut.lutArray,f=Boolean(e.slope%1)||Boolean(e.intercept%1),h=Object(a.default)(e.slope,e.intercept,i),m=Object(o.default)(t,n,l,f);if(!0===r)for(var g=u;g<=s;g++)c[g+-d]=255-m(h(g));else for(var v=u;v<=s;v++)c[v+-d]=m(h(v));return c}},"./internal/getCanvas.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return o});var a="cornerstone-canvas";function o(e){var t,n,o="canvas.".concat(a);return e.querySelector(o)||(t=e,(n=document.createElement("canvas")).style.display="block",n.classList.add(a),t.appendChild(n),n)}},"./internal/getDefaultViewport.js":function(e,t,n){n.r(t);var a=n(/*! ./createViewport.js */ "./internal/createViewport.js"),o=n(/*! ./getImageFitScale.js */ "./internal/getImageFitScale.js");t.default=function(e,t){if(void 0===e)throw Error("getDefaultViewport: parameter canvas must not be undefined");return void 0===t?Object(a.default)():{scale:Object(o.default)(e,t,0).scaleFactor,translation:{x:0,y:0},voi:{windowWidth:t.windowWidth,windowCenter:t.windowCenter},invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap,labelmap:Boolean(t.labelmap),displayedArea:void 0}}},"./internal/getDisplayedArea.js":function(e,t,n){n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&t.displayedArea)return t.displayedArea;if(void 0===e)throw Error("getDisplayedArea: parameter image must not be undefined");return{tlhc:{x:1,y:1},brhc:{x:e.columns,y:e.rows},rowPixelSpacing:void 0===e.rowPixelSpacing?1:e.rowPixelSpacing,columnPixelSpacing:void 0===e.columnPixelSpacing?1:e.columnPixelSpacing,presentationSizeMode:"NONE"}}},"./internal/getFillStyle.js":function(e,t,n){n.r(t),t.default=function(e){var t=(e.viewport||{}).invert;return -1!==["black","white"].indexOf((e.options||{}).fillStyle)&&t?"white":"black"}},"./internal/getImageFitScale.js":function(e,t,n){n.r(t);var a=n(/*! ./validator.js */ "./internal/validator.js"),o=n(/*! ./getImageSize.js */ "./internal/getImageSize.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(a.validateParameterUndefinedOrNull)(e,"getImageScale: parameter windowSize must not be undefined"),Object(a.validateParameterUndefinedOrNull)(t,"getImageScale: parameter image must not be undefined");var r=Object(o.default)(t,n),i=t.rowPixelSpacing||1,l=t.columnPixelSpacing||1,s=1,u=1;i<l?u=l/i:s=i/l;var d=e.height/r.height/s,c=e.width/r.width/u;return{verticalScale:d,horizontalScale:c,scaleFactor:Math.min(c,d)}}},"./internal/getImageSize.js":function(e,t,n){n.r(t);var a=n(/*! ./validator.js */ "./internal/validator.js");t.default=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(Object(a.validateParameterUndefinedOrNull)(e,"getImageSize: parameter image must not be undefined"),Object(a.validateParameterUndefinedOrNull)(e.width,"getImageSize: parameter image must have width"),Object(a.validateParameterUndefinedOrNull)(e.height,"getImageSize: parameter image must have height"),null==(t=n)||0===t||180===t)?{width:e.width,height:e.height}:{height:e.width,width:e.height}}},"./internal/getModalityLUT.js":function(e,t,n){n.r(t),t.default=function(e,t,n){var a,o,r,i,l,s;return n?(o=(a=n).lut[0],r=a.lut[a.lut.length-1],i=a.firstValueMapped+a.lut.length,function(e){return e<a.firstValueMapped?o:e>=i?r:a.lut[e]}):(l=e,s=t,function(e){return e*l+s})}},"./internal/getTransform.js":function(e,t,n){n.r(t);var a=n(/*! ./calculateTransform.js */ "./internal/calculateTransform.js");t.default=function(e){return Object(a.default)(e)}},"./internal/getVOILut.js":function(e,t,n){function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}n.r(t),t.default=function(e,t,n,o){var r,i,l,s,u,d,c,f,h;return n?(r=n,i=o,s=Math.max.apply(Math,function e(t){if(Array.isArray(t))return a(t)}(l=r.lut)||function e(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(l)||function e(t,n){if(t){if("string"==typeof t)return a(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);if("Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return a(t,n)}}(l)||function e(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).toString(2).length-8,u=r.lut[0]>>s,d=r.lut[r.lut.length-1]>>s,c=r.firstValueMapped+r.lut.length-1,function(e){return e<r.firstValueMapped?u:e>=c?d:i?r.lut[Math.round(e)-r.firstValueMapped]>>s:r.lut[e-r.firstValueMapped]>>s}):(f=e,h=t,function(e){return((e-h)/f+.5)*255})}},"./internal/guid.js":function(e,t,n){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}n.r(t),t.default=function(){return"".concat(a()+a(),"-").concat(a(),"-").concat(a(),"-").concat(a(),"-").concat(a()).concat(a()).concat(a())}},"./internal/index.js":function(e,t,n){n.r(t);var a=n(/*! ./transform.js */ "./internal/transform.js"),o=n(/*! ./calculateTransform.js */ "./internal/calculateTransform.js"),r=n(/*! ./drawImage.js */ "./internal/drawImage.js"),i=n(/*! ./generateLut.js */ "./internal/generateLut.js"),l=n(/*! ./getDefaultViewport.js */ "./internal/getDefaultViewport.js"),s=n(/*! ./getTransform.js */ "./internal/getTransform.js"),u=n(/*! ./requestAnimationFrame.js */ "./internal/requestAnimationFrame.js"),d=n(/*! ./setDefaultViewport.js */ "./internal/setDefaultViewport.js"),c=n(/*! ./storedColorPixelDataToCanvasImageData.js */ "./internal/storedColorPixelDataToCanvasImageData.js"),f=n(/*! ./storedPixelDataToCanvasImageData.js */ "./internal/storedPixelDataToCanvasImageData.js"),h=n(/*! ./storedPixelDataToCanvasImageDataColorLUT.js */ "./internal/storedPixelDataToCanvasImageDataColorLUT.js"),m=n(/*! ./storedPixelDataToCanvasImageDataPseudocolorLUT.js */ "./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),g=n(/*! ./storedPixelDataToCanvasImageDataRGBA.js */ "./internal/storedPixelDataToCanvasImageDataRGBA.js");t.default={drawImage:r.default,generateLut:i.default,getDefaultViewport:l.default,requestAnimationFrame:u.default,setDefaultViewport:d.default,storedPixelDataToCanvasImageData:f.default,storedPixelDataToCanvasImageDataRGBA:g.default,storedPixelDataToCanvasImageDataColorLUT:h.default,storedPixelDataToCanvasImageDataPseudocolorLUT:m.default,storedColorPixelDataToCanvasImageData:c.default,getTransform:s.default,calculateTransform:o.default,Transform:a.Transform}},"./internal/now.js":function(e,t,n){n.r(t),t.default=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(e,t,n){n.r(t),t.default=function(e){var t;return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||(t=e,void window.setTimeout(t,1e3/60))}},"./internal/setDefaultViewport.js":function(e,t,n){n.r(t),n.d(t,"state",function(){return a});var a={viewport:{}};t.default=function(e){a.viewport=e||{}}},"./internal/storedColorPixelDataToCanvasImageData.js":function(e,t,n){n.r(t);var a=n(/*! ./now.js */ "./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i=e.minPixelValue,l=0,s=0,u=r.length;if(o=Object(a.default)(),i<0)for(;s<u;)n[l++]=t[r[s++]+-i],n[l++]=t[r[s++]+-i],n[l]=t[r[s]+-i],s+=2,l+=2;else for(;s<u;)n[l++]=t[r[s++]],n[l++]=t[r[s++]],n[l]=t[r[s]],s+=2,l+=2;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/storedPixelDataToCanvasImageData.js":function(e,t,n){n.r(t);var a=n(/*! ./now.js */ "./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i=r.length,l=e.minPixelValue,s=3,u=0;if(o=Object(a.default)(),r instanceof Int16Array){if(l<0)for(;u<i;)n[s]=t[r[u++]+-l],s+=4;else for(;u<i;)n[s]=t[r[u++]],s+=4}else if(r instanceof Uint16Array)for(;u<i;)n[s]=t[r[u++]],s+=4;else if(l<0)for(;u<i;)n[s]=t[r[u++]+-l],s+=4;else for(;u<i;)n[s]=t[r[u++]],s+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(e,t,n){n.r(t);var a=n(/*! ../colors/index.js */ "./colors/index.js"),o=n(/*! ./now.js */ "./internal/now.js");t.default=function e(t,n,r){var i,l,s=Object(o.default)(),u=t.getPixelData();t.stats.lastGetPixelDataTime=Object(o.default)()-s;var d=u.length,c=t.minPixelValue,f=0,h=0;if(s=Object(o.default)(),l=n instanceof a.default.LookupTable?n.Table:n,c<0)for(;h<d;)i=l[u[h++]+-c],r[f++]=i[0],r[f++]=i[1],r[f++]=i[2],r[f++]=i[3];else for(;h<d;)i=l[u[h++]],r[f++]=i[0],r[f++]=i[1],r[f++]=i[2],r[f++]=i[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Object(o.default)()-s}},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(e,t,n){n.r(t);var a=n(/*! ../colors/index.js */ "./colors/index.js"),o=n(/*! ./now.js */ "./internal/now.js");t.default=function e(t,n,r,i){var l,s,u,d=Object(o.default)(),c=t.getPixelData();t.stats.lastGetPixelDataTime=Object(o.default)()-d;var f=c.length,h=t.minPixelValue,m=0,g=0;if(d=Object(o.default)(),u=r instanceof a.default.LookupTable?r.Table:r,h<0)for(;g<f;)s=u[l=n[c[g++]+-h]],i[m++]=s[0],i[m++]=s[1],i[m++]=s[2],i[m++]=s[3];else for(;g<f;)s=u[l=n[c[g++]]],i[m++]=s[0],i[m++]=s[1],i[m++]=s[2],i[m++]=s[3];t.stats.lastStoredPixelDataToCanvasImageDataTime=Object(o.default)()-d}},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(e,t,n){n.r(t);var a=n(/*! ./now.js */ "./internal/now.js");t.default=function(e,t,n){var o,r=Object(a.default)(),i=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var l=i.length,s=e.minPixelValue,u=0,d=0;if(r=Object(a.default)(),i instanceof Int16Array){if(s<0)for(;d<l;)o=t[i[d++]+-s],n[u++]=o,n[u++]=o,n[u++]=o,n[u++]=255;else for(;d<l;)o=t[i[d++]],n[u++]=o,n[u++]=o,n[u++]=o,n[u++]=255}else if(i instanceof Uint16Array)for(;d<l;)o=t[i[d++]],n[u++]=o,n[u++]=o,n[u++]=o,n[u++]=255;else if(s<0)for(;d<l;)o=t[i[d++]+-s],n[u++]=o,n[u++]=o,n[u++]=o,n[u++]=255;else for(;d<l;)o=t[i[d++]],n[u++]=o,n[u++]=o,n[u++]=o,n[u++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(e,t,n){n.r(t);var a=n(/*! ./now.js */ "./internal/now.js");t.default=function(e,t,n){var o=Object(a.default)(),r=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-o;var i=e.minPixelValue,l=0,s=0,u=r.length;if(o=Object(a.default)(),i<0)for(;s<u;)n[l++]=t[r[s++]+-i],n[l++]=t[r[s++]+-i],n[l++]=t[r[s++]+-i],n[l++]=r[s++];else for(;s<u;)n[l++]=t[r[s++]],n[l++]=t[r[s++]],n[l++]=t[r[s++]],n[l++]=r[s++];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-o}},"./internal/transform.js":function(e,t,n){n.r(t),n.d(t,"Transform",function(){return a});var a=function(){var e,t;function n(){(function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,n),this.reset()}return e=n,t=[{key:"reset",value:function e(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function e(){var t=new n;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function e(t){var n=this.m[0]*t.m[0]+this.m[2]*t.m[1],a=this.m[1]*t.m[0]+this.m[3]*t.m[1],o=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],i=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],l=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];this.m[0]=n,this.m[1]=a,this.m[2]=o,this.m[3]=r,this.m[4]=i,this.m[5]=l}},{key:"invert",value:function e(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*t,a=-this.m[1]*t,o=-this.m[2]*t,r=this.m[0]*t,i=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),l=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=n,this.m[1]=a,this.m[2]=o,this.m[3]=r,this.m[4]=i,this.m[5]=l}},{key:"rotate",value:function e(t){var n=Math.cos(t),a=Math.sin(t),o=this.m[0]*n+this.m[2]*a,r=this.m[1]*n+this.m[3]*a,i=-(this.m[0]*a)+this.m[2]*n,l=-(this.m[1]*a)+this.m[3]*n;this.m[0]=o,this.m[1]=r,this.m[2]=i,this.m[3]=l}},{key:"translate",value:function e(t,n){this.m[4]+=this.m[0]*t+this.m[2]*n,this.m[5]+=this.m[1]*t+this.m[3]*n}},{key:"scale",value:function e(t,n){this.m[0]*=t,this.m[1]*=t,this.m[2]*=n,this.m[3]*=n}},{key:"transformPoint",value:function e(t,n){var a=t,o=n;return{x:t=a*this.m[0]+o*this.m[2]+this.m[4],y:n=a*this.m[1]+o*this.m[3]+this.m[5]}}}],function e(t,n){for(var a=0;a<n.length;a++){var o=n[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(e.prototype,t),n}()},"./internal/tryEnableWebgl.js":function(e,t,n){n.r(t);var a=n(/*! ../webgl/index.js */ "./webgl/index.js");t.default=function(e){return a.default.renderer.isWebGLAvailable()?(a.default.renderer.initRenderer(),e.renderer="webgl",e.desynchronized=!0,e.preserveDrawingBuffer=!0,!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete e.renderer,delete e.preserveDrawingBuffer,!1)}},"./internal/validator.js":function(e,t,n){function a(e,t){if(void 0===e)throw Error(t)}function o(e,t){if(null==e)throw Error(t)}n.r(t),n.d(t,"validateParameterUndefined",function(){return a}),n.d(t,"validateParameterUndefinedOrNull",function(){return o})},"./invalidate.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),r=n(/*! ./events.js */ "./events.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);t.invalid=!0,t.needsRedraw=!0,Object(o.default)(e,r.default.INVALIDATED,{element:e})}},"./invalidateImageId.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/drawImage.js */ "./internal/drawImage.js");t.default=function(e){Object(a.getEnabledElementsByImageId)(e).forEach(function(e){Object(o.default)(e,!0)})}},"./layers.js":function(e,t,n){n.r(t),n.d(t,"rescaleImage",function(){return c}),n.d(t,"addLayer",function(){return f}),n.d(t,"removeLayer",function(){return h}),n.d(t,"getLayer",function(){return m}),n.d(t,"getLayers",function(){return g}),n.d(t,"getVisibleLayers",function(){return v}),n.d(t,"setActiveLayer",function(){return $}),n.d(t,"setLayerImage",function(){return p}),n.d(t,"getActiveLayer",function(){return _}),n.d(t,"purgeLayers",function(){return y});var a=n(/*! ./internal/guid.js */ "./internal/guid.js"),o=n(/*! ./enabledElements.js */ "./enabledElements.js"),r=n(/*! ./internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js"),i=n(/*! ./internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js"),l=n(/*! ./updateImage.js */ "./updateImage.js"),s=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),u=n(/*! ./events.js */ "./events.js");function d(e,t,n){var a=t.element,o={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};Object(s.default)(a,e,o)}function c(e,t){if(e.layerId===t.layerId)throw Error("rescaleImage: both arguments represent the same layer");var n=e.image,a=t.image;if(n.imageId&&a.imageId){var o=Object(i.default)(a,t.viewport),r=Object(i.default)(n,e.viewport),l=o.columnPixelSpacing*a.width/(r.columnPixelSpacing*n.width),s=t.viewport.scale/e.viewport.scale*l;t.viewport.scale=e.viewport.scale*s}}function f(e,t,n){var i,l=Object(a.default)(),s=Object(o.getEnabledElement)(e),f=s.layers;t&&(i=Object(r.default)(s.canvas,t),n&&n.viewport&&(i=Object.assign(i,n.viewport))),!1!==s.syncViewports&&(s.syncViewports=!0);var h={image:t,layerId:l,viewport:i,options:n||{},renderingTools:{}};return f.length&&t&&c(f[0],h),f.push(h),d(u.default.LAYER_ADDED,s,l),1===f.length&&t&&$(e,l),l}function h(e,t){var n=Object(o.getEnabledElement)(e),a=n.layers,r=n.layers.findIndex(function(e){return e.layerId===t});-1!==r&&(a.splice(r,1),t===n.activeLayerId&&a.length&&$(e,a[0].layerId),d(u.default.LAYER_REMOVED,n,t))}function m(e,t){return Object(o.getEnabledElement)(e).layers.find(function(e){return e.layerId===t})}function g(e){return Object(o.getEnabledElement)(e).layers}function v(e){return Object(o.getEnabledElement)(e).layers.filter(function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity})}function $(e,t){var n=Object(o.getEnabledElement)(e);if(n.activeLayerId!==t){var a=n.layers.findIndex(function(e){return e.layerId===t});if(-1===a)throw Error("setActiveLayer: layer not found in layers array");var r=n.layers[a];if(!r.image)throw Error("setActiveLayer: layer with undefined image cannot be set as active.");n.activeLayerId=t,n.image=r.image,n.viewport=r.viewport,Object(l.default)(e),d(u.default.ACTIVE_LAYER_CHANGED,n,t)}}function p(e,t,n){var a,i=Object(o.getEnabledElement)(e),l=i.layers[0];if(!(a=n?m(e,n):_(e)))throw Error("setLayerImage: Layer not found");if(a.image=t,!t){a.viewport=void 0;return}if(!a.viewport){var s=Object(r.default)(i.canvas,t);a.options&&a.options.viewport&&(a.viewport=Object.assign(s,a.options.viewport)),l.layerId!==n&&c(l,a)}}function _(e){var t=Object(o.getEnabledElement)(e);return t.layers.find(function(e){return e.layerId===t.activeLayerId})}function y(e){var t=Object(o.getEnabledElement)(e);t.layers=[],delete t.activeLayerId,delete t.lastSyncViewportsState}},"./metaData.js":function(e,t,n){n.r(t),n.d(t,"addProvider",function(){return o}),n.d(t,"removeProvider",function(){return r});var a=[];function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(t=0;t<a.length&&!(a[t].priority<=n);t++);a.splice(t,0,{priority:n,provider:e})}function r(e){for(var t=0;t<a.length;t++)if(a[t].provider===e){a.splice(t,1);break}}t.default={addProvider:o,removeProvider:r,get:function e(t,n){for(var o=0;o<a.length;o++){var r=a[o].provider(t,n);if(void 0!==r)return r}}}},"./pageToPixel.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/getTransform.js */ "./internal/getTransform.js");t.default=function(e,t,n){var r=Object(a.getEnabledElement)(e);if(void 0===r.image)throw Error("image has not been loaded yet");var i,l=e.getBoundingClientRect(),s={x:t-l.left-window.pageXOffset,y:n-l.top-window.pageYOffset},u=Object(o.default)(r);return u.invert(),u.transformPoint(s.x,s.y)}},"./pixelDataToFalseColorData.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return o});var a=n(/*! ./colors/index.js */ "./colors/index.js");function o(e,t){if(e.color&&!e.falseColor)throw Error("Color transforms are not implemented yet");var n,o,r=e.minPixelValue,i=0,l=0,s=e.width*e.height,u=e.origPixelData||e.getPixelData(),d=new Uint8Array(4*s);if(e.color=!0,e.falseColor=!0,e.origPixelData=u,t instanceof a.default.LookupTable)for(t.build();l<s;)n=u[l++],o=t.mapValue(n),d[i++]=o[0],d[i++]=o[1],d[i++]=o[2],d[i++]=o[3];else if(r<0)for(;l<s;)n=u[l++],d[i++]=t[n+-r][0],d[i++]=t[n+-r][1],d[i++]=t[n+-r][2],d[i++]=t[n+-r][3];else for(;l<s;)n=u[l++],d[i++]=t[n][0],d[i++]=t[n][1],d[i++]=t[n][2],d[i++]=t[n][3];e.rgba=!0,e.cachedLut=void 0,e.render=void 0,e.slope=1,e.intercept=0,e.minPixelValue=0,e.maxPixelValue=255,e.windowWidth=255,e.windowCenter=128,e.getPixelData=function(){return d}}},"./pixelToCanvas.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/getTransform.js */ "./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(o.default)(n).transformPoint(t.x,t.y)}},"./rendering/doesImageNeedToBeRendered.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=e.renderingTools.lastRenderedImageId,a=e.renderingTools.lastRenderedViewport;return t.imageId!==n||!a||a.windowCenter!==e.viewport.voi.windowCenter||a.windowWidth!==e.viewport.voi.windowWidth||a.invert!==e.viewport.invert||a.rotation!==e.viewport.rotation||a.hflip!==e.viewport.hflip||a.vflip!==e.viewport.vflip||a.modalityLUT!==e.viewport.modalityLUT||a.voiLUT!==e.viewport.voiLUT||a.colormap!==e.viewport.colormap}},"./rendering/getLut.js":function(e,t,n){n.r(t);var a=n(/*! ../internal/computeAutoVoi.js */ "./internal/computeAutoVoi.js"),o=n(/*! ./lutMatches.js */ "./rendering/lutMatches.js"),r=n(/*! ../internal/generateLut.js */ "./internal/generateLut.js");t.default=function(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&Object(o.default)(e.cachedLut.modalityLUT,t.modalityLUT)&&Object(o.default)(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!0!==n||(Object(a.default)(t,e),Object(r.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT),e.cachedLut.lutArray}},"./rendering/index.js":function(e,t,n){n.r(t);var a=n(/*! ./renderColorImage.js */ "./rendering/renderColorImage.js"),o=n(/*! ./renderGrayscaleImage.js */ "./rendering/renderGrayscaleImage.js"),r=n(/*! ./renderWebImage.js */ "./rendering/renderWebImage.js"),i=n(/*! ./renderPseudoColorImage.js */ "./rendering/renderPseudoColorImage.js"),l=n(/*! ./renderLabelMapImage.js */ "./rendering/renderLabelMapImage.js"),s=n(/*! ./renderToCanvas.js */ "./rendering/renderToCanvas.js");t.default={colorImage:a.renderColorImage,grayscaleImage:o.renderGrayscaleImage,webImage:r.renderWebImage,pseudoColorImage:i.renderPseudoColorImage,labelMapImage:l.renderLabelMapImage,toCanvas:s.default}},"./rendering/initializeRenderCanvas.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=e.renderingTools.renderCanvas;n.width=t.width,n.height=t.height;var a=n.getContext("2d",{desynchronized:!0});a.fillStyle="white",a.fillRect(0,0,n.width,n.height);var o=a.getImageData(0,0,t.width,t.height);e.renderingTools.renderCanvasContext=a,e.renderingTools.renderCanvasData=o}},"./rendering/lutMatches.js":function(e,t,n){n.r(t),t.default=function(e,t){return!e&&!t||!!e&&!!t&&e.id===t.id}},"./rendering/renderColorImage.js":function(e,t,n){n.r(t),n.d(t,"renderColorImage",function(){return g}),n.d(t,"addColorLayer",function(){return v});var a=n(/*! ../internal/now.js */ "./internal/now.js"),o=n(/*! ../internal/getFillStyle.js */ "./internal/getFillStyle.js"),r=n(/*! ../internal/generateColorLut.js */ "./internal/generateColorLut.js"),i=n(/*! ../internal/storedColorPixelDataToCanvasImageData.js */ "./internal/storedColorPixelDataToCanvasImageData.js"),l=n(/*! ../internal/storedRGBAPixelDataToCanvasImageData.js */ "./internal/storedRGBAPixelDataToCanvasImageData.js"),s=n(/*! ../setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js"),u=n(/*! ../webgl/index.js */ "./webgl/index.js"),d=n(/*! ./doesImageNeedToBeRendered.js */ "./rendering/doesImageNeedToBeRendered.js"),c=n(/*! ./initializeRenderCanvas.js */ "./rendering/initializeRenderCanvas.js"),f=n(/*! ./saveLastRendered.js */ "./rendering/saveLastRendered.js"),h=n(/*! ../internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js");function m(e,t,n){var o=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&o||(e.renderingTools.renderCanvas=document.createElement("canvas"));var s=e.renderingTools.renderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!1===Object(d.default)(e,t)&&!0!==n)return s;(s.width!==t.width||s.height!==t.height)&&Object(c.default)(e,t);var u,f,h=Object(a.default)(),m=(u=t,f=e.viewport,void 0!==u.cachedLut&&u.cachedLut.windowCenter===f.voi.windowCenter&&u.cachedLut.windowWidth===f.voi.windowWidth&&u.cachedLut.invert===f.invert||(Object(r.default)(u,f.voi.windowWidth,f.voi.windowCenter,f.invert),u.cachedLut.windowWidth=f.voi.windowWidth,u.cachedLut.windowCenter=f.voi.windowCenter,u.cachedLut.invert=f.invert),u.cachedLut.lutArray);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(a.default)()-h;var g=e.renderingTools.renderCanvasData,v=e.renderingTools.renderCanvasContext;return t.rgba?Object(l.default)(t,m,g.data):Object(i.default)(t,m,g.data),h=Object(a.default)(),v.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(a.default)()-h,s}function g(e,t){if(void 0===e)throw Error("renderColorImage: enabledElement parameter must not be undefined");var n,a=e.image;if(void 0===a)throw Error("renderColorImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(o.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(s.default)(e,r),n=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?u.default.renderer.render(e):m(e,a,t);var i=Object(h.default)(e.image,e.viewport),l=i.tlhc.x-1,d=i.tlhc.y-1,c=i.brhc.x-l,g=i.brhc.y-d;r.drawImage(n,l,d,c,g,l,d,c,g),e.renderingTools=Object(f.default)(e)}function v(e,t){if(void 0===e)throw Error("addColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw Error("addColorLayer: image must be loaded before it can be drawn");n.rgba=!0,e.canvas=m(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderGrayscaleImage.js":function(e,t,n){n.r(t),n.d(t,"renderGrayscaleImage",function(){return g}),n.d(t,"addGrayscaleLayer",function(){return v});var a=n(/*! ../internal/getFillStyle.js */ "./internal/getFillStyle.js"),o=n(/*! ../internal/storedPixelDataToCanvasImageData.js */ "./internal/storedPixelDataToCanvasImageData.js"),r=n(/*! ../internal/storedPixelDataToCanvasImageDataRGBA.js */ "./internal/storedPixelDataToCanvasImageDataRGBA.js"),i=n(/*! ../setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js"),l=n(/*! ../internal/now.js */ "./internal/now.js"),s=n(/*! ../webgl/index.js */ "./webgl/index.js"),u=n(/*! ./getLut.js */ "./rendering/getLut.js"),d=n(/*! ./doesImageNeedToBeRendered.js */ "./rendering/doesImageNeedToBeRendered.js"),c=n(/*! ./initializeRenderCanvas.js */ "./rendering/initializeRenderCanvas.js"),f=n(/*! ./saveLastRendered.js */ "./rendering/saveLastRendered.js"),h=n(/*! ../internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js");function m(e,t,n){var a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=!0===e.renderingTools.lastRenderedIsColor;(!e.renderingTools.renderCanvas||i)&&(e.renderingTools.renderCanvas=document.createElement("canvas"),Object(c.default)(e,t));var s=e.renderingTools.renderCanvas;if(!1===Object(d.default)(e,t)&&!0!==n)return s;(s.width!==t.width||s.height!==t.height)&&Object(c.default)(e,t);var f=Object(l.default)(),h=Object(u.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(l.default)()-f;var m=e.renderingTools.renderCanvasData,g=e.renderingTools.renderCanvasContext;return a?Object(o.default)(t,h,m.data):Object(r.default)(t,h,m.data),f=Object(l.default)(),g.putImageData(m,0,0),t.stats.lastPutImageDataTime=Object(l.default)()-f,s}function g(e,t){if(void 0===e)throw Error("drawImage: enabledElement parameter must not be undefined");var n,o=e.image;if(void 0===o)throw Error("drawImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(a.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(i.default)(e,r),n=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?s.default.renderer.render(e):m(e,o,t);var l=Object(h.default)(e.image,e.viewport),u=l.tlhc.x-1,d=l.tlhc.y-1,c=l.brhc.x-u,g=l.brhc.y-d;r.drawImage(n,u,d,c,g,u,d,c,g),e.renderingTools=Object(f.default)(e)}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw Error("addGrayscaleLayer: layer parameter must not be undefined");var a=e.image;if(void 0===a)throw Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.canvas=m(e,a,t,n);var o=e.canvas.getContext("2d",{desynchronized:!0});o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderLabelMapImage.js":function(e,t,n){n.r(t),n.d(t,"renderLabelMapImage",function(){return h}),n.d(t,"addLabelMapLayer",function(){return m});var a=n(/*! ../setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js"),o=n(/*! ../internal/now.js */ "./internal/now.js"),r=n(/*! ../internal/getFillStyle.js */ "./internal/getFillStyle.js"),i=n(/*! ./initializeRenderCanvas.js */ "./rendering/initializeRenderCanvas.js"),l=n(/*! ./saveLastRendered.js */ "./rendering/saveLastRendered.js"),s=n(/*! ./doesImageNeedToBeRendered.js */ "./rendering/doesImageNeedToBeRendered.js"),u=n(/*! ../internal/storedPixelDataToCanvasImageDataColorLUT.js */ "./internal/storedPixelDataToCanvasImageDataColorLUT.js"),d=n(/*! ../colors/index.js */ "./colors/index.js"),c=n(/*! ../internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js");function f(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,r=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),r&&"string"==typeof r&&(r=d.default.getColormap(r)),!r)throw Error("renderLabelMapImage: colormap not found.");var l=r.getId();if(!1===Object(s.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===l)return a;(a.width!==t.width||a.height!==t.height)&&Object(i.default)(e,t);var c=Object(o.default)();(!e.renderingTools.colorLut||n||e.renderingTools.colormapId!==l)&&(e.renderingTools.colorLut=r.createLookupTable(),e.renderingTools.colormapId=l),t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(o.default)()-c;var f=e.renderingTools.colorLut,h=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return Object(u.default)(t,f,h.data),c=Object(o.default)(),m.putImageData(h,0,0),t.stats.lastPutImageDataTime=Object(o.default)()-c,a}function h(e,t){if(void 0===e)throw Error("renderLabelMapImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw Error("renderLabelMapImage: image must be loaded before it can be drawn");var o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(r.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(a.default)(e,o);var i=f(e,n,t),s=Object(c.default)(e.image,e.viewport),u=s.tlhc.x-1,d=s.tlhc.y-1,h=s.brhc.x-u,m=s.brhc.y-d;o.drawImage(i,u,d,h,m,u,d,h,m),e.renderingTools=Object(l.default)(e)}function m(e,t){if(void 0===e)throw Error("addLabelMapLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw Error("addLabelMapLayer: image must be loaded before it can be drawn");e.canvas=f(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(l.default)(e)}},"./rendering/renderPseudoColorImage.js":function(e,t,n){n.r(t),n.d(t,"renderPseudoColorImage",function(){return m}),n.d(t,"addPseudoColorLayer",function(){return g});var a=n(/*! ../setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js"),o=n(/*! ../internal/now.js */ "./internal/now.js"),r=n(/*! ../internal/getFillStyle.js */ "./internal/getFillStyle.js"),i=n(/*! ./initializeRenderCanvas.js */ "./rendering/initializeRenderCanvas.js"),l=n(/*! ./getLut.js */ "./rendering/getLut.js"),s=n(/*! ./saveLastRendered.js */ "./rendering/saveLastRendered.js"),u=n(/*! ./doesImageNeedToBeRendered.js */ "./rendering/doesImageNeedToBeRendered.js"),d=n(/*! ../internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js */ "./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),c=n(/*! ../colors/index.js */ "./colors/index.js"),f=n(/*! ../internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js");function h(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,r=e.viewport.colormap||e.options.colormap;if(e.options&&e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),r&&"string"==typeof r&&(r=c.default.getColormap(r)),!r)throw Error("renderPseudoColorImage: colormap not found.");var s=r.getId();if(!1===Object(u.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===s)return a;(a.width!==t.width||a.height!==t.height)&&Object(i.default)(e,t);var f=Object(o.default)();(!e.renderingTools.colorLut||n||e.renderingTools.colormapId!==s)&&(r.setNumberOfColors(256),e.renderingTools.colorLut=r.createLookupTable(),e.renderingTools.colormapId=s);var h=Object(l.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(o.default)()-f;var m=e.renderingTools.colorLut,g=e.renderingTools.renderCanvasData,v=e.renderingTools.renderCanvasContext;return Object(d.default)(t,h,m,g.data),f=Object(o.default)(),v.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(o.default)()-f,a}function m(e,t){if(void 0===e)throw Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw Error("drawImage: image must be loaded before it can be drawn");var o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(r.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(a.default)(e,o);var i=h(e,n,t),l=Object(f.default)(e.image,e.viewport),u=l.tlhc.x-1,d=l.tlhc.y-1,c=l.brhc.x-u,m=l.brhc.y-d;o.drawImage(i,u,d,c,m,u,d,c,m),e.renderingTools=Object(s.default)(e)}function g(e,t){if(void 0===e)throw Error("addPseudoColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw Error("addPseudoColorLayer: image must be loaded before it can be drawn");e.canvas=h(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(s.default)(e)}},"./rendering/renderToCanvas.js":function(e,t,n){n.r(t);var a=n(/*! ../triggerEvent.js */ "./triggerEvent.js"),o=n(/*! ../events.js */ "./events.js"),r=n(/*! ../internal/drawImageSync.js */ "./internal/drawImageSync.js"),i=n(/*! ../internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js"),l=n(/*! ../internal/tryEnableWebgl.js */ "./internal/tryEnableWebgl.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===e)throw Error("renderToCanvas: parameter canvas cannot be undefined");s&&s.renderer&&"webgl"===s.renderer.toLowerCase()&&Object(l.default)(s);var u,d,c,f,h=Object(i.default)(e,t);n&&Object.assign(h,n);var m=(u=e,d=t,c=s,f=h,{element:u,canvas:u,image:d,invalid:!0,needsRedraw:!0,options:c,layers:[],data:{},renderingTools:{},viewport:f}),g={enabledElement:m,timestamp:Date.now()};Object(a.default)(m.element,o.default.PRE_RENDER,g),Object(r.default)(m,m.invalid)}},"./rendering/renderWebImage.js":function(e,t,n){n.r(t),n.d(t,"renderWebImage",function(){return i});var a=n(/*! ../setToPixelCoordinateSystem.js */ "./setToPixelCoordinateSystem.js"),o=n(/*! ./renderColorImage.js */ "./rendering/renderColorImage.js"),r=n(/*! ../internal/getDisplayedArea.js */ "./internal/getDisplayedArea.js");function i(e,t){if(void 0===e)throw Error("renderWebImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw Error("renderWebImage: image must be loaded before it can be drawn");if(e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert){var i=e.canvas.getContext("2d",{desynchronized:!0});i.setTransform(1,0,0,1,0,0),i.fillStyle="black",i.fillRect(0,0,e.canvas.width,e.canvas.height),i.imageSmoothingEnabled=!e.viewport.pixelReplication,i.mozImageSmoothingEnabled=i.imageSmoothingEnabled,Object(a.default)(e,i);var l=Object(r.default)(e.image,e.viewport),s=l.tlhc.x-1,u=l.tlhc.y-1,d=l.brhc.x-s,c=l.brhc.y-u;i.drawImage(n.getImage(),s,u,d,c,s,u,d,c)}else Object(o.renderColorImage)(e,t)}},"./rendering/saveLastRendered.js":function(e,t,n){n.r(t),t.default=function(e){var t=e.image.imageId,n=e.viewport,a=e.image.color;return e.renderingTools.lastRenderedImageId=t,e.renderingTools.lastRenderedIsColor=a,e.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},e.renderingTools}},"./requestPool/RequestPoolManager.ts":function(e,t,n){function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function e(t,n){if(t){if("string"==typeof t)return o(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);if("Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o(t,n)}}(e))||t){n&&(e=n);var a=0,r=function e(){};return{s:r,n:function t(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function e(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();return l=t.done,t},e:function e(t){s=!0,i=t},f:function e(){try{l||null==n.return||n.return()}finally{if(s)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"RequestPoolManager",function(){return i});var i=function(){var e,t;function n(){(function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,n),r(this,"requestPool",void 0),r(this,"awake",void 0),r(this,"numRequests",void 0),r(this,"maxNumRequests",void 0),r(this,"grabDelay",void 0),r(this,"timeoutHandle",void 0),this.requestPool={interaction:{0:[]},thumbnail:{0:[]},prefetch:{0:[]}},this.awake=!1,this.grabDelay=5,this.numRequests={interaction:0,thumbnail:0,prefetch:0},this.maxNumRequests={interaction:6,thumbnail:6,prefetch:5}}return e=n,t=[{key:"destroy",value:function e(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}},{key:"addRequest",value:function e(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={requestFn:t,type:n,additionalDetails:a};void 0===this.requestPool[n][o]&&(this.requestPool[n][o]=[]),r?this.requestPool[n][o].unshift(i):this.requestPool[n][o].push(i),this.awake||(this.awake=!0,this.startGrabbing())}},{key:"filterRequests",value:function e(t){var n=this;Object.keys(this.requestPool).forEach(function(e){var a=n.requestPool[e];Object.keys(a).forEach(function(e){a[e]=a[e].filter(function(e){return t(e)})})})}},{key:"clearRequestStack",value:function e(t){if(!this.requestPool[t])throw Error("No category for the type ".concat(t," found"));this.requestPool[t]={0:[]}}},{key:"sendRequest",value:function e(t){var n=this,a=t.requestFn,o=t.type;this.numRequests[o]++,this.awake=!0,a().finally(function(){n.numRequests[o]--,n.startAgain()})}},{key:"startGrabbing",value:function e(){for(var t=this.maxNumRequests.interaction+this.maxNumRequests.thumbnail+this.maxNumRequests.prefetch,n=t-(this.numRequests.interaction+this.numRequests.thumbnail+this.numRequests.prefetch),a=0;a<n;a++){var o=this.getNextRequest();if(!1===o)break;o&&this.sendRequest(o)}}},{key:"startAgain",value:function e(){var t=this;this.awake&&(this.grabDelay?this.timeoutHandle=window.setTimeout(function(){t.startGrabbing()},this.grabDelay):this.startGrabbing())}},{key:"getSortedPriorityGroups",value:function e(t){var n=this;return Object.keys(this.requestPool[t]).map(Number).filter(function(e){return n.requestPool[t][e].length}).sort()}},{key:"getNextRequest",value:function e(){var t,n=this.getSortedPriorityGroups("interaction"),o=a(n);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(this.requestPool.interaction[r].length&&this.numRequests.interaction<this.maxNumRequests.interaction)return this.requestPool.interaction[r].shift()}}catch(i){o.e(i)}finally{o.f()}var l,s=this.getSortedPriorityGroups("thumbnail"),u=a(s);try{for(u.s();!(l=u.n()).done;){var d=l.value;if(this.requestPool.thumbnail[d].length&&this.numRequests.thumbnail<this.maxNumRequests.thumbnail)return this.requestPool.thumbnail[d].shift()}}catch(c){u.e(c)}finally{u.f()}var f,h=this.getSortedPriorityGroups("prefetch"),m=a(h);try{for(m.s();!(f=m.n()).done;){var g=f.value;if(this.requestPool.prefetch[g].length&&this.numRequests.prefetch<this.maxNumRequests.prefetch)return this.requestPool.prefetch[g].shift()}}catch(v){m.e(v)}finally{m.f()}return n.length||s.length||h.length||(this.awake=!1),!1}},{key:"getRequestPool",value:function e(){return this.requestPool}}],function e(t,n){for(var a=0;a<n.length;a++){var o=n[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(e.prototype,t),n}()},"./requestPool/imageLoadPoolManager.ts":function(e,t,n){n.r(t);var a=new(n(/*! ./RequestPoolManager.ts */ "./requestPool/RequestPoolManager.ts")).RequestPoolManager;a.maxNumRequests={interaction:1e3,thumbnail:1e3,prefetch:1e3},a.grabDelay=0,t.default=a},"./requestPool/imageRetrievalPoolManager.ts":function(e,t,n){n.r(t);var a=new(n(/*! ./RequestPoolManager.ts */ "./requestPool/RequestPoolManager.ts")).RequestPoolManager;a.maxNumRequests={interaction:20,thumbnail:20,prefetch:20},a.grabDelay=0,t.default=a},"./reset.js":function(e,t,n){n.r(t);var a=n(/*! ./internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js"),o=n(/*! ./enabledElements.js */ "./enabledElements.js"),r=n(/*! ./updateImage.js */ "./updateImage.js");t.default=function(e){var t=Object(o.getEnabledElement)(e);t.viewport=Object(a.default)(t.canvas,t.image),Object(r.default)(e)}},"./resize.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./fitToWindow.js */ "./fitToWindow.js"),r=n(/*! ./updateImage.js */ "./updateImage.js"),i=n(/*! ./triggerEvent.js */ "./triggerEvent.js"),l=n(/*! ./internal/getImageSize.js */ "./internal/getImageSize.js"),s=n(/*! ./events.js */ "./events.js");t.default=function(e,t){var n,u,d,c,f,h,m,g,v,$,p,_,y,x,T,b,w,C=Object(a.getEnabledElement)(e),E=C.canvas.width,j=C.canvas.height;b=e,(w=C.canvas).width!==b.clientWidth&&(w.width=b.clientWidth,w.style.width="".concat(b.clientWidth,"px")),w.height!==b.clientHeight&&(w.height=b.clientHeight,w.style.height="".concat(b.clientHeight,"px")),Object(i.default)(e,s.default.ELEMENT_RESIZED,{element:e}),void 0!==C.image&&(t||(n=C,u=E,d=j,c=n.viewport.scale,h=Math.round((f=Object(l.default)(n.image,n.viewport.rotation)).width*c),m=Math.round(f.height*c),g=n.viewport.translation.x,v=n.viewport.translation.y,h===u&&m<=d||h<=u&&m===d&&0===g&&0===v)?Object(o.default)(e):($=C,p=E,_=j,y=$.viewport.scale,x=$.canvas.width,T=$.canvas.height,$.viewport.scale=Math.sqrt(x/p*(T/_))*y,Object(r.default)(e)))}},"./setToPixelCoordinateSystem.js":function(e,t,n){n.r(t);var a=n(/*! ./internal/calculateTransform.js */ "./internal/calculateTransform.js");t.default=function(e,t,n){if(void 0===e)throw Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw Error("setToPixelCoordinateSystem: parameter context must not be undefined");var o=Object(a.default)(e,n);t.setTransform(o.m[0],o.m[1],o.m[2],o.m[3],o.m[4],o.m[5])}},"./setViewport.js":function(e,t,n){n.r(t);var a=n(/*! ./internal/getDefaultViewport.js */ "./internal/getDefaultViewport.js"),o=n(/*! ./enabledElements.js */ "./enabledElements.js"),r=n(/*! ./updateImage.js */ "./updateImage.js");t.default=function(e,t){var n=Object(o.getEnabledElement)(e);if(void 0===n.viewport&&(n.viewport=Object(a.default)(n.canvas)),t)for(var i in t)null!==t[i]&&(n.viewport[i]=t[i]);n.viewport.voi.windowWidth&&(n.viewport.voi.windowWidth=Math.max(n.viewport.voi.windowWidth,1e-6)),n.viewport.scale&&(n.viewport.scale=Math.max(n.viewport.scale,1e-4)),n.viewport.rotation%=360,n.viewport.rotation<0&&(n.viewport.rotation+=360),n.image&&Object(r.default)(e)}},"./triggerEvent.js":function(e,t,n){function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./updateImage.js":function(e,t,n){n.r(t);var a=n(/*! ./enabledElements.js */ "./enabledElements.js"),o=n(/*! ./internal/drawImage.js */ "./internal/drawImage.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.getEnabledElement)(e);Object(o.default)(n,t)}},"./webgl/createProgramFromString.js":function(e,t,n){function a(e,t,n){var a=e.createShader(n);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost()){var o=e.getShaderInfoLog(a);console.error("Could not compile shader:\n".concat(o))}return a}n.r(t),t.default=function(e,t,n){var o=a(e,t,e.VERTEX_SHADER),r=a(e,n,e.FRAGMENT_SHADER);return function e(t,n,a){var o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,a),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)&&!t.isContextLost()){var r=t.getProgramInfoLog(o);console.error("WebGL program filed to link:\n".concat(r))}return o}(e,o,r)}},"./webgl/index.js":function(e,t,n){n.r(t);var a=n(/*! ./renderer.js */ "./webgl/renderer.js"),o=n(/*! ./createProgramFromString.js */ "./webgl/createProgramFromString.js"),r=n(/*! ./textureCache.js */ "./webgl/textureCache.js"),i={createProgramFromString:o.default,renderer:{render:a.render,initRenderer:a.initRenderer,getRenderCanvas:a.getRenderCanvas,isWebGLAvailable:a.isWebGLAvailable},textureCache:r.default};Object.defineProperty(i,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function e(){return a.isWebGLInitialized}}),t.default=i},"./webgl/renderer.js":function(e,t,n){n.r(t),n.d(t,"isWebGLInitialized",function(){return c}),n.d(t,"getRenderCanvas",function(){return f}),n.d(t,"initRenderer",function(){return h}),n.d(t,"render",function(){return $}),n.d(t,"isWebGLAvailable",function(){return p});var a,o,r,i=n(/*! ./shaders/index.js */ "./webgl/shaders/index.js"),l=n(/*! ./vertexShader.js */ "./webgl/vertexShader.js"),s=n(/*! ./textureCache.js */ "./webgl/textureCache.js"),u=n(/*! ./createProgramFromString.js */ "./webgl/createProgramFromString.js"),d=document.createElement("canvas"),c=!1;function f(){return d}function h(){!0!==c&&function e(t){a=null;try{var n={desynchronized:!0,preserveDrawingBuffer:!0};a=t.getContext("webgl",n)||t.getContext("experimental-webgl",n),t.removeEventListener("webglcontextlost",m,!1),t.addEventListener("webglcontextlost",m,!1),t.removeEventListener("webglcontextrestored",g,!1),t.addEventListener("webglcontextrestored",g,!1)}catch(o){throw Error("Error creating WebGL context")}return a||(console.error("Unable to initialize WebGL. Your browser may not support it."),a=null),a}(d)&&(r=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,r),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),o=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,o),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),function e(){for(var t in i.shaders){var n=i.shaders[t];n.attributes={},n.uniforms={},n.vert=l.vertexShader,n.program=Object(u.default)(a,n.vert,n.frag),n.attributes.texCoordLocation=a.getAttribLocation(n.program,"a_texCoord"),a.enableVertexAttribArray(n.attributes.texCoordLocation),n.attributes.positionLocation=a.getAttribLocation(n.program,"a_position"),a.enableVertexAttribArray(n.attributes.positionLocation),n.uniforms.resolutionLocation=a.getUniformLocation(n.program,"u_resolution")}}(),c=!0)}function m(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function g(e){e.preventDefault(),c=!1,s.default.purgeCache(),h()}function v(e){if(e.color)return"rgb";var t=e.getPixelData();return t instanceof Int16Array?"int16":t instanceof Uint16Array?"uint16":t instanceof Int8Array?"int8":"uint8"}function $(e){var t,n,l,u,c,f,h,m,g=e.image;d.width=g.width,d.height=g.height;var $,p,_=e.viewport,y=($=g,p=v($),i.shaders.hasOwnProperty(p)?i.shaders[p]:i.shaders.rgb),x=(t=g,m=s.default.getImageTexture(t.imageId),!m&&(m=(n=t,l={uint8:a.LUMINANCE,int8:a.LUMINANCE_ALPHA,uint16:a.LUMINANCE_ALPHA,int16:a.RGB,rgb:a.RGB},c=l[u=v(n)],f=a.createTexture(),a.bindTexture(a.TEXTURE_2D,f),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_ALIGNMENT,1),h=i.dataUtilities[u].storedPixelDataToImageData(n,n.width,n.height),a.texImage2D(a.TEXTURE_2D,0,c,n.width,n.height,0,c,a.UNSIGNED_BYTE,h),{texture:f,sizeInBytes:n.width*n.height*({int8:1,uint16:2,int16:3,rgb:3})[u]}),s.default.putImageTexture(t,m)),m.texture);return function e(t,n,i,l,s){for(var u in a.clearColor(1,0,0,1),a.viewport(0,0,l,s),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(t.program),a.bindBuffer(a.ARRAY_BUFFER,o),a.vertexAttribPointer(t.attributes.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,r),a.vertexAttribPointer(t.attributes.positionLocation,2,a.FLOAT,!1,0,0),n){var d=a.getUniformLocation(t.program,u);if(d){var c=n[u],f=c.type,h=c.value;"i"===f?a.uniform1i(d,h):"f"===f?a.uniform1f(d,h):"2f"===f&&a.uniform2f(d,h[0],h[1])}}(function e(t,n,a){t.bufferData(t.ARRAY_BUFFER,new Float32Array([n,a,0,a,n,0,0,0]),t.STATIC_DRAW)})(a,l,s),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i),a.drawArrays(a.TRIANGLE_STRIP,0,4)}(y,{u_resolution:{type:"2f",value:[g.width,g.height]},wc:{type:"f",value:_.voi.windowCenter},ww:{type:"f",value:_.voi.windowWidth},slope:{type:"f",value:g.slope},intercept:{type:"f",value:g.intercept},minPixelValue:{type:"f",value:g.minPixelValue},invert:{type:"i",value:_.invert?1:0}},x,g.width,g.height),d}function p(){var e={failIfMajorPerformanceCaveat:!0};try{var t=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(n){return!1}}},"./webgl/shaders/index.js":function(e,t,n){n.r(t),n.d(t,"shaders",function(){return s}),n.d(t,"dataUtilities",function(){return u});var a=n(/*! ./int16.js */ "./webgl/shaders/int16.js"),o=n(/*! ./int8.js */ "./webgl/shaders/int8.js"),r=n(/*! ./rgb.js */ "./webgl/shaders/rgb.js"),i=n(/*! ./uint16.js */ "./webgl/shaders/uint16.js"),l=n(/*! ./uint8.js */ "./webgl/shaders/uint8.js"),s={int16:a.int16Shader,int8:o.int8Shader,rgb:r.rgbShader,uint16:i.uint16Shader,uint8:l.uint8Shader},u={int16:a.int16DataUtilities,int8:o.int8DataUtilities,rgb:r.rgbDataUtilities,uint16:i.uint16DataUtilities,uint8:l.uint8DataUtilities}},"./webgl/shaders/int16.js":function(e,t,n){n.r(t),n.d(t,"int16DataUtilities",function(){return o}),n.d(t,"int16Shader",function(){return a});var a={},o={storedPixelDataToImageData:function e(t){for(var n=t.getPixelData(),a=new Uint8Array(t.width*t.height*3),o=0,r=0;r<n.length;r++){var i=Math.abs(n[r]);a[o++]=255&i,a[o++]=i>>8,a[o++]=n[r]<0?0:1}return a}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(e,t,n){n.r(t),n.d(t,"int8DataUtilities",function(){return o}),n.d(t,"int8Shader",function(){return a});var a={},o={storedPixelDataToImageData:function e(t){for(var n=t.getPixelData(),a=new Uint8Array(t.width*t.height*2),o=0,r=0;r<n.length;r++)a[o++]=n[r],a[o++]=n[r]<0?0:1;return a}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(e,t,n){n.r(t),n.d(t,"rgbDataUtilities",function(){return o}),n.d(t,"rgbShader",function(){return a});var a={},o={storedPixelDataToImageData:function e(t){var n=t.minPixelValue,a=0,o=0,r=t.width*t.height*4,i=t.width*t.height*3,l=t.getPixelData(),s=new Uint8Array(i);if(n<0)for(;o<r;)s[a++]=l[o++]+-n,s[a++]=l[o++]+-n,s[a++]=l[o++]+-n,o+=1;else for(;o<r;)s[a++]=l[o++],s[a++]=l[o++],s[a++]=l[o++],o+=1;return s}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(e,t,n){n.r(t),n.d(t,"uint16DataUtilities",function(){return o}),n.d(t,"uint16Shader",function(){return a});var a={},o={storedPixelDataToImageData:function e(t){for(var n=t.getPixelData(),a=new Uint8Array(t.width*t.height*2),o=0,r=0;r<n.length;r++){var i=n[r];a[o++]=255&i,a[o++]=i>>8}return a}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(e,t,n){n.r(t),n.d(t,"uint8DataUtilities",function(){return o}),n.d(t,"uint8Shader",function(){return a});var a={},o={storedPixelDataToImageData:function e(t){return t.getPixelData()}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../triggerEvent.js */ "./triggerEvent.js"),r={},i=[],l=268435456,s=0;function u(){if(!(s<=l)){for(i.sort(function e(t,n){return t.timeStamp>n.timeStamp?-1:t.timeStamp<n.timeStamp?1:0});s>l;){var e=i[i.length-1];s-=e.sizeInBytes,delete r[e.imageId],i.pop(),Object(o.default)(a.events,a.default.WEBGL_TEXTURE_REMOVED,{imageId:e.imageId})}var t={maximumSizeInBytes:l,cacheSizeInBytes:s,numberOfImagesCached:i.length};Object(o.default)(a.events,a.default.WEBGL_TEXTURE_CACHE_FULL,t)}}t.default={purgeCache:function e(){for(;i.length>0;)delete r[i.pop().imageId];s=0},getImageTexture:function e(t){if(void 0===t)throw Error("getImageTexture: imageId must not be undefined");var n=r[t];if(void 0!==n)return n.timeStamp=new Date,n.imageTexture},putImageTexture:function e(t,n){var a=t.imageId;if(void 0===t)throw Error("putImageTexture: image must not be undefined");if(void 0===a)throw Error("putImageTexture: imageId must not be undefined");if(void 0===n)throw Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(r,a))throw Error("putImageTexture: imageId already in cache");var o={imageId:a,imageTexture:n,timeStamp:new Date,sizeInBytes:n.sizeInBytes};if(r[a]=o,i.push(o),void 0===n.sizeInBytes)throw Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===n.sizeInBytes.toFixed)throw Error("putImageTexture: imageTexture.sizeInBytes is not a number");s+=o.sizeInBytes,u()},removeImageTexture:function e(t){if(void 0===t)throw Error("removeImageTexture: imageId must not be undefined");var n=r[t];if(void 0===n)throw Error("removeImageTexture: imageId must not be undefined");return i.splice(i.indexOf(n),1),s-=n.sizeInBytes,delete r[t],n.imageTexture},setMaximumSizeBytes:function e(t){if(void 0===t)throw Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===t.toFixed)throw Error("setMaximumSizeBytes: parameter numBytes must be a number");l=t,u()}}},"./webgl/vertexShader.js":function(e,t,n){n.r(t),n.d(t,"vertexShader",function(){return a});var a="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})},i.exports=s(),b.exports),C=t(w),E={exports:{}},j=g?E.exports:(g=1,u=E,window,c=function(){return function(e){var t,n,a,o,r=window.webpackHotUpdate;window.webpackHotUpdate=function e(t,n){(function e(t,n){if(_[t]&&p[t]){for(var o in p[t]=!1,n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o]);0==--g&&0===v&&b()}})(t,n),r&&r(t,n)};var i=!0,l="d00b0c5c15ba1ce5d787",s={},u=[],d=[];function c(e){var n=C[e];if(!n)return E;var a=function(a){return n.hot.active?(C[a]?-1===C[a].parents.indexOf(e)&&C[a].parents.push(e):(u=[e],t=a),-1===n.children.indexOf(a)&&n.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),u=[]),E(a)},o=function e(t){return{configurable:!0,enumerable:!0,get:function(){return E[t]},set:function(e){E[t]=e}}};for(var r in E)Object.prototype.hasOwnProperty.call(E,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(a,r,o(r));return a.e=function(e){return"ready"===h&&m("prepare"),v++,E.e(e).then(t,function(e){throw t(),e});function t(){v--,"prepare"===h&&($[e]||T(e),0===v&&0===g&&b())}},a.t=function(e,t){return 1&t&&(e=a(e)),E.t(e,-2&t)},a}var f=[],h="idle";function m(e){h=e;for(var t=0;t<f.length;t++)f[t].call(null,e)}var g=0,v=0,$={},p={},_={};function y(e){return+e+""===e?+e:e}function x(e){if("idle"!==h)throw Error("check() is only allowed in idle status");i=e,m("check");var t=1e4;return(t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(Error("No browser support"));try{var a=new XMLHttpRequest,o=E.p+""+l+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(r){return n(r)}a.onreadystatechange=function(){if(4===a.readyState){if(0===a.status)n(Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){n(r);return}e(t)}}}})).then(function(e){if(!e)return m("idle"),null;p={},$={},_=e.c,o=e.h,m("prepare");var t=new Promise(function(e,t){n={resolve:e,reject:t}});return a={},T("cornerstoneTools"),"prepare"===h&&0===v&&0===g&&b(),t})}function T(e){if(_[e]){var t,n;p[e]=!0,g++,t=e,(n=document.createElement("script")).charset="utf-8",n.src=E.p+""+t+"."+l+".hot-update.js",document.head.appendChild(n)}else $[e]=!0}function b(){m("ready");var e=n;if(n=null,e){if(i)Promise.resolve().then(function(){return w(i)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&t.push(y(o));e.resolve(t)}}}function w(t){if("ready"!==h)throw Error("apply() is only allowed in ready status");function n(e){for(var t=[e],n={},a=t.map(function(e){return{chain:[e],id:e}});a.length>0;){var o=a.pop(),i=o.id,l=o.chain;if((w=C[i])&&!w.hot._selfAccepted){if(w.hot._selfDeclined)return{type:"self-declined",chain:l,moduleId:i};if(w.hot._main)return{type:"unaccepted",chain:l,moduleId:i};for(var s=0;s<w.parents.length;s++){var u=w.parents[s],d=C[u];if(d){if(d.hot._declinedDependencies[i])return{type:"declined",chain:l.concat([u]),moduleId:i,parentId:u};if(-1===t.indexOf(u)){if(d.hot._acceptedDependencies[i]){n[u]||(n[u]=[]),r(n[u],[i]);continue}delete n[u],t.push(u),a.push({chain:l.concat([u]),id:u})}}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var i,d,c,f={},g=[],v={},$=function e(){console.warn("[HMR] unexpected require("+S.moduleId+") to disposed module")};for(var p in a)if(Object.prototype.hasOwnProperty.call(a,p)){j=y(p),S=a[p]?n(j):{type:"disposed",moduleId:p};var x,T,b,w,j,S,I=!1,P=!1,M=!1,k="";switch(S.chain&&(k="\nUpdate propagation: "+S.chain.join(" -> ")),S.type){case"self-declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(I=Error("Aborted because of self decline: "+S.moduleId+k));break;case"declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(I=Error("Aborted because of declined dependency: "+S.moduleId+" in "+S.parentId+k));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(S),t.ignoreUnaccepted||(I=Error("Aborted because "+j+" is not accepted"+k));break;case"accepted":t.onAccepted&&t.onAccepted(S),P=!0;break;case"disposed":t.onDisposed&&t.onDisposed(S),M=!0;break;default:throw Error("Unexception type "+S.type)}if(I)return m("abort"),Promise.reject(I);if(P)for(j in v[j]=a[j],r(g,S.outdatedModules),S.outdatedDependencies)Object.prototype.hasOwnProperty.call(S.outdatedDependencies,j)&&(f[j]||(f[j]=[]),r(f[j],S.outdatedDependencies[j]));M&&(r(g,[S.moduleId]),v[j]=$)}var D=[];for(T=0;T<g.length;T++)C[j=g[T]]&&C[j].hot._selfAccepted&&v[j]!==$&&D.push({module:j,errorHandler:C[j].hot._selfAccepted});m("dispose"),Object.keys(_).forEach(function(e){if(!1===_[e]){var t;t=e,delete installedChunks[t]}});for(var L=g.slice();L.length>0;)if(w=C[j=L.pop()]){var R={},A=w.hot._disposeHandlers;for(b=0;b<A.length;b++)(x=A[b])(R);for(s[j]=R,w.hot.active=!1,delete C[j],delete f[j],b=0;b<w.children.length;b++){var O=C[w.children[b]];O&&(i=O.parents.indexOf(j))>=0&&O.parents.splice(i,1)}}for(j in f)if(Object.prototype.hasOwnProperty.call(f,j)&&(w=C[j]))for(b=0,c=f[j];b<c.length;b++)d=c[b],(i=w.children.indexOf(d))>=0&&w.children.splice(i,1);for(j in m("apply"),l=o,v)Object.prototype.hasOwnProperty.call(v,j)&&(e[j]=v[j]);var H=null;for(j in f)if(Object.prototype.hasOwnProperty.call(f,j)&&(w=C[j])){c=f[j];var B=[];for(T=0;T<c.length;T++)if(d=c[T],x=w.hot._acceptedDependencies[d]){if(-1!==B.indexOf(x))continue;B.push(x)}for(T=0;T<B.length;T++){x=B[T];try{x(c)}catch(U){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:j,dependencyId:c[T],error:U}),t.ignoreErrored||H||(H=U)}}}for(T=0;T<D.length;T++){var F=D[T];u=[j=F.module];try{E(j)}catch(N){if("function"==typeof F.errorHandler)try{F.errorHandler(N)}catch(z){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:j,error:z,originalError:N}),t.ignoreErrored||H||(H=z),H||(H=N)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:j,error:N}),t.ignoreErrored||H||(H=N)}}return H?(m("fail"),Promise.reject(H)):(m("idle"),new Promise(function(e){e(g)}))}var C={};function E(n){if(C[n])return C[n].exports;var a,o,r=C[n]={i:n,l:!1,exports:{},hot:(a=n,o={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:t!==a,active:!0,accept:function(e,t){if(void 0===e)o._selfAccepted=!0;else if("function"==typeof e)o._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)o._acceptedDependencies[e[n]]=t||function(){};else o._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)o._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)o._declinedDependencies[e[t]]=!0;else o._declinedDependencies[e]=!0},dispose:function(e){o._disposeHandlers.push(e)},addDisposeHandler:function(e){o._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=o._disposeHandlers.indexOf(e);t>=0&&o._disposeHandlers.splice(t,1)},check:x,apply:w,status:function(e){if(!e)return h;f.push(e)},addStatusHandler:function(e){f.push(e)},removeStatusHandler:function(e){var t=f.indexOf(e);t>=0&&f.splice(t,1)},data:s[a]},t=void 0,o),parents:(d=u,u=[],d),children:[]};return e[n].call(r.exports,r,r.exports,c(n)),r.l=!0,r.exports}return E.m=e,E.c=C,E.d=function(e,t,n){E.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},E.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},E.t=function(e,t){if(1&t&&(e=E(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(E.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)E.d(n,a,(function(t){return e[t]}).bind(null,a));return n},E.n=function(e){var t=e&&e.__esModule?function t(){return e.default}:function t(){return e};return E.d(t,"a",t),t},E.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},E.p="",E.h=function(){return l},c("./index.js")(E.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function e(t){if(Array.isArray(t)){for(var n=0,a=Array(t.length);n<t.length;n++)a[n]=t[n];return a}}},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function e(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(e,t){function n(e,t,n,a,o,r,i){try{var l=e[r](i),s=l.value}catch(u){n(u);return}l.done?t(s):Promise.resolve(s).then(a,o)}e.exports=function e(t){return function(){var e=this,a=arguments;return new Promise(function(o,r){var i=t.apply(e,a);function l(e){n(i,o,r,l,s,"next",e)}function s(e){n(i,o,r,l,s,"throw",e)}l(void 0)})}}},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}},"../node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function e(t,a,o){return a&&n(t.prototype,a),o&&n(t,o),t}},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n},"../node_modules/@babel/runtime/helpers/inherits.js":function(e,t,n){var a=n(/*! ./setPrototypeOf */ "../node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function e(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&a(t,n)}},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function e(){throw TypeError("Invalid attempt to spread non-iterable instance")}},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,n){var a=n(/*! ../helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n(/*! ./assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function e(t,n){return n&&("object"===a(n)||"function"==typeof n)?n:o(t)}},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t},n(t,a)}e.exports=n},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,n){var a=n(/*! ./arrayWithoutHoles */ "../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),o=n(/*! ./iterableToArray */ "../node_modules/@babel/runtime/helpers/iterableToArray.js"),r=n(/*! ./nonIterableSpread */ "../node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function e(t){return a(t)||o(t)||r()}},"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function a(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=a=function e(t){return n(t)}:e.exports=a=function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},a(t)}e.exports=a},"../node_modules/@babel/runtime/regenerator/index.js":function(e,t,n){e.exports=n(/*! regenerator-runtime */ "../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/ms/index.js":function(e,t){var n=36e5,a=24*n,o=7*a,r=365.25*a;function i(e,t,n,a){return Math.round(e/n)+" "+a+(t>=1.5*n?"s":"")}e.exports=function(e,t){t=t||{};var l,s,u,d,c=typeof e;if("string"===c&&e.length>0)return function e(t){if(!((t=String(t)).length>100)){var i=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var l=parseFloat(i[1]),s=(i[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return l*r;case"weeks":case"week":case"w":return l*o;case"days":case"day":case"d":return l*a;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*l;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}(e);if("number"===c&&!1===isNaN(e)){return t.long?(l=e,s=Math.abs(l),s>=a?i(l,s,a,"day"):s>=n?i(l,s,n,"hour"):s>=6e4?i(l,s,6e4,"minute"):s>=1e3?i(l,s,1e3,"second"):l+" ms"):(u=e,d=Math.abs(u),d>=a?Math.round(u/a)+"d":d>=n?Math.round(u/n)+"h":d>=6e4?Math.round(u/6e4)+"m":d>=1e3?Math.round(u/1e3)+"s":u+"ms")}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../node_modules/process/browser.js":function(e,t){var n,a,o,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(a){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{a="function"==typeof clearTimeout?clearTimeout:l}catch(t){a=l}}();var u=[],d=!1,c=-1;function f(){d&&o&&(d=!1,o.length?u=o.concat(u):c=-1,u.length&&h())}function h(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(o=u,u=[];++c<t;)o&&o[c].run();c=-1,t=u.length}o=null,d=!1,function e(t){if(a===clearTimeout)return clearTimeout(t);if((a===l||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(t);try{return a(t)}catch(n){try{return a.call(null,t)}catch(o){return a.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||s(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(e,t,n){var a=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,r=o&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=n(/*! ./runtime */ "../node_modules/regenerator-runtime/runtime.js"),o)a.regeneratorRuntime=r;else try{delete a.regeneratorRuntime}catch(i){a.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(e,t){!function(t){var n,a=Object.prototype,o=a.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",l=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag",u="object"==typeof e,d=t.regeneratorRuntime;if(d){u&&(e.exports=d);return}function c(e,t,n,a){var o,r,i,l,s=Object.create((t&&t.prototype instanceof $?t:$).prototype),u=new I(a||[]);return s._invoke=(o=e,r=n,i=u,l=h,function e(t,n){if(l===m)throw Error("Generator is already running");if(l===g){if("throw"===t)throw n;return M()}for(i.method=t,i.arg=n;;){var a=i.delegate;if(a){var s=E(a,i);if(s){if(s===v)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(l===h)throw l=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);l=m;var u=f(o,r,i);if("normal"===u.type){if(l=i.done?g:"suspendedYield",u.arg===v)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(l=g,i.method="throw",i.arg=u.arg)}}),s}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(a){return{type:"throw",arg:a}}}(d=t.regeneratorRuntime=u?e.exports:{}).wrap=c;var h="suspendedStart",m="executing",g="completed",v={};function $(){}function p(){}function _(){}var y={};y[i]=function(){return this};var x=Object.getPrototypeOf,T=x&&x(x(P([])));T&&T!==a&&o.call(T,i)&&(y=T);var b=_.prototype=$.prototype=Object.create(y);function w(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function C(e){var t;this._invoke=function n(a,r){function i(){return new Promise(function(t,n){!function t(n,a,r,i){var l=f(e[n],e,a);if("throw"===l.type)i(l.arg);else{var s=l.arg,u=s.value;return u&&"object"==typeof u&&o.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):Promise.resolve(u).then(function(e){s.value=e,r(s)},function(e){return t("throw",e,r,i)})}}(a,r,t,n)})}return t=t?t.then(i,i):i()}}function E(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,E(e,t),"throw"===t.method))return v;t.method="throw",t.arg=TypeError("The iterator does not provide a 'throw' method")}return v}var o=f(a,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,v;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):r:(t.method="throw",t.arg=TypeError("iterator result is not an object"),t.delegate=null,v)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(o.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return r.next=r}}return{next:M}}function M(){return{value:n,done:!0}}p.prototype=b.constructor=_,_.constructor=p,_[s]=p.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(b),e},d.awrap=function(e){return{__await:e}},w(C.prototype),C.prototype[l]=function(){return this},d.AsyncIterator=C,d.async=function(e,t,n,a){var o=new C(c(e,t,n,a));return d.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},w(b),b[s]="Generator",b[i]=function(){return this},b.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},d.values=P,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,o){return l.type="throw",l.arg=e,t.next=a,o&&(t.method="next",t.arg=n),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],l=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else if(u){if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else throw Error("try statement without catch or finally")}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return(i.type=e,i.arg=t,r)?(this.method="next",this.next=r.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:P(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),v}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(e,t,n){n.r(t),t.default=function(e,t){e.save(),t(e),e.restore()}},"./drawing/drawArrow.js":function(e,t,n){n.r(t);var a=n(/*! ./drawLine.js */ "./drawing/drawLine.js"),o=n(/*! ./drawJoinedLines.js */ "./drawing/drawJoinedLines.js");t.default=function(e,t,n,r,i){var l=Math.atan2(n.y-t.y,n.x-t.x),s={color:r,lineWidth:i};Object(a.default)(e,void 0,t,n,s,"canvas"),s={color:r,lineWidth:i,fillStyle:r};var u=[{x:n.x-10*Math.cos(l-Math.PI/7),y:n.y-10*Math.sin(l-Math.PI/7)},{x:n.x-10*Math.cos(l+Math.PI/7),y:n.y-10*Math.sin(l+Math.PI/7)},n];Object(o.default)(e,void 0,n,u,s,"canvas")}},"./drawing/drawCircle.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js");t.default=function(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n)),Object(o.default)(e,i,function(e){e.arc(n.x,n.y,r,0,2*Math.PI)})}},"./drawing/drawEllipse.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js"),r=n(/*! ../util/pointProjector.js */ "./util/pointProjector.js");t.default=function(e,t,n,i,l){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),i=a.default.cornerstone.pixelToCanvas(t,i));var d=a.default.cornerstone.getViewport(t),c=t.clientWidth,f=t.clientHeight,h=d.scale,m=d.translation,g=d.rotation-u,v={x:c/2+m.x*h,y:f/2+m.y*h};Math.abs(g)>.05&&(n=Object(r.rotatePoint)(n,v,-g),i=Object(r.rotatePoint)(i,v,-g));var $,p=Math.abs(n.x-i.x),_=Math.abs(n.y-i.y),y={x:Math.min(n.x,i.x)+p/2,y:Math.min(n.y,i.y)+_/2};Math.abs(g)>.05&&(y=Object(r.rotatePoint)(y,v,g));var x=g*Math.PI/180;Object(o.default)(e,l,function(e){e.ellipse(y.x,y.y,p/2,_/2,x,0,2*Math.PI),e.closePath()})}},"./drawing/drawHandles.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),r=n(/*! ./../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),i=n(/*! ./path.js */ "./drawing/path.js"),l=n(/*! ./../store/index.js */ "./store/index.js");t.default=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t.element,d=r.default.getToolColor();e.strokeStyle=s.color||d;for(var c=Object.keys(n),f=0;f<c.length;f++)if("continue"===function t(r){var d=n[c[r]];if(!0===d.drawnIndependently||!0===s.drawHandlesIfActive&&!d.active)return"continue";var f=d.active?o.default.getActiveWidth():o.default.getToolWidth(),h=s.fill;Object(i.default)(e,{lineWidth:f,fillStyle:h},function(e){var t=a.default.cornerstone.pixelToCanvas(u,d),n=d.radius||s.handleRadius||l.state.handleRadius;e.arc(t.x,t.y,n,0,2*Math.PI)})}(f))continue}},"./drawing/drawJoinedLines.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js");t.default=function(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(o.default)(e,i,function(e){"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n),r=r.map(function(e){return a.default.cornerstone.pixelToCanvas(t,e)})),e.moveTo(n.x,n.y),r.forEach(function(t){var n=t.x,a=t.y;e.lineTo(n,a)})})}},"./drawing/drawLine.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return r});var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js");function r(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(o.default)(e,i,function(e){"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n),r=a.default.cornerstone.pixelToCanvas(t,r)),e.moveTo(n.x,n.y),e.lineTo(r.x,r.y)})}},"./drawing/drawLines.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js");t.default=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";Object(o.default)(e,r,function(e){n.forEach(function(n){var o=n.start,r=n.end;if("pixel"===i){var l=a.default.cornerstone;o=l.pixelToCanvas(t,o),r=l.pixelToCanvas(t,r)}e.moveTo(o.x,o.y),e.lineTo(r.x,r.y)})})}},"./drawing/drawLink.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ./drawLine.js */ "./drawing/drawLine.js");t.default=function(e,t,n,r,i,l){var s=e.length>0?a.default.cornerstoneMath.point.findClosestPoint(e,t):t,u=[{x:n.left+n.width/2,y:n.top},{x:n.left,y:n.top+n.height/2},{x:n.left+n.width/2,y:n.top+n.height},{x:n.left+n.width,y:n.top+n.height/2}],d=a.default.cornerstoneMath.point.findClosestPoint(u,s);Object(o.default)(r,void 0,s,d,{color:i,lineWidth:l,lineDash:[2,3]},"canvas")}},"./drawing/drawLinkedTextBox.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ./drawTextBox.js */ "./drawing/drawTextBox.js"),r=n(/*! ./drawLink.js */ "./drawing/drawLink.js");t.default=function(e,t,n,i,l,s,u,d,c,f){var h=a.default.cornerstone,m=h.pixelToCanvas(t,n);if(c&&(m.x+=c),n.boundingBox=Object(o.default)(e,i,m.x,m.y,u,{centering:{x:!1,y:f}}),n.hasMoved){var g=s(l).map(function(e){return h.pixelToCanvas(t,e)});Object(r.default)(g,m,n.boundingBox,e,u,d)}}},"./drawing/drawRect.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js"),r=n(/*! ../util/pointProjector.js */ "./util/pointProjector.js");t.default=function(e,t,n,i,l){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if("pixel"===s){var d=a.default.cornerstone;n=d.pixelToCanvas(t,n),i=d.pixelToCanvas(t,i)}var c=a.default.cornerstone.getViewport(t),f=t.clientWidth,h=t.clientHeight,m=c.scale,g=c.translation,v=c.rotation-u,$={x:f/2+g.x*m,y:h/2+g.y*m};Math.abs(v)>.05&&(n=Object(r.rotatePoint)(n,$,-v),i=Object(r.rotatePoint)(i,$,-v));var p=Math.abs(n.x-i.x),_=Math.abs(n.y-i.y);i={x:(n={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)}).x+p,y:n.y+_};var y={x:n.x+p,y:n.y},x={x:n.x,y:n.y+_};Math.abs(v)>.05&&(n=Object(r.rotatePoint)(n,$,v),i=Object(r.rotatePoint)(i,$,v),y=Object(r.rotatePoint)(y,$,v),x=Object(r.rotatePoint)(x,$,v)),Object(o.default)(e,l,function(e){e.moveTo(n.x,n.y),e.lineTo(y.x,y.y),e.moveTo(y.x,y.y),e.lineTo(i.x,i.y),e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.moveTo(x.x,x.y),e.lineTo(n.x,n.y)})}},"./drawing/drawTextBox.js":function(e,t,n){n.r(t),n.d(t,"textBoxWidth",function(){return l});var a=n(/*! ../stateManagement/textStyle.js */ "./stateManagement/textStyle.js"),o=n(/*! ./draw.js */ "./drawing/draw.js"),r=n(/*! ./fillTextLines.js */ "./drawing/fillTextLines.js"),i=n(/*! ./fillBox.js */ "./drawing/fillBox.js");function l(e,t,n){var o=a.default.getFont(),r=e.font;o&&o!==r&&(e.font=o);var i=e.measureText(t).width;return o&&o!==r&&(e.font=r),i+2*n}t.default=function(e,t,n,s,u,d){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var c=a.default.getFontSize(),f=a.default.getBackgroundColor(),h=0;t.forEach(function(t){h=Math.max(h,l(e,t,5))});var m={width:h,height:5+t.length*(c+5)};return Object(o.default)(e,function(e){e.strokeStyle=u,d&&d.centering&&!0===d.centering.x&&(n-=m.width/2),d&&d.centering&&!0===d.centering.y&&(s-=m.height/2),m.left=n,m.top=s;var a=d&&!0===d.debug?"#FF0000":f;Object(i.default)(e,m,a),Object(r.default)(e,m,t,u,5)}),m}},"./drawing/fillBox.js":function(e,t,n){n.r(t),t.default=function(e,t,n){e.fillStyle=n,e.fillRect(t.left,t.top,t.width,t.height)}},"./drawing/fillOutsideRect.js":function(e,t,n){n.r(t);var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=n(/*! ./path.js */ "./drawing/path.js");t.default=function(e,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===l){var s=a.default.cornerstone;n=s.pixelToCanvas(t,n),r=s.pixelToCanvas(t,r)}var u=Math.min(n.x,r.x),d=Math.min(n.y,r.y),c=Math.abs(n.x-r.x),f=Math.abs(n.y-r.y);Object(o.default)(e,i,function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(u+c,d,-c,f)})}},"./drawing/fillTextLines.js":function(e,t,n){n.r(t);var a=n(/*! ./../stateManagement/textStyle.js */ "./stateManagement/textStyle.js");t.default=function(e,t,n,o,r){var i=a.default.getFontSize();e.font=a.default.getFont(),e.textBaseline="top",e.fillStyle=o,n.forEach(function(n,a){e.fillText(n,t.left+r,t.top+r+a*(i+r))})}},"./drawing/getNewContext.js":function(e,t,n){n.r(t),t.default=function(e){var t=e.getContext("2d");return t.setTransform(1,0,0,1,0,0),t}},"./drawing/index.js":function(e,t,n){n.r(t);var a=n(/*! ./draw.js */ "./drawing/draw.js");n.d(t,"draw",function(){return a.default});var o=n(/*! ./drawArrow.js */ "./drawing/drawArrow.js");n.d(t,"drawArrow",function(){return o.default});var r=n(/*! ./drawCircle.js */ "./drawing/drawCircle.js");n.d(t,"drawCircle",function(){return r.default});var i=n(/*! ./drawEllipse.js */ "./drawing/drawEllipse.js");n.d(t,"drawEllipse",function(){return i.default});var l=n(/*! ./drawHandles.js */ "./drawing/drawHandles.js");n.d(t,"drawHandles",function(){return l.default});var s=n(/*! ./drawJoinedLines.js */ "./drawing/drawJoinedLines.js");n.d(t,"drawJoinedLines",function(){return s.default});var u=n(/*! ./drawLine.js */ "./drawing/drawLine.js");n.d(t,"drawLine",function(){return u.default});var d=n(/*! ./drawLines.js */ "./drawing/drawLines.js");n.d(t,"drawLines",function(){return d.default});var c=n(/*! ./drawLink.js */ "./drawing/drawLink.js");n.d(t,"drawLink",function(){return c.default});var f=n(/*! ./drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js");n.d(t,"drawLinkedTextBox",function(){return f.default});var h=n(/*! ./drawRect.js */ "./drawing/drawRect.js");n.d(t,"drawRect",function(){return h.default});var m=n(/*! ./drawTextBox.js */ "./drawing/drawTextBox.js");n.d(t,"drawTextBox",function(){return m.default});var g=n(/*! ./fillBox.js */ "./drawing/fillBox.js");n.d(t,"fillBox",function(){return g.default});var v=n(/*! ./fillOutsideRect.js */ "./drawing/fillOutsideRect.js");n.d(t,"fillOutsideRect",function(){return v.default});var $=n(/*! ./fillTextLines.js */ "./drawing/fillTextLines.js");n.d(t,"fillTextLines",function(){return $.default});var p=n(/*! ./getNewContext.js */ "./drawing/getNewContext.js");n.d(t,"getNewContext",function(){return p.default});var _=n(/*! ./path.js */ "./drawing/path.js");n.d(t,"path",function(){return _.default});var y=n(/*! ./setShadow.js */ "./drawing/setShadow.js");n.d(t,"setShadow",function(){return y.default});var x=n(/*! ./transformCanvasContext.js */ "./drawing/transformCanvasContext.js");n.d(t,"transformCanvasContext",function(){return x.default});var T=n(/*! ./resetCanvasContextTransform.js */ "./drawing/resetCanvasContextTransform.js");n.d(t,"resetCanvasContextTransform",function(){return T.default})},"./drawing/path.js":function(e,t,n){n.r(t);var a=n(/*! ./../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=t.color,r=t.lineWidth,i=t.fillStyle,l=t.lineDash;e.beginPath(),e.strokeStyle=o||e.strokeStyle,e.lineWidth=r||void 0===r&&a.default.getToolWidth()||e.lineWidth,l&&e.setLineDash(l),n(e),i&&(e.fillStyle=i,e.fill()),e.stroke(),l&&e.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(e,t,n){n.r(t),t.default=function(e){e.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(e,t,n){n.r(t);var a=n(/*! ./../util/getDefault.js */ "./util/getDefault.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.shadow&&(e.shadowColor=Object(a.default)(t.shadowColor,"#000000"),e.shadowBlur=Object(a.default)(t.shadowBlur,0),e.shadowOffsetX=Object(a.default)(t.shadowOffsetX,1),e.shadowOffsetY=Object(a.default)(t.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(e,t,n){n.r(t),t.default=function(e,t,n){if(n.vflip||n.vflip||n.rotation){var a={x:t.width/2+n.translation.x*n.scale,y:t.height/2+n.translation.y*n.scale};e.translate(a.x,a.y),n.rotation&&e.rotate(n.rotation*Math.PI/180),n.vflip&&e.scale(1,-1),n.hflip&&e.scale(-1,1),e.translate(-a.x,-a.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(e,t,n){n.r(t);var a=n(/*! ./../store/index.js */ "./store/index.js"),o=n(/*! ./../tools/base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js"),r=n(/*! ../eventListeners/onImageRenderedBrushEventHandler.js */ "./eventListeners/onImageRenderedBrushEventHandler.js"),i=n(/*! ./../externalModules.js */ "./externalModules.js"),l=function e(t){var n=t.detail.element,i=a.state.tools.filter(function(e){return e.element===n&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)});i.filter(function(e){return e instanceof o.default}).length>0&&Object(r.default)(t),i.forEach(function(e){e.renderToolData&&e.renderToolData(t)})},s=function e(t){t.addEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,l)},u=function e(t){t.removeEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,l)};t.default={enable:s,disable:u}},"./eventDispatchers/index.js":function(e,t,n){n.r(t);var a=n(/*! ./imageRenderedEventDispatcher.js */ "./eventDispatchers/imageRenderedEventDispatcher.js");n.d(t,"imageRenderedEventDispatcher",function(){return a.default});var o=n(/*! ./mouseToolEventDispatcher.js */ "./eventDispatchers/mouseToolEventDispatcher.js");n.d(t,"mouseToolEventDispatcher",function(){return o.default});var r=n(/*! ./newImageEventDispatcher.js */ "./eventDispatchers/newImageEventDispatcher.js");n.d(t,"newImageEventDispatcher",function(){return r.default});var i=n(/*! ./touchToolEventDispatcher.js */ "./eventDispatchers/touchToolEventDispatcher.js");n.d(t,"touchToolEventDispatcher",function(){return i.default})},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(e,t,n){n.r(t);var a=n(/*! ../../events.js */ "./events.js"),o=n(/*! ../../externalModules.js */ "./externalModules.js"),r=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),i=n(/*! ../../manipulators/index.js */ "./manipulators/index.js"),l=n(/*! ../../util/logger.js */ "./util/logger.js"),s=n(/*! ../../util/triggerEvent.js */ "./util/triggerEvent.js"),u=Object(l.getLogger)("eventDispatchers:mouseEventHandlers");t.default=function(e,t){u.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,l=n.element,d=t.createNewMeasurement(n);if(d){Object(r.addToolState)(l,t.name,d),o.default.cornerstone.updateImage(l);var c=Object.assign({doneMovingCallback:function e(){var n=a.default.MEASUREMENT_COMPLETED,o={toolName:t.name,element:l,measurementData:d};Object(s.default)(l,n,o)}},t.options);(1===Object.keys(d.handles).length?i.moveHandle:i.moveNewHandle)(n,t.name,d,d.handles.end,c,"mouse")}}},"./eventDispatchers/mouseEventHandlers/index.js":function(e,t,n){n.r(t),n.d(t,"mouseClick",function(){return s}),n.d(t,"mouseDoubleClick",function(){return u}),n.d(t,"mouseUp",function(){return d}),n.d(t,"mouseWheel",function(){return c});var a=n(/*! ./../shared/customCallbackHandler.js */ "./eventDispatchers/shared/customCallbackHandler.js"),o=n(/*! ./mouseDown.js */ "./eventDispatchers/mouseEventHandlers/mouseDown.js");n.d(t,"mouseDown",function(){return o.default});var r=n(/*! ./mouseDownActivate.js */ "./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");n.d(t,"mouseDownActivate",function(){return r.default});var i=n(/*! ./mouseDrag.js */ "./eventDispatchers/mouseEventHandlers/mouseDrag.js");n.d(t,"mouseDrag",function(){return i.default});var l=n(/*! ./mouseMove.js */ "./eventDispatchers/mouseEventHandlers/mouseMove.js");n.d(t,"mouseMove",function(){return l.default});var s=a.default.bind(null,"Mouse","mouseClickCallback"),u=a.default.bind(null,"Mouse","doubleClickCallback"),d=a.default.bind(null,"Mouse","mouseUpCallback"),c=a.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(e,t,n){n.r(t);var a=n(/*! ./../../store/index.js */ "./store/index.js"),o=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ../../store/getToolsWithMoveableHandles.js */ "./store/getToolsWithMoveableHandles.js"),i=n(/*! ../../util/findAndMoveHelpers.js */ "./util/findAndMoveHelpers.js"),l=n(/*! ./../../store/getInteractiveToolsForElement.js */ "./store/getInteractiveToolsForElement.js"),s=n(/*! ./../../store/getToolsWithDataForElement.js */ "./store/getToolsWithDataForElement.js"),u=n(/*! ./../../store/filterToolsUsableWithMultiPartTools.js */ "./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=e.detail.element,d=e.detail.currentPoints.canvas,c=Object(l.default)(n,a.getters.mouseTools()),f=c.filter(function(e){return"active"===e.mode&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var h=f.find(function(e){return"function"==typeof e.preMouseDownCallback});if(h&&h.preMouseDownCallback(e))return}if(!a.state.isMultiPartToolActive){var m=Object(s.default)(n,c),g=Object(r.default)(n,m,d,"mouse");if(g.length>0){var v=g[0],$=Object(o.getToolState)(n,v.name),p=Object(i.findHandleDataNearImagePoint)(n,$,v.name,d),_=p.handle,y=p.data;v.handleSelectedCallback(e,y,_,"mouse");return}var x=c.filter(function(e){var t=Object(o.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,d,"mouse")})});if(x.length>0){var T=x[0],b=Object(o.getToolState)(n,T.name).data.find(function(e){return T.pointNearTool(n,e,d)});T.toolSelectedCallback(e,b,"mouse");return}if(f.length>0){var w=f.find(function(e){return"function"==typeof e.postMouseDownCallback});if(w&&w.postMouseDownCallback(e))return}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(e,t,n){n.r(t);var a=n(/*! ./addNewMeasurement.js */ "./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),o=n(/*! ./../../store/index.js */ "./store/index.js"),r=n(/*! ./../../tools/base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),i=n(/*! ../../util/getActiveTool */ "./util/getActiveTool.js");t.default=function(e){if(!o.state.isToolLocked){var t=e.detail,n=t.element,l=t.buttons,s=Object(i.default)(n,l,"mouse");if(!(!s||"function"==typeof s.preMouseDownActivateCallback&&s.preMouseDownActivateCallback(e)))!o.state.isMultiPartToolActive&&(s.addNewMeasurement?s.addNewMeasurement(e,"mouse"):s instanceof r.default&&Object(a.default)(e,s))}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(e,t,n){n.r(t);var a=n(/*! ./../../store/index.js */ "./store/index.js"),o=n(/*! ./../../store/getActiveToolsForElement.js */ "./store/getActiveToolsForElement.js"),r=n(/*! ./../../store/filterToolsUsableWithMultiPartTools.js */ "./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t,n=e.detail,i=n.element;t=(t=(t=Object(o.default)(i,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(n.buttons)&&e.options.isMouseActive})).filter(function(e){return"function"==typeof e.mouseDragCallback}),a.state.isMultiPartToolActive&&(t=Object(r.default)(t)),0!==t.length&&t[0].mouseDragCallback(e)}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(e,t,n){n.r(t);var a=n(/*! ./../../externalModules.js */ "./externalModules.js"),o=n(/*! ./../../store/index.js */ "./store/index.js"),r=n(/*! ./../../store/getInteractiveToolsForElement.js */ "./store/getInteractiveToolsForElement.js"),i=n(/*! ./../../store/getToolsWithDataForElement.js */ "./store/getToolsWithDataForElement.js");t.default=function(e){if(!o.state.isToolLocked&&!o.state.isMultiPartToolActive){var t,n=e.detail,l=n.element,s=n.currentPoints;o.state.mousePositionImage=s.image;var u=(t=Object(r.default)(l,o.getters.mouseTools())).filter(function(e){return"active"===e.mode&&e.options.isMouseActive}),d=!1;u.length>0&&(d=u.some(function(e){return e.updateOnMouseMove})),t=Object(i.default)(l,t);for(var c=0;c<t.length;c++){var f=t[c];"function"==typeof f.mouseMoveCallback&&(d=f.mouseMoveCallback(e)||d)}!0===d&&a.default.cornerstone.updateImage(l)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(e,t,n){n.r(t);var a=n(/*! ./../events.js */ "./events.js"),o=n(/*! ./mouseEventHandlers/index.js */ "./eventDispatchers/mouseEventHandlers/index.js"),r=function e(t){t.addEventListener(a.default.MOUSE_CLICK,o.mouseClick),t.addEventListener(a.default.MOUSE_DOWN,o.mouseDown),t.addEventListener(a.default.MOUSE_DOWN_ACTIVATE,o.mouseDownActivate),t.addEventListener(a.default.MOUSE_DOUBLE_CLICK,o.mouseDoubleClick),t.addEventListener(a.default.MOUSE_DRAG,o.mouseDrag),t.addEventListener(a.default.MOUSE_MOVE,o.mouseMove),t.addEventListener(a.default.MOUSE_UP,o.mouseUp),t.addEventListener(a.default.MOUSE_WHEEL,o.mouseWheel)},i=function e(t){t.removeEventListener(a.default.MOUSE_CLICK,o.mouseClick),t.removeEventListener(a.default.MOUSE_DOWN,o.mouseDown),t.removeEventListener(a.default.MOUSE_DOWN_ACTIVATE,o.mouseDownActivate),t.removeEventListener(a.default.MOUSE_DOUBLE_CLICK,o.mouseDoubleClick),t.removeEventListener(a.default.MOUSE_DRAG,o.mouseDrag),t.removeEventListener(a.default.MOUSE_MOVE,o.mouseMove),t.removeEventListener(a.default.MOUSE_UP,o.mouseUp),t.removeEventListener(a.default.MOUSE_WHEEL,o.mouseWheel)};t.default={enable:r,disable:i}},"./eventDispatchers/newImageEventDispatcher.js":function(e,t,n){n.r(t);var a=n(/*! ./../store/index.js */ "./store/index.js"),o=n(/*! ./../tools/base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js"),r=n(/*! ../eventListeners/onNewImageBrushEventHandler.js */ "./eventListeners/onNewImageBrushEventHandler.js"),i=n(/*! ./../externalModules.js */ "./externalModules.js"),l=function e(t){if(a.state.isToolLocked)return!1;var n=t.detail.element,i=a.state.tools.filter(function(e){return e.element===n&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)});if(0===i.length)return!1;i.forEach(function(e){e.newImageCallback&&e.newImageCallback(t)}),i.filter(function(e){return e instanceof o.default}).length>0&&Object(r.default)(t)},s=function e(t){t.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,l)},u=function e(t){t.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,l)};t.default={enable:s,disable:u}},"./eventDispatchers/shared/customCallbackHandler.js":function(e,t,n){n.r(t);var a=n(/*! ./../../store/index.js */ "./store/index.js"),o=n(/*! ./../../store/getActiveToolsForElement.js */ "./store/getActiveToolsForElement.js"),r=n(/*! ./../../store/filterToolsUsableWithMultiPartTools.js */ "./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e,t,n){if(a.state.isToolLocked)return!1;var i=n.detail.element,l=a.state.tools.filter(function(t){return t.supportedInteractionTypes.includes(e)});if(l=(l=Object(o.default)(i,l,e)).filter(function(e){return"function"==typeof e[t]}),a.state.isMultiPartToolActive&&(l=Object(r.default)(l)),0===l.length)return!1;l[0][t](n)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(e,t,n){n.r(t);var a=n(/*! ../../events.js */ "./events.js"),o=n(/*! ../../externalModules.js */ "./externalModules.js"),r=n(/*! ../../store/index.js */ "./store/index.js"),i=n(/*! ./../../manipulators/anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),l=n(/*! ../../manipulators/index.js */ "./manipulators/index.js"),s=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),u=n(/*! ../../util/triggerEvent.js */ "./util/triggerEvent.js"),d=Object(n(/*! ../../util/logger.js */ "./util/logger.js").getLogger)("eventDispatchers:touchEventHandlers");t.default=function(e,t){d.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,c=n.element,f=t.createNewMeasurement(n);if(f){if(Object(s.addToolState)(c,t.name,f),1===Object.keys(f.handles).length&&n.type===a.default.TAP){f.active=!1,f.handles.end.active=!1,f.handles.end.highlight=!1,f.invalidated=!0,(r.state.deleteIfHandleOutsideImage||t.options.deleteIfHandleOutsideImage)&&Object(i.default)(n,f.handles)&&Object(s.removeToolState)(c,t.name,f),o.default.cornerstone.updateImage(c);return}o.default.cornerstone.updateImage(c);var h=Object.assign({doneMovingCallback:function e(){var n=a.default.MEASUREMENT_COMPLETED,o={toolName:t.name,element:c,measurementData:f};Object(u.default)(c,n,o)}},t.options);Object(l.moveNewHandle)(n,t.name,f,f.handles.end,h,"touch")}}},"./eventDispatchers/touchEventHandlers/index.js":function(e,t,n){n.r(t),n.d(t,"doubleTap",function(){return s}),n.d(t,"touchDrag",function(){return u}),n.d(t,"touchEnd",function(){return d}),n.d(t,"touchPinch",function(){return c}),n.d(t,"touchPress",function(){return f}),n.d(t,"touchRotate",function(){return h});var a=n(/*! ./../shared/customCallbackHandler.js */ "./eventDispatchers/shared/customCallbackHandler.js"),o=n(/*! ./multiTouchDrag.js */ "./eventDispatchers/touchEventHandlers/multiTouchDrag.js");n.d(t,"multiTouchDrag",function(){return o.default});var r=n(/*! ./tap.js */ "./eventDispatchers/touchEventHandlers/tap.js");n.d(t,"tap",function(){return r.default});var i=n(/*! ./touchStart.js */ "./eventDispatchers/touchEventHandlers/touchStart.js");n.d(t,"touchStart",function(){return i.default});var l=n(/*! ./touchStartActive.js */ "./eventDispatchers/touchEventHandlers/touchStartActive.js");n.d(t,"touchStartActive",function(){return l.default});var s=a.default.bind(null,"DoubleTap","doubleTapCallback"),u=a.default.bind(null,"Touch","touchDragCallback"),d=a.default.bind(null,"Touch","touchEndCallback"),c=a.default.bind(null,"TouchPinch","touchPinchCallback"),f=a.default.bind(null,"Touch","touchPressCallback"),h=a.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(e,t,n){n.r(t);var a=n(/*! ../../store/index.js */ "./store/index.js"),o=n(/*! ../../store/getActiveToolsForElement.js */ "./store/getActiveToolsForElement.js"),r=n(/*! ./../../store/filterToolsUsableWithMultiPartTools.js */ "./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(a.state.isToolLocked)return!1;var t=e.detail,n=t.element,i=t.numPointers,l=a.state.tools.filter(function(e){return e.supportedInteractionTypes.includes("MultiTouch")});if(l=(l=Object(o.default)(n,l,"MultiTouch")).filter(function(e){return"function"==typeof e.multiTouchDragCallback&&i===e.configuration.touchPointers}),a.state.isMultiPartToolActive&&(l=Object(r.default)(l)),0===l.length)return!1;l[0].multiTouchDragCallback(e)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(e,t,n){function a(e){Object.keys(e).forEach(function(t){e[t].active=!1})}n.r(t),t.default=function(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&a(n.handles)}}},"./eventDispatchers/touchEventHandlers/tap.js":function(e,t,n){n.r(t);var a=n(/*! ../../externalModules.js */ "./externalModules.js"),o=n(/*! ./touchStartActive.js */ "./eventDispatchers/touchEventHandlers/touchStartActive.js"),r=n(/*! ../../store/index.js */ "./store/index.js"),i=n(/*! ../../store/getActiveToolsForElement.js */ "./store/getActiveToolsForElement.js"),l=n(/*! ../../store/getToolsWithDataForElement.js */ "./store/getToolsWithDataForElement.js"),s=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),u=n(/*! ../../manipulators/getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js"),d=n(/*! ../../manipulators/index.js */ "./manipulators/index.js"),c=n(/*! ./shared/deactivateAllToolInstances.js */ "./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");t.default=function(e){if(!r.state.isToolLocked&&!r.state.isMultiPartToolActive){var t,n=e.detail.element,f=e.detail.currentPoints.canvas;t=Object(i.default)(n,r.getters.touchTools());var h=(t=Object(l.default)(n,t)).filter(function(e){for(var t=Object(s.getToolState)(n,e.name),a=0;a<t.data.length;a++)if(void 0!==Object(u.default)(n,t.data[a].handles,f,28))return!0;return!1});if(h.length>0){var m=h[0],g=Object(s.getToolState)(n,m.name),v=g.data.find(function(e){return void 0!==Object(u.default)(n,e.handles,f,28)});g.data.active=!0,v.active=!0,a.default.cornerstone.updateImage(n);var $=Object.assign({},{doneMovingCallback:function e(){Object(c.default)(g)}},m.options);Object(d.moveHandle)(e.detail,m.name,g.data,v,$,"touch"),e.stopImmediatePropagation(),e.preventDefault();return}var p=t.filter(function(e){var t=Object(s.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,f)})});if(p.length>0){var _=p[0],y=Object(s.getToolState)(n,_.name),x=y.data.find(function(e){return _.pointNearTool(n,e,f)});x.active=!0,a.default.cornerstone.updateImage(n);var T=Object.assign({},{doneMovingCallback:function e(){Object(c.default)(y)}},_.options);Object(d.moveAllHandles)(e.detail,_.name,x,null,T,"touch"),e.stopImmediatePropagation(),e.preventDefault();return}var b=Object(i.default)(n,r.getters.touchTools());return b.length>0&&b[0].touchStartActiveCallback?b[0].touchStartActiveCallback(e):Object(o.default)(e),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(e,t,n){n.r(t);var a=n(/*! ../../store/index.js */ "./store/index.js"),o=n(/*! ../../util/findAndMoveHelpers.js */ "./util/findAndMoveHelpers.js"),r=n(/*! ../../store/getToolsWithMoveableHandles.js */ "./store/getToolsWithMoveableHandles.js"),i=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),l=n(/*! ./../../store/getInteractiveToolsForElement.js */ "./store/getInteractiveToolsForElement.js"),s=n(/*! ./../../store/getToolsWithDataForElement.js */ "./store/getToolsWithDataForElement.js"),u=n(/*! ./../../store/filterToolsUsableWithMultiPartTools.js */ "./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=t.element,d=t.startPoints.canvas,c=Object(l.default)(n,a.getters.touchTools()),f=c.filter(function(e){return"active"===e.mode&&e.options.isTouchActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var h=f.find(function(e){return"function"==typeof e.preTouchStartCallback});if(h&&h.preTouchStartCallback(e))return}if(!a.state.isMultiPartToolActive){var m=Object(s.default)(n,c),g=Object(r.default)(n,m,d,"touch");if(g.length>0){var v=g[0],$=Object(i.getToolState)(n,v.name),p=Object(o.findHandleDataNearImagePoint)(n,$,v.name,d,"touch"),_=p.handle,y=p.data;v.handleSelectedCallback(e,y,_,"touch");return}var x=m.filter(function(e){var t=Object(i.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,d,"touch")})});if(x.length>0){var T=x[0],b=Object(i.getToolState)(n,T.name).data.find(function(e){return T.pointNearTool(n,e,d)});T.toolSelectedCallback(e,b,"touch");return}if(f.length>0){var w=f.find(function(e){return"function"==typeof e.postTouchStartCallback});if(w&&w.postTouchStartCallback(e))return}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(e,t,n){n.r(t);var a=n(/*! ./../../store/index.js */ "./store/index.js"),o=n(/*! ./addNewMeasurement.js */ "./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),r=n(/*! ./../../tools/base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),i=n(/*! ../../util/getActiveTool */ "./util/getActiveTool.js");t.default=function(e){if(!a.state.isToolLocked&&!a.state.isMultiPartToolActive){var t=e.detail.element,n=Object(i.default)(t,null,"touch");n&&n.addNewMeasurement?n.addNewMeasurement(e,"touch"):n instanceof r.default&&Object(o.default)(e,n)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ./touchEventHandlers/index.js */ "./eventDispatchers/touchEventHandlers/index.js"),r=function e(t){t.addEventListener(a.default.TAP,o.tap),t.addEventListener(a.default.TOUCH_START,o.touchStart,{passive:!1}),t.addEventListener(a.default.TOUCH_DRAG,o.touchDrag,{passive:!1}),t.addEventListener(a.default.TOUCH_END,o.touchEnd),t.addEventListener(a.default.TOUCH_START_ACTIVE,o.touchStartActive),t.addEventListener(a.default.TOUCH_PRESS,o.touchPress),t.addEventListener(a.default.DOUBLE_TAP,o.doubleTap),t.addEventListener(a.default.TOUCH_PINCH,o.touchPinch),t.addEventListener(a.default.TOUCH_ROTATE,o.touchRotate),t.addEventListener(a.default.MULTI_TOUCH_DRAG,o.multiTouchDrag)},i=function e(t){t.removeEventListener(a.default.TAP,o.tap),t.removeEventListener(a.default.TOUCH_START,o.touchStart),t.removeEventListener(a.default.TOUCH_DRAG,o.touchDrag),t.removeEventListener(a.default.TOUCH_END,o.touchEnd),t.removeEventListener(a.default.TOUCH_START_ACTIVE,o.touchStartActive),t.removeEventListener(a.default.TOUCH_PRESS,o.touchPress),t.removeEventListener(a.default.DOUBLE_TAP,o.doubleTap),t.removeEventListener(a.default.TOUCH_PINCH,o.touchPinch),t.removeEventListener(a.default.TOUCH_ROTATE,o.touchRotate),t.removeEventListener(a.default.MULTI_TOUCH_DRAG,o.multiTouchDrag)};t.default={enable:r,disable:i}},"./eventListeners/index.js":function(e,t,n){n.r(t);var a=n(/*! ./mouseEventListeners.js */ "./eventListeners/mouseEventListeners.js");n.d(t,"mouseEventListeners",function(){return a.default});var o=n(/*! ./wheelEventListener.js */ "./eventListeners/wheelEventListener.js");n.d(t,"wheelEventListener",function(){return o.default});var r=n(/*! ./touchEventListeners.js */ "./eventListeners/touchEventListeners.js");n.d(t,"touchEventListeners",function(){return r.default})},"./eventListeners/internals/normalizeWheel.js":function(e,t,n){n.r(t),t.default=function(e){var t=0,n=0,a=0,o=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),a=10*t,o=10*n,"deltaY"in e&&(o=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||o)&&e.deltaMode&&(1===e.deltaMode?(a*=40,o*=40):(a*=800,o*=800)),a&&!t&&(t=a<1?-1:1),o&&!n&&(n=o<1?-1:1),{spinX:t,spinY:n,pixelX:a,pixelY:o}}},"./eventListeners/mouseEventListeners.js":function(e,t,n){n.r(t);var a,o=n(/*! ../events.js */ "./events.js"),r=n(/*! ../externalModules.js */ "./externalModules.js"),i=n(/*! ../util/copyPoints.js */ "./util/copyPoints.js"),l=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),s=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("eventListeners:mouseEventListeners"),u=!0;function d(e){if("number"==typeof e.buttons)return e.buttons;switch(e.which){case 0:break;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function c(){u=!1}function f(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){var a=o.default.MOUSE_DOUBLE_CLICK,u={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};u.canvas=r.default.cornerstone.pixelToCanvas(t,u.image);var c=Object(i.default)(u);s.log("double-click: %o",d(e));var f={event:e,buttons:d(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:u,lastPoints:c,currentPoints:u,deltaPoints:{x:0,y:0},type:a};Object(l.default)(t,a,f)}}function h(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){a=setTimeout(c,200),t.removeEventListener("mousemove",m);var f={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};f.canvas=r.default.cornerstone.pixelToCanvas(t,f.image);var h=Object(i.default)(f),g={event:e,buttons:d(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:f,lastPoints:h,currentPoints:f,deltaPoints:{x:0,y:0},type:o.default.MOUSE_DOWN};Object(l.default)(g.element,o.default.MOUSE_DOWN,g)&&(g.type=o.default.MOUSE_DOWN_ACTIVATE,Object(l.default)(g.element,o.default.MOUSE_DOWN_ACTIVATE,g)),document.addEventListener("mousemove",v),document.addEventListener("mouseup",$)}function v(e){var a=o.default.MOUSE_DRAG,u={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};u.canvas=r.default.cornerstone.pixelToCanvas(t,u.image);var c={page:r.default.cornerstoneMath.point.subtract(u.page,h.page),image:r.default.cornerstoneMath.point.subtract(u.image,h.image),client:r.default.cornerstoneMath.point.subtract(u.client,h.client),canvas:r.default.cornerstoneMath.point.subtract(u.canvas,h.canvas)};s.log("mousemove: %o",d(e));var m={buttons:d(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:f,lastPoints:h,currentPoints:u,deltaPoints:c,type:a,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(l.default)(m.element,a,m),h=Object(i.default)(u)}function $(e){clearTimeout(a);var i=o.default.MOUSE_UP;u&&(i=o.default.MOUSE_CLICK);var c={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};c.canvas=r.default.cornerstone.pixelToCanvas(t,c.image);var g={page:r.default.cornerstoneMath.point.subtract(c.page,h.page),image:r.default.cornerstoneMath.point.subtract(c.image,h.image),client:r.default.cornerstoneMath.point.subtract(c.client,h.client),canvas:r.default.cornerstoneMath.point.subtract(c.canvas,h.canvas)};s.log("mouseup: %o",d(e));var p={event:e,buttons:d(e),viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:f,lastPoints:h,currentPoints:c,deltaPoints:g,type:i};Object(l.default)(p.element,i,p),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",$),t.addEventListener("mousemove",m),u=!0}}function m(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){var a=o.default.MOUSE_MOVE,s={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=r.default.cornerstone.pixelToCanvas(t,s.image);var u=Object(i.default)(s),d={page:r.default.cornerstoneMath.point.pageToPoint(e),image:r.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=r.default.cornerstone.pixelToCanvas(t,d.image);var c={page:r.default.cornerstoneMath.point.subtract(d.page,u.page),image:r.default.cornerstoneMath.point.subtract(d.image,u.image),client:r.default.cornerstoneMath.point.subtract(d.client,u.client),canvas:r.default.cornerstoneMath.point.subtract(d.canvas,u.canvas)},f={viewport:r.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:s,lastPoints:u,currentPoints:d,deltaPoints:c,type:a};Object(l.default)(t,a,f),u=Object(i.default)(d)}}function g(e){e.removeEventListener("mousedown",h),e.removeEventListener("mousemove",m),e.removeEventListener("dblclick",f)}t.default={enable:function e(t){g(t),t.addEventListener("mousedown",h),t.addEventListener("mousemove",m),t.addEventListener("dblclick",f)},disable:g}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(e,t,n){n.r(t);var a=n(/*! ../drawing/index.js */ "./drawing/index.js"),o=n(/*! ./../tools/base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js"),r=n(/*! ../externalModules.js */ "./externalModules.js"),i=n(/*! ../store/getActiveToolsForElement.js */ "./store/getActiveToolsForElement.js"),l=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),s=n(/*! ../store/index.js */ "./store/index.js");"createImageBitmap"in window||(window.createImageBitmap=function(e){return new Promise(function(t){var n=document.createElement("img");n.addEventListener("load",function(){t(this)});var a=document.createElement("canvas");a.width=e.width,a.height=e.height,a.getContext("2d").putImageData(e,0,0,0,0,a.width,a.height),n.src=a.toDataURL()})});var u=s.default.modules.brush,d=u.state,c=u.getters,f=u.setters;function h(e,t,n){var a=e.detail.element,r=n.toolData,l=n.visibleSegmentations;return!!r.data[t]&&!!r.data[t].pixelData&&(!!l[t]||d.drawColorId===t&&Object(i.default)(a,s.default.state.tools).filter(function(e){return e instanceof o.default}).length>0)}function m(e,t,n){var o,i,l,s,u,c,h,m,g,v,$,p,_,y,x=n.toolData,T=n.imageBitmapCache,b=n.visibleSegmentations;T&&T[t]&&(o=e,i=T[t],l=b[t],s=o.detail,u=Object(a.getNewContext)(s.canvasContext.canvas),c=r.default.cornerstone.pixelToCanvas(s.element,{x:0,y:0}),h=r.default.cornerstone.pixelToCanvas(s.element,{x:s.image.width,y:0}),m=r.default.cornerstone.pixelToCanvas(s.element,{x:s.image.width,y:s.image.height}),g=r.default.cornerstoneMath.point.distance(c,h),v=r.default.cornerstoneMath.point.distance(h,m),$=s.canvasContext.canvas,p=s.viewport,u.imageSmoothingEnabled=!1,u.globalAlpha=(_=l,_?d.alpha:d.hiddenButActiveAlpha),Object(a.transformCanvasContext)(u,$,p),y={x:p.translation.x*p.scale,y:p.translation.y*p.scale},u.drawImage(i,$.width/2-g/2+y.x,$.height/2-v/2+y.y,g,v),u.globalAlpha=1,Object(a.resetCanvasContextTransform)(u));var w=e.detail,C=w.element,E=r.default.cornerstone.getEnabledElement(C);(x.data[t].invalidated||d.invalidatedEnabledElements.includes(E.uuid))&&function e(t,n,a,o){var i=t.image,l=t.element,s=a.data[o].pixelData,u=a.data[o].alpha;if(s){var c=d.colorMapId,h=[[0,0,0,0],r.default.cornerstone.colors.getColormap(c).getColor(o)],m=new ImageData(i.width,i.height);void 0!==u&&(h[1][3]=u),r.default.cornerstone.storedPixelDataToCanvasImageDataColorLUT({stats:{},minPixelValue:0,getPixelData:function e(){return s}},h,m.data),window.createImageBitmap(m).then(function(e){f.imageBitmapCacheForElement(n,o,e),a.data[o].invalidated=!1,d.invalidatedEnabledElements=d.invalidatedEnabledElements.filter(function(e){return e!==n}),r.default.cornerstone.updateImage(l)})}}(w,E.uuid,x,t)}t.default=function(e){var t=e.detail.element,n=o.default.getNumberOfColors(),a=Object(l.getToolState)(t,o.default.getReferencedToolDataName());if(a)for(var i=r.default.cornerstone.getEnabledElement(t).uuid,s={visibleSegmentations:c.visibleSegmentationsForElement(i),imageBitmapCache:c.imageBitmapCacheForElement(i),toolData:a},u=0;u<n;u++)h(e,u,s)&&m(e,u,s)}},"./eventListeners/onNewImageBrushEventHandler.js":function(e,t,n){n.r(t);var a=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),o=n(/*! ./../tools/base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js"),r=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e){var t=e.detail,n=t.element,i=Object(a.getToolState)(n,o.default.getReferencedToolDataName());i||(Object(a.addToolState)(n,o.default.getReferencedToolDataName(),{}),i=Object(a.getToolState)(n,o.default.getReferencedToolDataName()));for(var l=o.default.getNumberOfColors(),s=0;s<l;s++)i.data[s]&&(i.data[s].invalidated=!0);r.default.cornerstone.updateImage(t.element)}},"./eventListeners/preventGhostClick.js":function(e,t,n){n.r(t);var a,o,r={mouse:0,touch:1};function i(e,t){var n=Date.now();if(e!==a){if(n-o<=2e3)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;a=e}o=n}var l=i.bind(null,r.mouse),s=i.bind(null,r.touch);function u(e,t,n){var a=n?l:s;t.forEach(function(t){e.addEventListener(t,a,{passive:!1})})}function d(e,t,n){var a=n?l:s;t.forEach(function(t){e.removeEventListener(t,a)})}var c=["mousedown","mouseup"],f=["touchstart","touchend"];function h(e){d(e,c,r.mouse),d(e,f,r.touch)}t.default={enable:function e(t){h(t),u(t,c,r.mouse),u(t,f,r.touch)},disable:h}},"./eventListeners/touchEventListeners.js":function(e,t,n){n.r(t);var a,o,r,i,l,s,u,d,c,f=n(/*! ../events.js */ "./events.js"),h=n(/*! ../externalModules.js */ "./externalModules.js"),m=n(/*! ../util/copyPoints.js */ "./util/copyPoints.js"),g=n(/*! ./preventGhostClick.js */ "./eventListeners/preventGhostClick.js"),v=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),$=n(/*! ../toolOptions.js */ "./toolOptions.js"),p=1,_=0,y=!1,x=!1,T="touchInput";function b(e){var t,n,g,$,T,b=e.currentTarget||e.srcEvent.currentTarget,w=h.default.cornerstone.getEnabledElement(b);if(w.image){switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(x=!1,clearTimeout(u)),e.type){case"tap":x=!1,clearTimeout(u),(o={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(b,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,o.image),t=f.default.TAP,l={event:e,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,currentPoints:o,type:t,isTouchEvent:!0},Object(v.default)(b,t,l);break;case"doubletap":x=!1,clearTimeout(u),(o={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(b,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,o.image),t=f.default.DOUBLE_TAP,l={event:e,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,currentPoints:o,type:t,isTouchEvent:!0},Object(v.default)(b,t,l);break;case"pinchstart":x=!1,clearTimeout(u),p=1;break;case"pinchmove":if(x=!1,clearTimeout(u),!0===y){p=e.scale,y=!1;break}n=(e.scale-p)/p,(a={page:e.center,image:h.default.cornerstone.pageToPixel(b,e.center.x,e.center.y)}).canvas=h.default.cornerstone.pixelToCanvas(b,a.image),t=f.default.TOUCH_PINCH,l={event:e,startPoints:a,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,direction:e.scale<1?1:-1,scaleChange:n,type:t,isTouchEvent:!0},Object(v.default)(b,t,l),p=e.scale;break;case"touchstart":p=1,clearTimeout(u),clearTimeout(s),s=setTimeout(function(){(a={page:h.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:h.default.cornerstone.pageToPixel(b,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,a.image),t=f.default.TOUCH_START,e.touches.length>1&&(t=f.default.MULTI_TOUCH_START),l={event:e,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,startPoints:a,currentPoints:a,type:t,isTouchEvent:!0},!0===Object(v.default)(b,t,l)&&(t=f.default.TOUCH_START_ACTIVE,e.touches.length>1&&(t=f.default.MULTI_TOUCH_START_ACTIVE),l.type=t,Object(v.default)(b,t,l)),r=Object(m.default)(a)},50),x=!0,d=0,u=setTimeout(function(){x&&((o={page:h.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:h.default.cornerstone.pageToPixel(b,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,a.image),t=f.default.TOUCH_PRESS,l={event:e,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,currentPoints:o,type:t,isTouchEvent:!0},Object(v.default)(b,t,l))},700);break;case"touchend":p=1,x=!1,clearTimeout(u),setTimeout(function(){(a={page:h.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:h.default.cornerstone.pageToPixel(b,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,a.image),t=f.default.TOUCH_END,l={event:e,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,startPoints:a,currentPoints:a,type:t,isTouchEvent:!0},Object(v.default)(b,t,l)},50);break;case"panmove":g={x:e.deltaX-c.x,y:e.deltaY-c.y},c={x:e.deltaX,y:e.deltaY},(o={page:{x:r.page.x+g.x,y:r.page.y+g.y},image:h.default.cornerstone.pageToPixel(b,r.page.x+g.x,r.page.y+g.y),client:{x:r.client.x+g.x,y:r.client.y+g.y}}).canvas=h.default.cornerstone.pixelToCanvas(b,o.image),(d+=Math.sqrt((i={page:h.default.cornerstoneMath.point.subtract(o.page,r.page),image:h.default.cornerstoneMath.point.subtract(o.image,r.image),client:h.default.cornerstoneMath.point.subtract(o.client,r.client),canvas:h.default.cornerstoneMath.point.subtract(o.canvas,r.canvas)}).page.x*i.page.x+i.page.y*i.page.y))>5&&(x=!1,clearTimeout(u)),t=f.default.TOUCH_DRAG,e.pointers.length>1&&(t=f.default.MULTI_TOUCH_DRAG),l={viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,startPoints:a,lastPoints:r,currentPoints:o,deltaPoints:i,numPointers:e.pointers.length,type:t,isTouchEvent:!0},Object(v.default)(b,t,l),r=Object(m.default)(o);break;case"panstart":c={x:e.deltaX,y:e.deltaY},(o={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(b,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,o.image),r=Object(m.default)(o);break;case"panend":if(x=!1,clearTimeout(u),!r)break;(o={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(b,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(b,o.image),i={page:h.default.cornerstoneMath.point.subtract(o.page,r.page),image:h.default.cornerstoneMath.point.subtract(o.image,r.image),client:h.default.cornerstoneMath.point.subtract(o.client,r.client),canvas:h.default.cornerstoneMath.point.subtract(o.canvas,r.canvas)},t=f.default.TOUCH_DRAG_END,l={event:e.srcEvent,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,startPoints:a,lastPoints:r,currentPoints:o,deltaPoints:i,type:t,isTouchEvent:!0},Object(v.default)(b,t,l),2==($=e.pointers.length-e.changedPointers.length)&&(y=!0);break;case"rotatemove":x=!1,clearTimeout(u),T=e.rotation-_,_=e.rotation,t=f.default.TOUCH_ROTATE,l={event:e.srcEvent,viewport:h.default.cornerstone.getViewport(b),image:w.image,element:b,rotation:T,type:t},Object(v.default)(b,t,l)}return!1}}function w(e){g.default.disable(e),["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,b)});var t=Object($.getToolOptions)(T,e).hammer;t&&t.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",b)}t.default={enable:function e(t){w(t);var n=h.default.Hammer,a={inputClass:n.SUPPORT_POINTER_EVENTS?n.PointerEventInput:n.TouchInput},o=new n.Manager(t,a),r={pointers:0,direction:n.DIRECTION_ALL,threshold:0},i=new n.Pan(r),l=new n.Pinch({threshold:0}),s=new n.Rotate({threshold:0});l.recognizeWith(i),l.recognizeWith(s),s.recognizeWith(i);var u=new n.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});u.recognizeWith(i),o.add([u,i,s,l]),o.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",b),g.default.enable(t),["touchstart","touchend"].forEach(function(e){t.addEventListener(e,b,{passive:!1})});var d=Object($.getToolOptions)(T,t);d.hammer=o,Object($.setToolOptions)(T,t,d)},disable:w}},"./eventListeners/wheelEventListener.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),i=n(/*! ./internals/normalizeWheel.js */ "./eventListeners/internals/normalizeWheel.js");function l(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image&&(!(e.deltaY>-1)||!(e.deltaY<1))){e.preventDefault();var l=e.pageX,s=e.pageY,u=o.default.cornerstone.pageToPixel(t,l,s),d=Object(i.default)(e),c=d.spinX,f=d.spinY,h=d.pixelX,m=d.pixelY,g={element:t,viewport:o.default.cornerstone.getViewport(t),detail:e,image:n.image,direction:f<0?-1:1,spinX:c,spinY:f,pixelX:h,pixelY:m,pageX:l,pageY:s,imageX:u.x,imageY:u.y};Object(r.default)(t,a.default.MOUSE_WHEEL,g)}}function s(e){e.removeEventListener("wheel",l,{passive:!1})}t.default={enable:function e(t){s(t),t.addEventListener("wheel",l,{passive:!1})},disable:s}},"./eventListeners/windowResizeHandler.js":function(e,t,n){n.r(t),n.d(t,"forceEnabledElementResize",function(){return u});var a,o=n(/*! ./../store/index.js */ "./store/index.js"),r=n(/*! ./../externalModules.js */ "./externalModules.js"),i=function e(){l(),window.addEventListener("resize",s,!1)},l=function e(){window.removeEventListener("resize",s,!1)};function s(){a||(a=setTimeout(function(){a=null,u()},66))}var u=function e(){o.state.enabledElements.forEach(function(e){r.default.cornerstone.resize(e)})};t.default={enable:i,disable:l}},"./events.js":function(e,t,n){n.r(t),t.default={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_COMPLETED:"cornerstonetoolsmeasurementcompleted",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll",STACK_PREFETCH_IMAGE_LOADED:"cornerstonetoolsstackprefetchimageloaded",STACK_PREFETCH_DONE:"cornerstonetoolsstackprefetchdone"}},"./externalModules.js":function(e,t,n){n.r(t);var a=window.cornerstone,o=window.cornerstoneMath,r=window.Hammer;t.default={set cornerstone(cs){a=cs},get cornerstone(){return a},set cornerstoneMath(cm){o=cm},get cornerstoneMath(){return o},set Hammer(module){r=module},get Hammer(){return r}}},"./import.js":function(e,t,n){n.r(t);var a=n(/*! ./lib.js */ "./lib.js");t.default=function(e){return a.lib[e]}},"./index.js":function(e,t,n){n.r(t);var a=n(/*! ./tools/annotation/index.js */ "./tools/annotation/index.js");n.d(t,"AngleTool",function(){return a.AngleTool}),n.d(t,"ArrowAnnotateTool",function(){return a.ArrowAnnotateTool}),n.d(t,"BidirectionalTool",function(){return a.BidirectionalTool}),n.d(t,"CircleRoiTool",function(){return a.CircleRoiTool}),n.d(t,"CobbAngleTool",function(){return a.CobbAngleTool}),n.d(t,"EllipticalRoiTool",function(){return a.EllipticalRoiTool}),n.d(t,"FreehandMouseTool",function(){return a.FreehandMouseTool}),n.d(t,"LengthTool",function(){return a.LengthTool}),n.d(t,"ProbeTool",function(){return a.ProbeTool}),n.d(t,"RectangleRoiTool",function(){return a.RectangleRoiTool}),n.d(t,"TextMarkerTool",function(){return a.TextMarkerTool});var o=n(/*! ./tools/brush/index.js */ "./tools/brush/index.js");n.d(t,"BrushTool",function(){return o.BrushTool});var r=n(/*! ./tools/index.js */ "./tools/index.js");n.d(t,"CrosshairsTool",function(){return r.CrosshairsTool}),n.d(t,"DoubleTapFitToWindowTool",function(){return r.DoubleTapFitToWindowTool}),n.d(t,"DragProbeTool",function(){return r.DragProbeTool}),n.d(t,"EraserTool",function(){return r.EraserTool}),n.d(t,"FreehandSculpterMouseTool",function(){return r.FreehandSculpterMouseTool}),n.d(t,"MagnifyTool",function(){return r.MagnifyTool}),n.d(t,"PanMultiTouchTool",function(){return r.PanMultiTouchTool}),n.d(t,"PanTool",function(){return r.PanTool}),n.d(t,"ReferenceLinesTool",function(){return r.ReferenceLinesTool}),n.d(t,"RotateTool",function(){return r.RotateTool}),n.d(t,"RotateTouchTool",function(){return r.RotateTouchTool}),n.d(t,"ScaleOverlayTool",function(){return r.ScaleOverlayTool}),n.d(t,"StackScrollMouseWheelTool",function(){return r.StackScrollMouseWheelTool}),n.d(t,"StackScrollMultiTouchTool",function(){return r.StackScrollMultiTouchTool}),n.d(t,"StackScrollTool",function(){return r.StackScrollTool}),n.d(t,"WwwcRegionTool",function(){return r.WwwcRegionTool}),n.d(t,"WwwcTool",function(){return r.WwwcTool}),n.d(t,"ZoomMouseWheelTool",function(){return r.ZoomMouseWheelTool}),n.d(t,"ZoomTool",function(){return r.ZoomTool}),n.d(t,"ZoomTouchPinchTool",function(){return r.ZoomTouchPinchTool});var i=n(/*! ./import.js */ "./import.js"),l=n(/*! ./init.js */ "./init.js");n.d(t,"init",function(){return l.default});var s=n(/*! ./stackTools/stackPrefetch.js */ "./stackTools/stackPrefetch.js");n.d(t,"stackPrefetch",function(){return s.default});var u=n(/*! ./stackTools/stackRenderers.js */ "./stackTools/stackRenderers.js");n.d(t,"stackRenderers",function(){return u.default});var d=n(/*! ./stackTools/playClip.js */ "./stackTools/playClip.js");n.d(t,"playClip",function(){return d.playClip}),n.d(t,"stopClip",function(){return d.stopClip});var c=n(/*! ./store/index.js */ "./store/index.js");n.d(t,"store",function(){return c.default});var f=n(/*! ./store/getToolForElement.js */ "./store/getToolForElement.js");n.d(t,"getToolForElement",function(){return f.default});var h=n(/*! ./store/addTool.js */ "./store/addTool.js");n.d(t,"addTool",function(){return h.addTool}),n.d(t,"addToolForElement",function(){return h.addToolForElement});var m=n(/*! ./store/removeTool.js */ "./store/removeTool.js");n.d(t,"removeTool",function(){return m.removeTool}),n.d(t,"removeToolForElement",function(){return m.removeToolForElement});var g=n(/*! ./store/setToolOptions.js */ "./store/setToolOptions.js");n.d(t,"setToolOptions",function(){return g.setToolOptions}),n.d(t,"setToolOptionsForElement",function(){return g.setToolOptionsForElement});var v=n(/*! ./store/setToolMode.js */ "./store/setToolMode.js");n.d(t,"setToolActive",function(){return v.setToolActive}),n.d(t,"setToolActiveForElement",function(){return v.setToolActiveForElement}),n.d(t,"setToolEnabled",function(){return v.setToolEnabled}),n.d(t,"setToolEnabledForElement",function(){return v.setToolEnabledForElement}),n.d(t,"setToolDisabled",function(){return v.setToolDisabled}),n.d(t,"setToolDisabledForElement",function(){return v.setToolDisabledForElement}),n.d(t,"setToolPassive",function(){return v.setToolPassive}),n.d(t,"setToolPassiveForElement",function(){return v.setToolPassiveForElement});var $=n(/*! ./stateManagement/toolState.js */ "./stateManagement/toolState.js");n.d(t,"addToolState",function(){return $.addToolState}),n.d(t,"getToolState",function(){return $.getToolState}),n.d(t,"removeToolState",function(){return $.removeToolState}),n.d(t,"clearToolState",function(){return $.clearToolState}),n.d(t,"setElementToolStateManager",function(){return $.setElementToolStateManager}),n.d(t,"getElementToolStateManager",function(){return $.getElementToolStateManager});var p=n(/*! ./stateManagement/textStyle.js */ "./stateManagement/textStyle.js");n.d(t,"textStyle",function(){return p.default});var _=n(/*! ./stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js");n.d(t,"toolStyle",function(){return _.default});var y=n(/*! ./stateManagement/toolColors.js */ "./stateManagement/toolColors.js");n.d(t,"toolColors",function(){return y.default});var x=n(/*! ./stateManagement/toolCoordinates.js */ "./stateManagement/toolCoordinates.js");n.d(t,"toolCoordinates",function(){return x.default});var T=n(/*! ./stateManagement/stackSpecificStateManager.js */ "./stateManagement/stackSpecificStateManager.js");n.d(t,"stackSpecificStateManager",function(){return T.stackSpecificStateManager}),n.d(t,"newStackSpecificToolStateManager",function(){return T.newStackSpecificToolStateManager}),n.d(t,"addStackStateManager",function(){return T.addStackStateManager});var b=n(/*! ./stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js");n.d(t,"loadHandlerManager",function(){return b.default});var w=n(/*! ./stateManagement/imageIdSpecificStateManager.js */ "./stateManagement/imageIdSpecificStateManager.js");n.d(t,"newImageIdSpecificToolStateManager",function(){return w.newImageIdSpecificToolStateManager}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return w.globalImageIdSpecificToolStateManager});var C=n(/*! ./stateManagement/frameOfReferenceStateManager.js */ "./stateManagement/frameOfReferenceStateManager.js");n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return C.newFrameOfReferenceSpecificToolStateManager}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return C.globalFrameOfReferenceSpecificToolStateManager});var E=n(/*! ./eventListeners/windowResizeHandler.js */ "./eventListeners/windowResizeHandler.js");n.d(t,"forceEnabledElementResize",function(){return E.forceEnabledElementResize});var j=n(/*! ./orientation/index.js */ "./orientation/index.js");n.d(t,"orientation",function(){return j.default});var S=n(/*! ./util/SaveAs.js */ "./util/SaveAs.js");n.d(t,"SaveAs",function(){return S.default});var I=n(/*! ./util/logger.js */ "./util/logger.js");n.d(t,"enableLogger",function(){return I.enable}),n.d(t,"disableLogger",function(){return I.disable});var P=n(/*! ./thirdParty/register.js */ "./thirdParty/register.js");n.d(t,"register",function(){return P.default});var M=n(/*! ./thirdParty/registerSome.js */ "./thirdParty/registerSome.js");n.d(t,"registerSome",function(){return M.default});var k=n(/*! ./synchronization/wwwcSynchronizer.js */ "./synchronization/wwwcSynchronizer.js");n.d(t,"wwwcSynchronizer",function(){return k.default});var D=n(/*! ./synchronization/updateImageSynchronizer.js */ "./synchronization/updateImageSynchronizer.js");n.d(t,"updateImageSynchronizer",function(){return D.default});var L=n(/*! ./synchronization/Synchronizer.js */ "./synchronization/Synchronizer.js");n.d(t,"Synchronizer",function(){return L.default});var R=n(/*! ./synchronization/stackScrollSynchronizer.js */ "./synchronization/stackScrollSynchronizer.js");n.d(t,"stackScrollSynchronizer",function(){return R.default});var A=n(/*! ./synchronization/stackImagePositionSynchronizer.js */ "./synchronization/stackImagePositionSynchronizer.js");n.d(t,"stackImagePositionSynchronizer",function(){return A.default});var O=n(/*! ./synchronization/stackImagePositionOffsetSynchronizer.js */ "./synchronization/stackImagePositionOffsetSynchronizer.js");n.d(t,"stackImagePositionOffsetSynchronizer",function(){return O.default});var H=n(/*! ./synchronization/stackImageIndexSynchronizer.js */ "./synchronization/stackImageIndexSynchronizer.js");n.d(t,"stackImageIndexSynchronizer",function(){return H.default});var B=n(/*! ./synchronization/panZoomSynchronizer.js */ "./synchronization/panZoomSynchronizer.js");n.d(t,"panZoomSynchronizer",function(){return B.default});var U=n(/*! ./requestPool/requestPoolManager.js */ "./requestPool/requestPoolManager.js");n.d(t,"requestPoolManager",function(){return U.default});var F=n(/*! ./externalModules.js */ "./externalModules.js");n.d(t,"external",function(){return F.default});var N=n(/*! ./events.js */ "./events.js");n.d(t,"EVENTS",function(){return N.default});var z=n(/*! ./version.js */ "./version.js");n.d(t,"version",function(){return z.default}),n.d(t,"import",function(){return i.default});var V={AngleTool:a.AngleTool,ArrowAnnotateTool:a.ArrowAnnotateTool,BidirectionalTool:a.BidirectionalTool,CircleRoiTool:a.CircleRoiTool,CobbAngleTool:a.CobbAngleTool,EllipticalRoiTool:a.EllipticalRoiTool,FreehandMouseTool:a.FreehandMouseTool,LengthTool:a.LengthTool,ProbeTool:a.ProbeTool,RectangleRoiTool:a.RectangleRoiTool,TextMarkerTool:a.TextMarkerTool,BrushTool:o.BrushTool,CrosshairsTool:r.CrosshairsTool,DoubleTapFitToWindowTool:r.DoubleTapFitToWindowTool,DragProbeTool:r.DragProbeTool,EraserTool:r.EraserTool,FreehandSculpterMouseTool:r.FreehandSculpterMouseTool,MagnifyTool:r.MagnifyTool,PanMultiTouchTool:r.PanMultiTouchTool,PanTool:r.PanTool,ReferenceLinesTool:r.ReferenceLinesTool,RotateTool:r.RotateTool,RotateTouchTool:r.RotateTouchTool,ScaleOverlayTool:r.ScaleOverlayTool,StackScrollMouseWheelTool:r.StackScrollMouseWheelTool,StackScrollMultiTouchTool:r.StackScrollMultiTouchTool,StackScrollTool:r.StackScrollTool,WwwcRegionTool:r.WwwcRegionTool,WwwcTool:r.WwwcTool,ZoomMouseWheelTool:r.ZoomMouseWheelTool,ZoomTool:r.ZoomTool,ZoomTouchPinchTool:r.ZoomTouchPinchTool,init:l.default,stackPrefetch:s.default,stackRenderers:u.default,playClip:d.playClip,stopClip:d.stopClip,store:c.default,getToolForElement:f.default,addTool:h.addTool,addToolForElement:h.addToolForElement,removeTool:m.removeTool,removeToolForElement:m.removeToolForElement,setToolOptions:g.setToolOptions,setToolOptionsForElement:g.setToolOptionsForElement,setToolActive:v.setToolActive,setToolActiveForElement:v.setToolActiveForElement,setToolEnabled:v.setToolEnabled,setToolEnabledForElement:v.setToolEnabledForElement,setToolDisabled:v.setToolDisabled,setToolDisabledForElement:v.setToolDisabledForElement,setToolPassive:v.setToolPassive,setToolPassiveForElement:v.setToolPassiveForElement,addToolState:$.addToolState,getToolState:$.getToolState,removeToolState:$.removeToolState,clearToolState:$.clearToolState,setElementToolStateManager:$.setElementToolStateManager,getElementToolStateManager:$.getElementToolStateManager,textStyle:p.default,toolStyle:_.default,toolColors:y.default,toolCoordinates:x.default,stackSpecificStateManager:T.stackSpecificStateManager,newStackSpecificToolStateManager:T.newStackSpecificToolStateManager,addStackStateManager:T.addStackStateManager,loadHandlerManager:b.default,newImageIdSpecificToolStateManager:w.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:w.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:C.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:C.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:E.forceEnabledElementResize,orientation:j.default,SaveAs:S.default,enableLogger:I.enable,disableLogger:I.disable,import:i.default,register:P.default,registerSome:M.default,wwwcSynchronizer:k.default,updateImageSynchronizer:D.default,Synchronizer:L.default,stackScrollSynchronizer:R.default,stackImagePositionSynchronizer:A.default,stackImagePositionOffsetSynchronizer:O.default,stackImageIndexSynchronizer:H.default,panZoomSynchronizer:B.default,requestPoolManager:U.default,external:F.default,EVENTS:N.default,version:z.default};t.default=V},"./init.js":function(e,t,n){n.r(t);var a=n(/*! ./externalModules.js */ "./externalModules.js"),o=n(/*! ./store/index.js */ "./store/index.js"),r=n(/*! ./store/internals/addEnabledElement.js */ "./store/internals/addEnabledElement.js"),i=n(/*! ./store/internals/removeEnabledElement.js */ "./store/internals/removeEnabledElement.js"),l=n(/*! ./eventListeners/windowResizeHandler.js */ "./eventListeners/windowResizeHandler.js");t.default=function(e){var t,n,s,u,d,c,f;n=(t=a.default.cornerstone).EVENTS.ELEMENT_ENABLED,s=t.EVENTS.ELEMENT_DISABLED,t.events.removeEventListener(n,r.default),t.events.removeEventListener(s,i.default),d=(u=a.default.cornerstone).EVENTS.ELEMENT_ENABLED,c=u.EVENTS.ELEMENT_DISABLED,u.events.addEventListener(d,r.default),u.events.addEventListener(c,i.default),Object.keys(f=o.default.modules).forEach(function(e){"function"==typeof f[e].onRegisterCallback&&f[e].onRegisterCallback()}),l.default.enable(),o.default.modules.globalConfiguration.state=Object.assign({},o.default.modules.globalConfiguration.state,e)}},"./lib.js":function(e,t,n){n.r(t),n.d(t,"lib",function(){return B});var a=n(/*! ./tools/base/BaseTool.js */ "./tools/base/BaseTool.js"),o=n(/*! ./tools/base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),r=n(/*! ./tools/base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js"),i=n(/*! ./manipulators/index.js */ "./manipulators/index.js"),l=n(/*! ./util/findAndMoveHelpers.js */ "./util/findAndMoveHelpers.js"),s=n(/*! ./mixins/index.js */ "./mixins/index.js"),u=n(/*! ./tools/cursors/index.js */ "./tools/cursors/index.js"),d=n(/*! ./drawing/index.js */ "./drawing/index.js"),c=n(/*! ./drawing/drawTextBox.js */ "./drawing/drawTextBox.js"),f=n(/*! ./drawing/drawArrow.js */ "./drawing/drawArrow.js"),h=n(/*! ./drawing/drawLink.js */ "./drawing/drawLink.js"),m=n(/*! ./drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),g=n(/*! ./drawing/drawHandles.js */ "./drawing/drawHandles.js"),v=n(/*! ./util/getLuminance.js */ "./util/getLuminance.js"),$=n(/*! ./util/copyPoints.js */ "./util/copyPoints.js"),p=n(/*! ./util/calculateSUV.js */ "./util/calculateSUV.js"),_=n(/*! ./util/setContextToDisplayFontSize.js */ "./util/setContextToDisplayFontSize.js"),y=n(/*! ./util/scrollToIndex.js */ "./util/scrollToIndex.js"),x=n(/*! ./util/scroll.js */ "./util/scroll.js"),T=n(/*! ./util/roundToDecimal.js */ "./util/roundToDecimal.js"),b=n(/*! ./util/pointProjector.js */ "./util/pointProjector.js"),w=n(/*! ./util/lineSegDistance.js */ "./util/lineSegDistance.js"),C=n(/*! ./util/pointInsideBoundingBox.js */ "./util/pointInsideBoundingBox.js"),E=n(/*! ./util/makeUnselectable.js */ "./util/makeUnselectable.js"),j=n(/*! ./util/getRGBPixels.js */ "./util/getRGBPixels.js"),S=n(/*! ./util/getMaxSimultaneousRequests.js */ "./util/getMaxSimultaneousRequests.js"),I=n(/*! ./util/angleBetweenPoints.js */ "./util/angleBetweenPoints.js"),P=n(/*! ./util/getKeyFromKeyCode.js */ "./util/getKeyFromKeyCode.js"),M=n(/*! ./util/numbersWithCommas.js */ "./util/numbersWithCommas.js"),k=n(/*! ./tools/cursors/MouseCursor.js */ "./tools/cursors/MouseCursor.js"),D=n(/*! ./util/ellipse/index.js */ "./util/ellipse/index.js"),L=n(/*! ./util/freehand/index.js */ "./util/freehand/index.js"),R=n(/*! ./util/brush/index.js */ "./util/brush/index.js"),A=n(/*! ./util/zoom/index.js */ "./util/zoom/index.js"),O=n(/*! ./util/triggerEvent.js */ "./util/triggerEvent.js"),H=n(/*! ./util/convertToVector3.js */ "./util/convertToVector3.js"),B={"base/BaseTool":a.default,"base/BaseAnnotationTool":o.default,"base/BaseBrushTool":r.default,"tools/cursors/MouseCursor":k.default,"tools/cursors":u,"manipulators/anyHandlesOutsideImage":i.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":i.getHandleNearImagePoint,"manipulators/handleActivator":i.handleActivator,"manipulators/moveAllHandles":i.moveAllHandles,"manipulators/moveHandle":i.moveHandle,"manipulators/moveNewHandle":i.moveNewHandle,"manipulators/moveHandleNearImagePoint":l.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":l.findHandleDataNearImagePoint,"manipulators/moveAnnotation":l.moveAnnotation,"mixins/activeOrDisabledBinaryTool":s.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":s.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":d.getNewContext,"drawing/draw":d.draw,"drawing/path":d.path,"drawing/setShadow":d.setShadow,"drawing/drawLine":d.drawLine,"drawing/drawLines":d.drawLines,"drawing/drawJoinedLines":d.drawJoinedLines,"drawing/drawCircle":d.drawCircle,"drawing/drawEllipse":d.drawEllipse,"drawing/drawRect":d.drawRect,"drawing/fillOutsideRect":d.fillOutsideRect,"drawing/drawTextBox":c.default,"drawing/drawArrow":f.default,"drawing/fillBox":d.fillBox,"drawing/fillTextLines":d.fillTextLines,"drawing/drawLink":h.default,"drawing/drawLinkedTextBox":m.default,"drawing/drawHandles":g.default,"drawing/textBoxWidth":c.textBoxWidth,"util/getLuminance":v.default,"util/copyPoints":$.default,"util/calculateSUV":p.default,"util/setContextToDisplayFontSize":_.default,"util/scrollToIndex":y.default,"util/scroll":x.default,"util/roundToDecimal":T.default,"util/projectPatientPointToImagePlane":b.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":b.imagePointToPatientPoint,"util/planePlaneIntersection":b.planePlaneIntersection,"util/pointInsideBoundingBox":C.default,"util/makeUnselectable":E.default,"util/getRGBPixels":j.default,"util/getDefaultSimultaneousRequests":S.getDefaultSimultaneousRequests,"util/getMaxSimultaneousRequests":S.getMaxSimultaneousRequests,"util/getBrowserInfo":S.getBrowserInfo,"util/isMobileDevice":S.isMobileDevice,"util/angleBetweenPoints":I.default,"util/getKeyFromKeyCode":P.default,"util/numbersWithCommas":M.default,"util/lineSegDistance":w.default,"util/triggerEvent":O.default,"util/convertToVectro3":H.default,"util/ellipseUtils":D.default,"util/freehandUtils":L.default,"util/brushUtils":R.default,"util/zoomUtils":A.default}},"./manipulators/anyHandlesOutsideImage.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t){var n=e.image,o={left:0,top:0,width:n.width,height:n.height},r=!1;return Object.keys(t).forEach(function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===a.default.cornerstoneMath.point.insideRect(n,o)&&(r=!0)}),r}},"./manipulators/getHandleNearImagePoint.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n(/*! ../externalModules.js */ "./externalModules.js"),i=n(/*! ../util/pointInsideBoundingBox.js */ "./util/pointInsideBoundingBox.js"),l=function e(t,n,a,r){var i;if(n){if(Array.isArray(n))for(var l=Object.keys(n),u=0;u<l.length;u++){var d=n[l[u]];if(d.hasOwnProperty("x")&&d.hasOwnProperty("y")&&s(d,t,a,r)){i=d;break}}else if("object"===o()(n))for(var c=Object.keys(n),f=0;f<c.length;f++){var h=c[f];if(Array.isArray(n[h])){if(i=e(t,n[h],a,r))break}else{var m=n[h];if(s(m,t,a,r)){i=m;break}}}return i}},s=function e(t,n,a,o){if(t.hasOwnProperty("pointNearHandle")){if(t.pointNearHandle(n,t,a))return!0}else if(!0===t.hasBoundingBox){if(Object(i.default)(t,a))return!0}else{var l=r.default.cornerstone.pixelToCanvas(n,t);if(r.default.cornerstoneMath.point.distance(l,a)<=o)return!0}return!1};t.default=l},"./manipulators/handleActivator.js":function(e,t,n){n.r(t);var a=n(/*! ./getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n,o){o||(o=6);var r,i,l=(r=t,Object.keys(r).forEach(function(e){var t=r[e];if(!0===t.active){i=t;return}}),i),s=Object(a.default)(e,t,n,o);return l!==s&&(void 0!==s&&(s.active=!0),void 0!==l&&(l.active=!1),!0)}},"./manipulators/index.js":function(e,t,n){n.r(t);var a=n(/*! ./anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js");n.d(t,"anyHandlesOutsideImage",function(){return a.default});var o=n(/*! ./getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js");n.d(t,"getHandleNearImagePoint",function(){return o.default});var r=n(/*! ./handleActivator.js */ "./manipulators/handleActivator.js");n.d(t,"handleActivator",function(){return r.default});var i=n(/*! ./moveAllHandles.js */ "./manipulators/moveAllHandles.js");n.d(t,"moveAllHandles",function(){return i.default});var l=n(/*! ./moveHandle.js */ "./manipulators/moveHandle.js");n.d(t,"moveHandle",function(){return l.default});var s=n(/*! ./moveNewHandle.js */ "./manipulators/moveNewHandle.js");n.d(t,"moveNewHandle",function(){return s.default})},"./manipulators/moveAllHandles.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ./anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),i=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),l=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),s=n(/*! ../util/clip.js */ "./util/clip.js"),u=n(/*! ./../store/index.js */ "./store/index.js"),d=n(/*! ../util/getActiveTool */ "./util/getActiveTool.js"),c=n(/*! ../tools/base/BaseAnnotationTool */ "./tools/base/BaseAnnotationTool.js"),f={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},h={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,u=i.detail,f=u.element,h=u.image,m=u.buttons,g=i.detail.deltaPoints.image,v=g.x,$=g.y;t.active=!0,t.invalidated=!0;for(var p=Object.keys(t.handles),_=0;_<p.length;_++){var y=p[_],x=t.handles[y];!0!==x.movesIndependently&&x.hasOwnProperty("x")&&x.hasOwnProperty("y")&&(x.x+=v,x.y+=$,n.preventHandleOutsideImage&&Object(s.clipToBox)(x,h))}o.default.cornerstone.updateImage(f);var T=Object(d.default)(f,m,r);T instanceof c.default&&T.updateCachedStats(h,f,t);var b=a.default.MEASUREMENT_MODIFIED;Object(l.default)(f,b,{toolName:e,element:f,measurementData:t}),i.preventDefault(),i.stopPropagation()}t.default=function(e,t,n,a){var l=e.element,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse";s=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},s);var c=m.bind(this,t,n,s,d),g=function e(a){(function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,d=s.dragHandler,c=s.upOrEndHandler,m=arguments.length>5?arguments[5]:void 0,g=m.detail,v=m.detail.element;n.active=!1,n.invalidated=!0,u.state.isToolLocked=!1,f[l].forEach(function(e){v.removeEventListener(e,d)}),h[l].forEach(function(e){v.removeEventListener(e,c)}),a.deleteIfHandleOutsideImage&&Object(r.default)(g,n.handles)&&Object(i.removeToolState)(v,t,n),"function"==typeof a.doneMovingCallback&&a.doneMovingCallback(),o.default.cornerstone.updateImage(v)})(t,n,s,d,{dragHandler:c,upOrEndHandler:e},a)};n.active=!0,u.state.isToolLocked=!0,f[d].forEach(function(e){l.addEventListener(e,c)}),h[d].forEach(function(e){l.addEventListener(e,g)})}},"./manipulators/moveHandle.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ./anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),i=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),l=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),s=n(/*! ../util/clip.js */ "./util/clip.js"),u=n(/*! ./../store/index.js */ "./store/index.js"),d=n(/*! ../util/getActiveTool */ "./util/getActiveTool.js"),c=n(/*! ../tools/base/BaseAnnotationTool */ "./tools/base/BaseAnnotationTool.js"),f={value:!1},h={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},m={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function g(e,t,n,r,i,u){var h=u.detail,m=h.image,g=h.currentPoints,v=h.element,$=h.buttons,p=g.page,_=o.default.cornerstone.pageToPixel(v,p.x,"touch"===i?p.y+-57:p.y);f.value=!1,n.active=!0,n.hasMoved=!0,n.x=_.x,n.y=_.y,t.invalidated=!0,r.preventHandleOutsideImage&&Object(s.clipToBox)(n,m),o.default.cornerstone.updateImage(v);var y=Object(d.default)(v,$,i);y instanceof c.default&&y.updateCachedStats(m,v,t);var x=a.default.MEASUREMENT_MODIFIED;Object(l.default)(v,x,{toolName:e,element:v,measurementData:t})}t.default=function(e,t,n,l){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse";s=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},s);var c=e.element,v=g.bind(this,t,n,l,s,d),$=function c(g){(function e(t,n,l,s){var d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=arguments.length>5?arguments[5]:void 0,g=arguments.length>6?arguments[6]:void 0,v=g.dragHandler,$=g.upOrEndHandler,p=arguments.length>7?arguments[7]:void 0,_=n.currentPoints.image,y=p.detail.element;s.active=!1,l.active=!1,l.invalidated=!0,u.state.isToolLocked=!1,f.value=!1,h[c].forEach(function(e){y.removeEventListener(e,v)}),m[c].forEach(function(e){y.removeEventListener(e,$)}),d.deleteIfHandleOutsideImage&&Object(r.default)(n,l.handles)&&Object(i.removeToolState)(y,t,l),p.type===a.default.TOUCH_PRESS&&(p.detail.handlePressed=l,s.x=_.x,s.y=_.y),"function"==typeof d.doneMovingCallback&&d.doneMovingCallback(),o.default.cornerstone.updateImage(y)})(t,e,n,l,s,d,{dragHandler:v,upOrEndHandler:c},g)};if(l.active=!0,n.active=!0,u.state.isToolLocked=!0,h[d].forEach(function(e){c.addEventListener(e,v)}),m[d].forEach(function(e){c.addEventListener(e,$)}),"touch"===d){f.value=!0;var p=o.default.cornerstone.getEnabledElement(c),_={x:e.currentPoints.page.x,y:e.currentPoints.page.y+-57},y=o.default.cornerstone.pageToPixel(c,_.x,_.y);(function e(t,n,a,r){if(n.value){var i=Math.abs(t.y-r.y),l=i/10;if(i<1){t.y=r.y,n.value=!1;return}t.y>r.y?t.y-=l:t.y<r.y&&(t.y+=l),o.default.cornerstone.updateImage(a.element),o.default.cornerstone.requestAnimationFrame(function(){e(t,n,a,r)})}})(l,f,p,y)}}},"./manipulators/moveNewHandle.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ./anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),i=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),l=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),s=n(/*! ../util/clip.js */ "./util/clip.js"),u=n(/*! ./../store/index.js */ "./store/index.js"),d=n(/*! ../util/getActiveTool */ "./util/getActiveTool.js"),c=n(/*! ../tools/base/BaseAnnotationTool */ "./tools/base/BaseAnnotationTool.js"),f={mouse:[a.default.MOUSE_MOVE,a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},h={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_PINCH,a.default.TAP]};function m(e){return e.stopImmediatePropagation(),!1}t.default=function(e,t,n,g,v){var $=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse";v=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},v);var p=e.element;function _(e){(function e(t,n,r,i,u,f,m){var g=f.moveEndHandler,v=m.detail,$=v.currentPoints,p=v.image,_=v.element,y=v.buttons;h[u].forEach(function(e){_.addEventListener(e,g)});var x=$.page,T=o.default.cornerstone.pageToPixel(_,"touch"===u?x.x+-57:x.x,"touch"===u?x.y+-57:x.y);n.invalidated=!0,r.active=!0,r.x=T.x,r.y=T.y,i&&i.preventHandleOutsideImage&&Object(s.clipToBox)(r,p),o.default.cornerstone.updateImage(_);var b=Object(d.default)(_,y,u);b instanceof c.default&&b.updateCachedStats(p,_,n);var w=a.default.MEASUREMENT_MODIFIED;Object(l.default)(_,w,{toolName:t,element:_,measurementData:n})})(t,n,g,v,$,{moveEndHandler:y},e)}function y(e){(function e(t,n,l,d,c,g,v){var $=g.moveHandler,p=g.moveEndHandler,_=v.detail,y=_.element,x=_.currentPoints.page,T=o.default.cornerstone.pageToPixel(y,"touch"===c?x.x+-57:x.x,"touch"===c?x.y+-57:x.y);if(n.active=!1,n.invalidated=!0,l.active=!1,l.x=T.x,l.y=T.y,u.state.isToolLocked=!1,f[c].forEach(function(e){y.removeEventListener(e,$)}),h[c].forEach(function(e){y.removeEventListener(e,p)}),y.removeEventListener(a.default.TOUCH_START,m),v.type===a.default.TOUCH_PINCH||v.type===a.default.TOUCH_PRESS){l.active=!1,o.default.cornerstone.updateImage(y),"function"==typeof d.doneMovingCallback&&d.doneMovingCallback();return}d.preventHandleOutsideImage&&Object(s.clipToBox)(l,v.detail.image),d.deleteIfHandleOutsideImage&&Object(r.default)(v.detail,n.handles)&&Object(i.removeToolState)(y,t,n),"function"==typeof d.doneMovingCallback&&d.doneMovingCallback(),o.default.cornerstone.updateImage(y)})(t,n,g,v,$,{moveHandler:_,moveEndHandler:y},e)}n.active=!0,g.active=!0,u.state.isToolLocked=!0,f[$].forEach(function(e){p.addEventListener(e,_)}),p.addEventListener(a.default.TOUCH_START,m)}},"./mixins/activeOrDisabledBinaryTool.js":function(e,t,n){n.r(t);var a=n(/*! ../store/setToolMode.js */ "./store/setToolMode.js");t.default={passiveCallback:function e(t){Object(a.setToolDisabledForElement)(t,this.name)},enabledCallback:function e(t){Object(a.setToolActiveForElement)(t,this.name)}}},"./mixins/enabledOrDisabledBinaryTool.js":function(e,t,n){n.r(t);var a=n(/*! ../store/setToolMode.js */ "./store/setToolMode.js");t.default={passiveCallback:function e(t){Object(a.setToolDisabledForElement)(t,this.name)},activeCallback:function e(t){Object(a.setToolEnabledForElement)(t,this.name)}}},"./mixins/index.js":function(e,t,n){n.r(t);var a=n(/*! ./activeOrDisabledBinaryTool.js */ "./mixins/activeOrDisabledBinaryTool.js"),o=n(/*! ./enabledOrDisabledBinaryTool.js */ "./mixins/enabledOrDisabledBinaryTool.js");t.default={activeOrDisabledBinaryTool:a.default,enabledOrDisabledBinaryTool:o.default}},"./orientation/getOrientationString.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../util/convertToVector3.js */ "./util/convertToVector3.js");t.default=function(e){for(var t=Object(o.default)(e),n="",r=t.x<0?"R":"L",i=t.y<0?"A":"P",l=t.z<0?"F":"H",s=new a.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=0;u<3;u++)if(s.x>1e-4&&s.x>s.y&&s.x>s.z)n+=r,s.x=0;else if(s.y>1e-4&&s.y>s.x&&s.y>s.z)n+=i,s.y=0;else if(s.z>1e-4&&s.z>s.x&&s.z>s.y)n+=l,s.z=0;else break;return n}},"./orientation/index.js":function(e,t,n){n.r(t);var a=n(/*! ./getOrientationString.js */ "./orientation/getOrientationString.js"),o=n(/*! ./invertOrientationString.js */ "./orientation/invertOrientationString.js"),r={getOrientationString:a.default,invertOrientationString:o.default};t.default=r},"./orientation/invertOrientationString.js":function(e,t,n){n.r(t),t.default=function(e){var t=e.replace("H","f");return(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},"./requestPool/requestPoolManager.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../util/getMaxSimultaneousRequests.js */ "./util/getMaxSimultaneousRequests.js"),r={interaction:[],thumbnail:[],prefetch:[]},i={interaction:0,thumbnail:0,prefetch:0},l={interaction:6,thumbnail:6,prefetch:5},s=!1;function u(){s&&setTimeout(function(){c()},20)}function d(e){var t,n=a.default.cornerstone,o=e.type;i[o]++,s=!0;var r=e.imageId,l=e.doneCallback,d=e.failCallback,c=n.imageCache.getImageLoadObject(r);if(c){c.promise.then(function(e){i[o]--,l(e),u()},function(e){i[o]--,d(e),u()});return}var f,h=(f=e,"prefetch"===f.type?-5:"interactive"===f.type?0:"thumbnail"===f.type?5:void 0);(t=!0===e.preventCache?n.loadImage(r,{priority:h,type:e.type}):n.loadAndCacheImage(r,{priority:h,type:e.type})).then(function(e){i[o]--,l(e),u()},function(e){i[o]--,d(e),u()})}function c(){var e=Object(o.getMaxSimultaneousRequests)();l={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(i.interaction+i.thumbnail+i.prefetch),n=0;n<t;n++){var a=f();a&&d(a)}}function f(){return r.interaction.length&&i.interaction<l.interaction?r.interaction.shift():r.thumbnail.length&&i.thumbnail<l.thumbnail?r.thumbnail.shift():r.prefetch.length&&i.prefetch<l.prefetch?r.prefetch.shift():(r.interaction.length||r.thumbnail.length||r.prefetch.length||(s=!1),!1)}function h(){return r}t.default={addRequest:function e(t,n,o,i,l,u,d){if(!r.hasOwnProperty(o))throw Error("Request type must be one of interaction, thumbnail, or prefetch");if(t&&n){var c={type:o,imageId:n,preventCache:i,doneCallback:l,failCallback:u},f=a.default.cornerstone.imageCache.getImageLoadObject(n);if(f){f.promise.then(function(e){l(e)},function(e){u(e)});return}d?r[o].unshift(c):r[o].push(c),s=!0}},clearRequestStack:function e(t){if(!r.hasOwnProperty(t))throw Error("Request type must be one of interaction, thumbnail, or prefetch");r[t]=[]},startGrabbing:c,getRequestPool:h}},"./stackTools/fusionRenderer.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return u});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! ../externalModules.js */ "./externalModules.js"),s=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),u=function(){function e(){o()(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return i()(e,[{key:"render",value:function e(t,n){var a=this;if(!Number.isInteger(this.currentImageIdIndex))throw Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw Error("No findImage function has been defined");!n&&(n=Object(s.getToolState)(t,"stack").data);var o=l.default.cornerstone,r=n[0],i=r.imageIds[this.currentImageIdIndex],u=n.slice(1,n.length);o.loadAndCacheImage(i).then(function(e){var n=a.layerIds[0];n?o.setLayerImage(t,e,n):(n=o.addLayer(t,e,r.options),a.layerIds.push(n)),o.displayImage(t,e),u.forEach(function(e,r){var l=a.findImageFn(e.imageIds,i),s=a.layerIds[r+1];s||(s=o.addLayer(t,void 0,e.options),a.layerIds.push(s)),l?o.loadAndCacheImage(l).then(function(e){o.setLayerImage(t,e,s),o.updateImage(t)}):(o.setLayerImage(t,void 0,s),o.setActiveLayer(t,n),o.updateImage(t))})})}}]),e}()},"./stackTools/playClip.js":function(e,t,n){n.r(t),n.d(t,"playClip",function(){return d}),n.d(t,"stopClip",function(){return c});var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),i=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),l=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js"),s="playClip";function u(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function d(e,t){if(void 0===e)throw Error("playClip: element must not be undefined");var n,d,c,f=Object(i.getToolState)(e,"stack");if(f&&f.data&&f.data.length){var h=o.default.cornerstone;if(f.data.length>1){var m=Object(i.getToolState)(e,"stackRenderer");m&&m.data&&m.data.length&&(c=m.data[0])}var g=f.data[0],v=Object(i.getToolState)(e,s);v&&v.data&&v.data.length?u(n=v.data[0]):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(i.addToolState)(e,s,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===g.imageIds.length&&(d=function e(t,n){var a,o,r,i=0,l=t.length,s=[];for(s.isTimeVarying=!1,("number"!=typeof n||n<=0)&&(n=1),a=1;a<l;a++)r=Number(t[a])/n|0,s.push(r),1===a?o=r:r!==o&&(s.isTimeVarying=!0),i+=r;return s.length>0&&(r=s.isTimeVarying?i/s.length|0:s[0],s.push(r)),s}(n.frameTimeVector,n.speed));var $=function t(){var o,i,s,d,m,v=g.currentImageIdIndex,$=g.imageIds.length;if(n.reverse?v--:v++,!n.loop&&(v<0||v>=$)){u(n),o=e,Object(l.default)(o,a.default.CLIP_STOPPED,{element:o});return}v>=$&&(v=0),v<0&&(v=$-1),v!==g.currentImageIdIndex&&(s=r.default.getStartLoadHandler(e),d=r.default.getEndLoadHandler(e),m=r.default.getErrorLoadingHandler(e),s&&s(e),(i=!0===g.preventCache?h.loadImage(g.imageIds[v]):h.loadAndCacheImage(g.imageIds[v])).then(function(t){try{g.currentImageIdIndex=v,c?(c.currentImageIdIndex=v,c.render(e,f.data)):h.displayImage(e,t),d&&d(e,t)}catch(n){return}},function(t){var n=g.imageIds[v];m&&m(e,n,t)}))};d&&d.length>0&&d.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout(function e(){n.intervalId=setTimeout(e,d[g.currentImageIdIndex]),$()},0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval($,1e3/Math.abs(n.framesPerSecond)))}}function c(e){var t=Object(i.getToolState)(e,s);t&&t.data&&t.data.length&&u(t.data[0])}},"./stackTools/stackPrefetch.js":function(e,t,n){n.r(t);var a,o=n(/*! ./../externalModules.js */ "./externalModules.js"),r=n(/*! ../requestPool/requestPoolManager.js */ "./requestPool/requestPoolManager.js"),i=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),l=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),s=n(/*! ../util/getMaxSimultaneousRequests.js */ "./util/getMaxSimultaneousRequests.js"),u=n(/*! ../util/logger.js */ "./util/logger.js"),d=n(/*! ../util/triggerEvent */ "./util/triggerEvent.js"),c=n(/*! ../events.js */ "./events.js"),f=Object(u.getLogger)("stackTools:stackPrefetch"),h="stackPrefetch",m="prefetch",g={maxImagesToPrefetch:1/0};function v(e){var t,n,a,s,u,v,$,p,_=Object(l.getToolState)(e,"stack");if(_&&_.data&&_.data.length){var y=_.data[0],x=Object(l.getToolState)(e,h);if(x){var T=x.data[0]||{};if(T.indicesToRequest&&T.indicesToRequest.length||(T.enabled=!1),!1!==T.enabled){if(x.data[0].indicesToRequest.sort(function(e,t){return e-t}),T.indicesToRequest.slice().forEach(function(e){var t=y.imageIds[e];t&&o.default.cornerstone.imageCache.getImageLoadObject(t)&&k(e)}),T.indicesToRequest.length){r.default.clearRequestStack(m);for(var b=(t=T.indicesToRequest,n=y.currentImageIdIndex,a=[],s=[],t.forEach(function(e){e<n?a.push(e):e>n&&s.push(e)}),{low:t.indexOf((u=a,Math.max.apply(null,u))),high:t.indexOf((v=s,Math.min.apply(null,v)))}),w=i.default.getErrorLoadingHandler(e),C=b.low,E=b.high;C>=0||E<T.indicesToRequest.length;){var j=y.currentImageIdIndex,S=j-T.indicesToRequest[C]>g.maxImagesToPrefetch,I=T.indicesToRequest[E]-j>g.maxImagesToPrefetch,P=!S&&C>=0,M=!I&&E<T.indicesToRequest.length;if(!M&&!P)break;P&&(p=T.indicesToRequest[C--],$=y.imageIds[p],r.default.addRequest(e,$,m,!1,D,L)),M&&(p=T.indicesToRequest[E++],$=y.imageIds[p],r.default.addRequest(e,$,m,!1,D,L))}r.default.startGrabbing()}}}}function k(e){var t=T.indicesToRequest.indexOf(e);t>-1&&T.indicesToRequest.splice(t,1)}function D(t){f.log("prefetch done: %s",t.imageId);var n=y.imageIds.indexOf(t.imageId);k(n),Object(d.default)(e,c.default.STACK_PREFETCH_IMAGE_LOADED,{element:e,imageId:t.imageId,imageIndex:n,stackPrefetch:T,stack:y}),T.indicesToRequest&&T.indicesToRequest.length>0||Object(d.default)(e,c.default.STACK_PREFETCH_DONE,{element:e,stackPrefetch:T,stack:y})}function L(t){f.log("prefetch errored: %o",t),w&&w(e,$,t,"stackPrefetch")}}function $(e){return function(t){var n,a=t.detail;try{n=Object(l.getToolState)(e,"stack")}catch(o){return}if(n&&n.data&&n.data.length){var r=n.data[0].imageIds.indexOf(a.imageId);if(!(r<0)){var i=Object(l.getToolState)(e,h);i&&i.data&&i.data.length&&i.data[0].indicesToRequest.push(r)}}}}function p(e){clearTimeout(a),a=setTimeout(function(){var t=e.target;try{v(t)}catch(n){return}},10)}function _(){return g}t.default={enable:function e(t){Object(l.getToolState)(t,h).data=[];var n=Object(l.getToolState)(t,"stack");if(n&&n.data&&n.data.length){var a=n.data[0];if(!0===a.preventCache){f.warn("A stack that should not be cached was given the stackPrefetch");return}var r={indicesToRequest:function e(t,n){t=Math.round(t)||0;var a=[],o=(n=Math.round(n)||0)-t+1;if(o<=0)return a;for(;o--;)a[o]=n--;return a}(0,a.imageIds.length-1),enabled:!0,direction:1},i=r.indicesToRequest.indexOf(a.currentImageIdIndex);r.indicesToRequest.splice(i,1),Object(l.addToolState)(t,h,r),v(t),t.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,p),t.addEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,p);var s=$(t);o.default.cornerstone.events.removeEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,s),o.default.cornerstone.events.addEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,s)}},disable:function e(t){clearTimeout(a),t.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,p);var n=$(t);o.default.cornerstone.events.removeEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,n);var i=Object(l.getToolState)(t,h);i&&i.data.length&&(i.data[0].enabled=!1,r.default.clearRequestStack(m))},getConfiguration:_,setConfiguration:function e(t){g=t,t.maxSimultaneousRequests&&Object(s.setMaxSimultaneousRequests)(t.maxSimultaneousRequests)}}},"./stackTools/stackRenderers.js":function(e,t,n){n.r(t);var a=n(/*! ./fusionRenderer.js */ "./stackTools/fusionRenderer.js"),o={};o.FusionRenderer=a.default,t.default=o},"./stateManagement/frameOfReferenceStateManager.js":function(e,t,n){function a(){var e={};return{get:function t(n,a){if(!1!==e.hasOwnProperty(n)){var o=e[n];if(!1!==o.hasOwnProperty(a))return o[a]}},add:function t(n,a,o){!1===e.hasOwnProperty(n)&&(e[n]={});var r=e[n];!1===r.hasOwnProperty(a)&&(r[a]={data:[]}),r[a].data.push(o)},remove:function t(n,a,o){if(!1!==e.hasOwnProperty(n)){var r=e[n];if(!1!==r.hasOwnProperty(a)){for(var i=r[a],l=-1,s=0;s<i.data.length;s++)i.data[s]===o&&(l=s);-1!==l&&i.data.splice(l,1)}}}}}n.r(t),n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return a}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return o});var o=a()},"./stateManagement/imageIdSpecificStateManager.js":function(e,t,n){n.r(t),n.d(t,"newImageIdSpecificToolStateManager",function(){return o}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return r});var a=n(/*! ../externalModules.js */ "./externalModules.js");function o(){var e={};function t(t){return e[t]}function n(t,n){e[t]=n}function o(){return e}function r(t){e=t}return{get:function t(n,o){var r=a.default.cornerstone.getEnabledElement(n);if(r.image&&!1!==e.hasOwnProperty(r.image.imageId)){var i=e[r.image.imageId];if(!1!==i.hasOwnProperty(o))return i[o]}},add:function t(n,o,r){var i=a.default.cornerstone.getEnabledElement(n);if(i.image){!1===e.hasOwnProperty(i.image.imageId)&&(e[i.image.imageId]={});var l=e[i.image.imageId];!1===l.hasOwnProperty(o)&&(l[o]={data:[]}),l[o].data.push(r)}},clear:function t(n){var o=a.default.cornerstone.getEnabledElement(n);o.image&&!1!==e.hasOwnProperty(o.image.imageId)&&delete e[o.image.imageId]},saveImageIdToolState:t,restoreImageIdToolState:n,saveToolState:o,restoreToolState:r,toolState:e}}var r=o()},"./stateManagement/loadHandlerManager.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o="DEFAULT",r={},i={},l={};function s(e){if(!e)return o;var t=a.default.cornerstone.getEnabledElement(e).uuid;if(!t)throw Error("Something went wrong when getting uuid from element");return t}t.default={setStartLoadHandler:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!t)throw Error("The Handler function must be defined");r[s(n)]=t},getStartLoadHandler:function e(t){return r[s(t)]||r[o]},setEndLoadHandler:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!t)throw Error("The Handler function must be defined");i[s(n)]=t},getEndLoadHandler:function e(t){return i[s(t)]||i[o]},setErrorLoadingHandler:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!t)throw Error("The Handler function must be defined");l[s(n)]=t},getErrorLoadingHandler:function e(t){return l[s(t)]||l[o]},removeHandlers:function e(t){var n=s(t);delete r[n],delete i[n],delete l[n]}}},"./stateManagement/stackSpecificStateManager.js":function(e,t,n){n.r(t),n.d(t,"stackSpecificStateManager",function(){return l}),n.d(t,"newStackSpecificToolStateManager",function(){return r}),n.d(t,"addStackStateManager",function(){return i});var a=n(/*! ./imageIdSpecificStateManager.js */ "./stateManagement/imageIdSpecificStateManager.js"),o=n(/*! ./toolState.js */ "./stateManagement/toolState.js");function r(e,t){var n={};function a(){return n}function o(e){n=e}return{get:function a(o,r){return e.indexOf(r)>=0?(!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r]):t.get(o,r)},add:function a(o,r,i){if(!(e.indexOf(r)>=0))return t.add(o,r,i);!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r].data.push(i)},saveToolState:a,restoreToolState:o,toolState:n}}function i(e,t){var n=Object(o.getElementToolStateManager)(e);n||(n=a.globalImageIdSpecificToolStateManager);var i=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(i=i.concat(t));var l=r(i,n);Object(o.setElementToolStateManager)(e,l)}var l={newStackSpecificToolStateManager:r,addStackStateManager:i}},"./stateManagement/textStyle.js":function(e,t,n){n.r(t);var a=15,o="".concat(a,"px Arial"),r="transparent";function i(e){o=e}function l(){return o}function s(e){a=e}function u(){return a}function d(e){r=e}function c(){return r}t.default={setFont:i,getFont:l,setFontSize:s,getFontSize:u,setBackgroundColor:d,getBackgroundColor:c}},"./stateManagement/toolColors.js":function(e,t,n){n.r(t);var a="white",o="greenyellow",r="transparent";function i(e){r=e}function l(){return r}function s(e){a=e}function u(){return a}function d(e){o=e}function c(){return o}t.default={setFillColor:i,getFillColor:l,setToolColor:s,getToolColor:u,setActiveColor:d,getActiveColor:c,getColorIfActive:function e(t){return t.color?t.color:t.active?o:a}}},"./stateManagement/toolCoordinates.js":function(e,t,n){var a;function o(){return a}n.r(t),t.default={setCoords:function e(t){a=t.currentPoints.canvas},getCoords:o}},"./stateManagement/toolState.js":function(e,t,n){n.r(t),n.d(t,"addToolState",function(){return s}),n.d(t,"getToolState",function(){return u}),n.d(t,"removeToolState",function(){return d}),n.d(t,"clearToolState",function(){return c}),n.d(t,"setElementToolStateManager",function(){return f}),n.d(t,"getElementToolStateManager",function(){return l});var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ./imageIdSpecificStateManager.js */ "./stateManagement/imageIdSpecificStateManager.js"),i=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js");function l(e){var t=o.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=r.globalImageIdSpecificToolStateManager),t.toolStateManager}function s(e,t,n){l(e).add(e,t,n);var o=a.default.MEASUREMENT_ADDED;Object(i.default)(e,o,{toolType:t,element:e,measurementData:n})}function u(e,t){return l(e).get(e,t)}function d(e,t,n){for(var o=l(e).get(e,t),r=-1,s=0;s<o.data.length;s++)o.data[s]===n&&(r=s);if(-1!==r){o.data.splice(r,1);var u=a.default.MEASUREMENT_REMOVED;Object(i.default)(e,u,{toolType:t,element:e,measurementData:n})}}function c(e,t){var n=l(e).get(e,t);void 0!==n&&(n.data=[])}function f(e,t){o.default.cornerstone.getEnabledElement(e).toolStateManager=t}},"./stateManagement/toolStyle.js":function(e,t,n){n.r(t);var a=1,o=2;function r(e){a=e}function i(){return a}function l(e){o=e}function s(){return o}t.default={setToolWidth:r,getToolWidth:i,setActiveWidth:l,getActiveWidth:s}},"./store/addTool.js":function(e,t,n){n.r(t),n.d(t,"addTool",function(){return l}),n.d(t,"addToolForElement",function(){return i});var a=n(/*! ./index.js */ "./store/index.js"),o=n(/*! ./getToolForElement.js */ "./store/getToolForElement.js"),r=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("addTool"),i=function e(t,n,i){var l=new n(i);if(Object(o.default)(t,l.name)){r.warn("%s has already been added to the target element",l.name);return}l.element=t,a.default.state.tools.push(l)},l=function e(t,n){s(t,n),a.default.state.enabledElements.forEach(function(e){i(e,t,n)})},s=function e(t,n){if(a.default.modules.globalConfiguration.state.globalToolSyncEnabled){var o=new t(n);if(void 0!==a.default.state.globalTools[o.name]){r.warn("%s has already been added globally",o.name);return}a.default.state.globalTools[o.name]={tool:t,props:n,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(e,t,n){n.r(t);var a=n(/*! ../tools/base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),o=n(/*! ../tools/base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js");t.default=function(e){return e.filter(function(e){return!e.isMultiPartTool&&!(e instanceof a.default)&&!(e instanceof o.default)})}},"./store/getActiveToolsForElement.js":function(e,t,n){n.r(t),t.default=function(e,t,n){return t.filter(function(t){return t.element===e&&"active"===t.mode&&(void 0===n||t.options["is".concat(n,"Active")])})}},"./store/getInteractiveToolsForElement.js":function(e,t,n){n.r(t),t.default=function(e,t){return t.filter(function(t){return t.element===e&&("active"===t.mode||"passive"===t.mode)})}},"./store/getToolForElement.js":function(e,t,n){n.r(t);var a=n(/*! ./index.js */ "./store/index.js");t.default=function(e,t){return a.state.tools.find(function(n){return n.element===e&&n.name===t})}},"./store/getToolsWithDataForElement.js":function(e,t,n){n.r(t);var a=n(/*! ./../stateManagement/toolState.js */ "./stateManagement/toolState.js");t.default=function(e,t){return t.filter(function(t){var n=Object(a.getToolState)(e,t.name);return n&&n.data.length>0})}},"./store/getToolsWithMoveableHandles.js":function(e,t,n){n.r(t);var a=n(/*! ./index.js */ "./store/index.js"),o=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ../manipulators/getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",l="mouse"===i?a.state.clickProximity:a.state.touchProximity;return t.filter(function(t){for(var a=Object(o.getToolState)(e,t.name),i=0;i<a.data.length;i++)if(void 0!==Object(r.default)(e,a.data[i].handles,n,l))return!0;return!1})}},"./store/index.js":function(e,t,n){n.r(t),n.d(t,"state",function(){return l}),n.d(t,"getters",function(){return s}),n.d(t,"setters",function(){return u}),n.d(t,"modules",function(){return d});var a=n(/*! ./modules/brushModule.js */ "./store/modules/brushModule.js"),o=n(/*! ./modules/cursorModule.js */ "./store/modules/cursorModule.js"),r=n(/*! ./modules/globalConfigurationModule.js */ "./store/modules/globalConfigurationModule.js"),i=n(/*! ../externalModules.js */ "./externalModules.js"),l={globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,svgCursorUrl:null},s={mouseTools:function e(){return l.tools.filter(function(e){return e.supportedInteractionTypes.includes("Mouse")})},touchTools:function e(){return l.tools.filter(function(e){return e.supportedInteractionTypes.includes("Touch")})},enabledElementByUID:function e(t){return l.enabledElements.find(function(e){return i.default.cornerstone.getEnabledElement(e).uuid===t})}},u={},d={brush:a.default,cursor:o.default,globalConfiguration:r.default};t.default={modules:d,state:l,getters:s}},"./store/internals/addEnabledElement.js":function(e,t,n){n.r(t);var a=n(/*! ../../eventListeners/index.js */ "./eventListeners/index.js"),o=n(/*! ../../eventDispatchers/index.js */ "./eventDispatchers/index.js"),r=n(/*! ./../addTool.js */ "./store/addTool.js"),i=n(/*! ./../setToolMode.js */ "./store/setToolMode.js"),l=n(/*! ../index.js */ "./store/index.js"),s=Object(n(/*! ../../util/logger.js */ "./util/logger.js").getLogger)("internals:addEnabledElement");t.default=function(e){s.log("EVENT:ELEMENT_ENABLED");var t=e.detail.element;o.imageRenderedEventDispatcher.enable(t),o.newImageEventDispatcher.enable(t),l.default.modules.globalConfiguration.state.mouseEnabled&&(a.mouseEventListeners.enable(t),a.wheelEventListener.enable(t),o.mouseToolEventDispatcher.enable(t)),l.default.modules.globalConfiguration.state.touchEnabled&&(a.touchEventListeners.enable(t),o.touchToolEventDispatcher.enable(t)),u(t)};var u=function e(t){var n,a,o;l.default.state.enabledElements.push(t),l.default.modules&&(n=t,a=l.default.modules,Object.keys(a).forEach(function(e){"function"==typeof a[e].enabledElementCallback&&a[e].enabledElementCallback(n)})),o=t,l.default.modules.globalConfiguration.state.globalToolSyncEnabled&&Object.keys(l.default.state.globalTools).forEach(function(e){var t=l.default.state.globalTools[e],n=t.tool,a=t.props;Object(r.addToolForElement)(o,n,a)}),function e(t){if(l.default.modules.globalConfiguration.state.globalToolSyncEnabled){var n={active:i.setToolActiveForElement,passive:i.setToolPassiveForElement,enabled:i.setToolEnabledForElement,disabled:i.setToolDisabledForElement};l.default.state.globalToolChangeHistory.forEach(function(e){var a=e.args.slice(0);a.unshift(t),n[e.mode].apply(null,a)})}}(t)}},"./store/internals/removeEnabledElement.js":function(e,t,n){n.r(t);var a=n(/*! ../../eventListeners/index.js */ "./eventListeners/index.js"),o=n(/*! ../../eventDispatchers/index.js */ "./eventDispatchers/index.js"),r=n(/*! ../index.js */ "./store/index.js"),i=n(/*! ../../util/logger.js */ "./util/logger.js"),l=n(/*! ../../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),s=Object(i.getLogger)("internals:removeEnabledElement");t.default=function(e){s.log("EVENT:ELEMENT_DISABLED");var t=e.detail.element;o.imageRenderedEventDispatcher.disable(t),o.newImageEventDispatcher.disable(t),r.default.modules.globalConfiguration.state.mouseEnabled&&(a.mouseEventListeners.disable(t),a.wheelEventListener.disable(t),o.mouseToolEventDispatcher.disable(t)),r.default.modules.globalConfiguration.state.touchEnabled&&(a.touchEventListeners.disable(t),o.touchToolEventDispatcher.disable(t)),u(t),d(t),c(t)};var u=function e(t){r.default.state.tools=r.default.state.tools.filter(function(e){return e.element!==t})},d=function e(t){r.default.modules&&(n=t,a=r.default.modules,Object.keys(a).forEach(function(e){"function"==typeof a[e].removeEnabledElementCallback&&a[e].removeEnabledElementCallback(n)}));var n,a,o=r.default.state.enabledElements.findIndex(function(e){return e===t});o>-1?r.default.state.enabledElements.splice(o,1):s.warn("unable to remove element")},c=function e(t){l.default.removeHandlers(t)}},"./store/isToolActive.js":function(e,t,n){n.r(t);var a=n(/*! ./getToolForElement.js */ "./store/getToolForElement.js");t.default=function(e,t){return"active"===Object(a.default)(e,t).mode}},"./store/modules/brushModule.js":function(e,t,n){n.r(t);var a=n(/*! ./../../externalModules.js */ "./externalModules.js"),o={drawColorId:0,radius:10,minRadius:1,maxRadius:50,alpha:.4,renderBrushIfHiddenButActive:!0,hiddenButActiveAlpha:.2,colorMapId:"BrushColorMap",visibleSegmentations:{},imageBitmapCache:{},segmentationMetadata:{},invalidatedEnabledElements:[]},r={radius:function e(t){o.radius=Math.min(Math.max(t,o.minRadius),o.maxRadius)},forceUpdateImageForElement:function e(t){var n=a.default.cornerstone.getEnabledElement(t).uuid;o.invalidatedEnabledElements.includes(n)||o.invalidatedEnabledElements.push(n)},brushColorMap:function e(t){var n=a.default.cornerstone.colors.getColormap(o.colorMapId);n.setNumberOfColors(t.length);for(var r=0;r<t.length;r++)n.setColor(r,t[r])},elementVisible:function e(t){if(a.default.cornerstone){var n=a.default.cornerstone.getEnabledElement(t).uuid,r=a.default.cornerstone.colors.getColormap(o.colorMapId).getNumberOfColors();o.visibleSegmentations[n]=[];for(var i=0;i<r;i++)o.visibleSegmentations[n].push(!0)}},brushVisibilityForElement:function e(t,n){var a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];o.visibleSegmentations[t]||(o.imageBitmapCache[t]=[]),o.visibleSegmentations[t][n]=a},imageBitmapCacheForElement:function e(t,n,a){o.imageBitmapCache[t]||(o.imageBitmapCache[t]=[]),o.imageBitmapCache[t][n]=a},clearImageBitmapCacheForElement:function e(t){o.imageBitmapCache[t]=[]},metadata:function e(t,n,a){o.segmentationMetadata[t]||(o.segmentationMetadata[t]=[]),o.segmentationMetadata[t][n]=a}};t.default={state:o,onRegisterCallback:function e(){(function e(){var t=a.default.cornerstone.colors.getColormap(o.colorMapId);t.setNumberOfColors(19);for(var n=0;n<19;n++)n<i.length?t.setColor(n,i[n]):t.setColor(n,s())})()},enabledElementCallback:function e(t){r.elementVisible(t)},getters:{imageBitmapCacheForElement:function e(t){return o.imageBitmapCache[t]?o.imageBitmapCache[t]:null},visibleSegmentationsForElement:function e(t){return o.visibleSegmentations[t]?o.visibleSegmentations[t]:null},metadata:function e(t,n){return o.segmentationMetadata[t]?void 0!==n?o.segmentationMetadata[t][n]:o.segmentationMetadata[t]:void 0}},setters:r};var i=[[230,25,75,255],[60,180,175,255],[255,225,25,255],[0,130,200,255],[245,130,48,255],[145,30,180,255],[70,240,240,255],[240,50,230,255],[210,245,60,255],[250,190,190,255],[0,128,128,255],[230,190,255,255],[170,110,40,255],[255,250,200,255],[128,0,0,255],[170,255,195,255],[128,128,0,255],[255,215,180,255],[0,0,128,255]],l=0;function s(){for(var e,t=(e=[l],l<i.length-1?(l++,e.push(l)):(l=0,e.push(l)),e),n=Math.random(),a=[],o=0;o<4;o++)a.push(Math.floor(n*i[t[0]][o]+(1-n)*i[t[1]][o]));return a}},"./store/modules/cursorModule.js":function(e,t,n){n.r(t);var a={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '};t.default={getters:{defaultOptions:function e(){return a}},setters:{defaultOptions:function e(t){Object.assign(a,t)}}}},"./store/modules/globalConfigurationModule.js":function(e,t,n){n.r(t),t.default={state:{mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1},setters:{}}},"./store/removeTool.js":function(e,t,n){n.r(t),n.d(t,"removeTool",function(){return r}),n.d(t,"removeToolForElement",function(){return o});var a=n(/*! ./index.js */ "./store/index.js"),o=function e(t,n){var o=a.default.state.tools.findIndex(function(e){return e.element===t&&e.name===n});o>=0&&a.default.state.tools.splice(o,1)},r=function e(t){i(t),a.default.state.enabledElements.forEach(function(e){o(e,t)})},i=function e(t){a.default.modules.globalConfiguration.state.globalToolSyncEnabled&&a.default.state.globalTools[t]&&delete a.default.state.globalTools[t]}},"./store/setToolCursor.js":function(e,t,n){n.r(t),n.d(t,"setToolCursor",function(){return r}),n.d(t,"resetToolCursor",function(){return i}),n.d(t,"hideToolCursor",function(){return l});var a=n(/*! ./index.js */ "./store/index.js"),o=a.modules.globalConfiguration;function r(e,t){if(o.state.showSVGCursors){var n=t.getIconWithPointerSVG(),r=t.mousePoint,i=window.URL.createObjectURL(n);e.style.cursor="url('".concat(i,"') ").concat(r,", auto"),a.state.svgCursorUrl=i}}function i(e){s(e,"initial")}function l(e){o.state.showSVGCursors&&s(e,"none")}function s(e,t){a.state.svgCursorUrl&&window.URL.revokeObjectURL(a.state.svgCursorUrl),a.state.svgCursorUrl=null,e.style.cursor=t}},"./store/setToolMode.js":function(e,t,n){n.r(t),n.d(t,"setToolActive",function(){return f}),n.d(t,"setToolActiveForElement",function(){return c}),n.d(t,"setToolDisabled",function(){return m}),n.d(t,"setToolDisabledForElement",function(){return h}),n.d(t,"setToolEnabled",function(){return v}),n.d(t,"setToolEnabledForElement",function(){return g}),n.d(t,"setToolPassive",function(){return p}),n.d(t,"setToolPassiveForElement",function(){return $}),n.d(t,"setToolMode",function(){return y}),n.d(t,"setToolModeForElement",function(){return _}),n.d(t,"_getNormalizedOptions",function(){return w}),n.d(t,"_mergeMouseButtonMask",function(){return C});var a=n(/*! ./../events.js */ "./events.js"),o=n(/*! ./../util/triggerEvent.js */ "./util/triggerEvent.js"),r=n(/*! ./getToolForElement.js */ "./store/getToolForElement.js"),i=n(/*! ./../store/index.js */ "./store/index.js"),l=n(/*! ./setToolCursor.js */ "./store/setToolCursor.js"),s=n(/*! ../util/logger.js */ "./util/logger.js"),u=i.default.modules.globalConfiguration,d=Object(s.getLogger)("store:setToolMode"),c=function e(t,n,a,o){void 0===o&&Array.isArray(a)&&(o=a,a=null);var s,c,f,h,m,g,v,p,y=Object(r.default)(t,n);y&&(s=t,c=y,f=a,h=o,c.supportedInteractionTypes.forEach(function(e){if(void 0===h||h.includes(e)){var t=b[e];t?t(c,s,f):d.warn("Unable to resolve input conflicts for type %s",e)}}),i.default.state.tools.filter(function(e){return e.element===s&&"active"===e.mode&&e.supportedInteractionTypes.length>0}).forEach(function(e){var t=!1;e.supportedInteractionTypes.forEach(function(n){e.options["is".concat(n,"Active")]&&(t=!0)}),t||(d.log("Setting tool %s's to PASSIVE",e.name),$(s,e.name))}),y.supportedInteractionTypes.forEach(function(e){void 0===o||o.includes(e)?a["is".concat(e,"Active")]=!0:a["is".concat(e,"Active")]=!1}),u.state.showSVGCursors&&y.supportedInteractionTypes.includes("Mouse")&&(m=t,g=a,v=y,(p="number"==typeof g?[g]:g.mouseButtonMask).includes(1)&&(v.svgCursor?Object(l.setToolCursor)(v.element,v.svgCursor):v.hideDefaultCursor?Object(l.hideToolCursor)(m):Object(l.resetToolCursor)(m)))),_("active",null,t,n,a)},f=function e(t,n,a){T("active",t,n,a),i.default.state.enabledElements.forEach(function(e){c(e,t,n,a)})},h=_.bind(null,"disabled",null),m=y.bind(null,"disabled",null),g=_.bind(null,"enabled",null),v=y.bind(null,"enabled",null),$=_.bind(null,"passive",a.default.TOOL_DEACTIVATED),p=y.bind(null,"passive",a.default.TOOL_DEACTIVATED);function _(e,t,n,a,i){var l=Object(r.default)(n,a);if(!l){d.warn('Unable to find tool "%s" for enabledElement',a);return}if(Array.isArray((i=w(i)).mouseButtonMask)&&0!==i.mouseButtonMask.length&&Array.isArray(l.options.mouseButtonMask)&&(i.mouseButtonMask=C(i.mouseButtonMask,l.options.mouseButtonMask)),l.mode=e,l.mergeOptions(i),l["".concat(e,"Callback")]&&l["".concat(e,"Callback")](n,i),t){var s={options:i,toolName:a,type:t};Object(o.default)(n,t,s)}}function y(e,t,n,a){T(e,n,a),i.default.state.enabledElements.forEach(function(o){_(e,t,o,n,a)})}function x(e,t,n){var a="is".concat(e,"Active"),o=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options[a]});o&&(d.log("Setting tool %s's %s to false",o.name,a),o.options[a]=!1)}function T(e,t,n,a){if(i.default.modules.globalConfiguration.state.globalToolSyncEnabled){var o={mode:e,args:[t,n]};a&&o.push(a),i.default.state.globalToolChangeHistory.push(o),i.default.state.globalToolChangeHistory.length>50&&i.default.state.globalToolChangeHistory.shift();var r=i.default.state.globalTools[t];if(!r){d.warn("setToolMode call for tool that's not available globally: ".concat(t));return}if("active"===e){var l=function e(t,n,a){void 0===a&&Array.isArray(n)&&(a=n,n=null);var o=[],r=i.default.state.globalTools[t];if(r){var l=new r.tool(r.props);l.supportedInteractionTypes.forEach(function(e){if(void 0===a||a.includes(e)){if("Mouse"===e){var t=w(n).mouseButtonMask;Array.isArray(t)&&t.length>0?t.forEach(function(t){return o.push("".concat(e,"-").concat(t))}):Array.isArray(t)&&0===t.length&&o.push("".concat(e,"-DELETE"))}else"MultiTouch"===e?o.push("".concat(e,"-").concat(l.configuration.touchPointers)):o.push(e)}})}return o}(t,n,a);Object.keys(i.default.state.globalTools).forEach(function(e){var t=i.default.state.globalTools[e];t.activeBindings=t.activeBindings.filter(function(e){return!l.includes(e)})}),l.some(function(e){return e.includes("Mouse-DELETE")})&&(r.activeBindings=r.activeBindings.filter(function(e){return!e.includes("Mouse")}),l=l.filter(function(e){return!e.includes("Mouse")})),r.activeBindings=r.activeBindings.concat(l)}else r.activeBindings=[]}}var b={Mouse:function e(t,n,a){var o=w(a).mouseButtonMask;if(Array.isArray(o)&&o.length>0){var r=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options.isMouseActive&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.some(function(e){return o.includes(e)})});r&&(r.options.mouseButtonMask=r.options.mouseButtonMask.filter(function(e){return!o.includes(e)}),0===r.options.mouseButtonMask.length&&(r.options.isMouseActive=!1))}},MouseWheel:x.bind(void 0,"MouseWheel"),Touch:function e(t,n){var a=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options.isTouchActive}),o=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&1===e.configuration.touchPointers});a&&(d.log("Setting tool %s's isTouchActive to false",a.name),a.options.isTouchActive=!1),o&&(d.log("Setting tool %s's isTouchActive to false",o.name),o.options.isMultiTouchActive=!1)},TouchPinch:x.bind(void 0,"TouchPinch"),TouchRotate:x.bind(void 0,"TouchRotate"),DoubleTap:x.bind(void 0,"DoubleTap"),MultiTouch:function e(t,n){var a,o=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&e.configuration.touchPointers===t.configuration.touchPointers});1===t.configuration.touchPointers&&(a=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options.isTouchActive})),o&&(d.log("Setting tool %s's isMultiTouchActive to false",o.name),o.options.isMultiTouchActive=!1),a&&(d.log("Setting tool %s's isTouchActive to false",a.name),a.options.isTouchActive=!1)}};function w(e){return Array.isArray(e)?e={mouseButtonMask:e}:e!==Object(e)&&(e={mouseButtonMask:[e]}),e.hasOwnProperty("mouseButtonMask")||(e.mouseButtonMask=[]),Array.isArray(e.mouseButtonMask)||(e.mouseButtonMask=[e.mouseButtonMask]),e.mouseButtonMask=e.mouseButtonMask.filter(function(e){return"number"==typeof e&&0!==e}),e}function C(e,t){return e.concat(t).reduce(function(e,t){return -1===e.indexOf(t)&&e.push(t),e},[])}},"./store/setToolOptions.js":function(e,t,n){n.r(t),n.d(t,"setToolOptions",function(){return i}),n.d(t,"setToolOptionsForElement",function(){return r});var a=n(/*! ./getToolForElement.js */ "./store/getToolForElement.js"),o=n(/*! ./index.js */ "./store/index.js"),r=function e(t,n,o){var r=Object(a.default)(t,n);r&&r.mergeOptions(o)},i=function e(t,n){o.state.enabledElements.forEach(function(e){r(e,t,n)})}},"./synchronization/Synchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../util/convertToVector3.js */ "./util/convertToVector3.js"),r=n(/*! ../toolOptions.js */ "./toolOptions.js");function i(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})}t.default=function e(t,n){var l=a.default.cornerstone,s=this,u=[],d=[],c=!1,f={},h=n;function m(e,t){var n=!s.enabled,a=!u.length||!d.length;!n&&!a&&(c=!0,d.forEach(function(n){var a,o=d.indexOf(n);if(-1!==o){var r=f.imageIds.targetElements[o],i=u.indexOf(e);if(-1!==i){var l=f.imageIds.sourceElements[i];l===r?a=0:void 0!==f.distances[l]&&(a=f.distances[l][r]),h(s,e,n,t,a)}}}),c=!1)}function g(e){var t=e.detail;!0!==c&&m(e.currentTarget,t)}function v(e){var t=e.detail.element;s.remove(t),Object(r.clearToolOptionsByElement)(t)}this.enabled=!0,this.setHandler=function(e){h=e},this.getHandler=function(){return h},this.getDistances=function(){u.length&&d.length&&(f.distances={},f.imageIds={sourceElements:[],targetElements:[]},u.forEach(function(e){var t=l.getEnabledElement(e);if(t&&t.image){var n=t.image.imageId,a=l.metaData.get("imagePlaneModule",n);if(a&&a.imagePositionPatient){var r=Object(o.default)(a.imagePositionPatient);!f.hasOwnProperty(t)&&(f.distances[n]={},f.imageIds.sourceElements.push(n),d.forEach(function(t){var a=l.getEnabledElement(t);if(a&&a.image){var i=a.image.imageId;if(f.imageIds.targetElements.push(i),!(e===t||n===i||f.distances[n].hasOwnProperty(i))){var s=l.metaData.get("imagePlaneModule",i);if(s&&s.imagePositionPatient){var u=Object(o.default)(s.imagePositionPatient);f.distances[n][i]=u.clone().sub(r)}}}}),Object.keys(f.distances[n]).length||delete f.distances[n])}}}))},this.addSource=function(e){-1===u.indexOf(e)&&(u.push(e),t.split(" ").forEach(function(t){e.addEventListener(t,g)}),s.getDistances(),s.updateDisableHandlers())},this.addTarget=function(e){-1===d.indexOf(e)&&(d.push(e),s.getDistances(),h(s,e,e,0),s.updateDisableHandlers())},this.add=function(e){s.addSource(e),s.addTarget(e)},this.removeSource=function(e){var n=u.indexOf(e);-1!==n&&(u.splice(n,1),t.split(" ").forEach(function(t){e.removeEventListener(t,g)}),s.getDistances(),m(e),s.updateDisableHandlers())},this.removeTarget=function(e){var t=d.indexOf(e);-1!==t&&(d.splice(t,1),s.getDistances(),h(s,e,e,0),s.updateDisableHandlers())},this.remove=function(e){s.removeTarget(e),s.removeSource(e)},this.getSourceElements=function(){return u},this.getTargetElements=function(){return d},this.displayImage=function(e,t,n){c=!0,l.displayImage(e,t,n),c=!1},this.setViewport=function(e,t){c=!0,l.setViewport(e,t),c=!1},this.updateDisableHandlers=function(){i(u.concat(d)).forEach(function(e){e.removeEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,v),e.addEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,v)})},this.destroy=function(){i(u.concat(d)).forEach(function(e){s.remove(e)})}}},"./synchronization/panZoomSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n){if(n!==t){var o=a.default.cornerstone,r=o.getViewport(t),i=o.getViewport(n);(i.scale!==r.scale||i.translation.x!==r.translation.x||i.translation.y!==r.translation.y)&&(i.scale=r.scale,i.translation.x=r.translation.x,i.translation.y=r.translation.y,e.setViewport(n,i))}}},"./synchronization/stackImageIndexSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),i=n(/*! ../util/clip.js */ "./util/clip.js");t.default=function(e,t,n){if(n!==t){var l,s=a.default.cornerstone,u=Object(o.getToolState)(t,"stack").data[0],d=Object(o.getToolState)(n,"stack").data[0],c=u.currentImageIdIndex;if((c=Object(i.default)(c,0,d.imageIds.length-1))!==d.currentImageIdIndex){var f=r.default.getStartLoadHandler(n),h=r.default.getEndLoadHandler(n),m=r.default.getErrorLoadingHandler(n);f&&f(n),(l=!0===d.preventCache?s.loadImage(d.imageIds[c]):s.loadAndCacheImage(d.imageIds[c])).then(function(t){var a=s.getViewport(n);d.currentImageIdIndex=c,e.displayImage(n,t,a),h&&h(n,t)},function(e){var t=d.imageIds[c];m&&m(n,t,e)})}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),i=n(/*! ../util/convertToVector3.js */ "./util/convertToVector3.js");t.default=function(e,t,n,l,s){if(n!==t){var u,d=a.default.cornerstone,c=Object(o.getToolState)(t,"stack").data[0],f=c.imageIds[c.currentImageIdIndex],h=d.metaData.get("imagePlaneModule",f);if(void 0!==h&&void 0!==h.imagePositionPatient){var m=Object(i.default)(h.imagePositionPatient),g=Object(o.getToolState)(n,"stack").data[0],v=Number.MAX_VALUE,$=-1;if(s){var p=m.clone().add(s);if(g.imageIds.forEach(function(e,t){var n=d.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient),o=p.distanceToSquared(a);o<v&&(v=o,$=t)}}),$!==g.currentImageIdIndex&&-1!==$){var _=r.default.getStartLoadHandler(n),y=r.default.getEndLoadHandler(n),x=r.default.getErrorLoadingHandler(n);g.currentImageIdIndex=$;var T=g.imageIds[$];_&&_(n),(u=!0===g.preventCache?d.loadImage(T):d.loadAndCacheImage(T)).then(function(t){var a=d.getViewport(n);g.currentImageIdIndex===$&&(e.displayImage(n,t,a),y&&y(n,t))},function(e){var t=g.imageIds[$];x&&x(n,t,e)})}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),i=n(/*! ../util/convertToVector3.js */ "./util/convertToVector3.js");t.default=function(e,t,n){if(n!==t){var l,s=a.default.cornerstone,u=Object(o.getToolState)(t,"stack").data[0],d=u.imageIds[u.currentImageIdIndex],c=s.metaData.get("imagePlaneModule",d);if(void 0!==c&&void 0!==c.imagePositionPatient){var f=Object(i.default)(c.imagePositionPatient),h=Object(o.getToolState)(n,"stack").data[0],m=Number.MAX_VALUE,g=-1;if(h.imageIds.forEach(function(e,t){var n=s.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient).distanceToSquared(f);a<m&&(m=a,g=t)}}),g!==h.currentImageIdIndex){var v=r.default.getStartLoadHandler(n),$=r.default.getEndLoadHandler(n),p=r.default.getErrorLoadingHandler(n);h.currentImageIdIndex=g;var _=h.imageIds[g];v&&v(n),-1!==g&&(l=!0===h.preventCache?s.loadImage(_):s.loadAndCacheImage(_)).then(function(t){var a=s.getViewport(n);h.currentImageIdIndex===g&&(e.displayImage(n,t,a),$&&$(n,t))},function(e){var t=h.imageIds[g];p&&p(n,t,e)})}}}}},"./synchronization/stackScrollSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),i=n(/*! ../util/clip.js */ "./util/clip.js");t.default=function(e,t,n,l){if(t!==n&&l&&l.direction){var s,u=a.default.cornerstone,d=Object(o.getToolState)(n,"stack").data[0],c=d.currentImageIdIndex+l.direction;if(c=Object(i.default)(c,0,d.imageIds.length-1),d.currentImageIdIndex!==c){var f=r.default.getStartLoadHandler(n),h=r.default.getEndLoadHandler(n),m=r.default.getErrorLoadingHandler(n);d.currentImageIdIndex=c;var g=d.imageIds[c];f&&f(n),(s=!0===d.preventCache?u.loadImage(g):u.loadAndCacheImage(g)).then(function(t){var a=u.getViewport(n);d.currentImageIdIndex===c&&(e.displayImage(n,t,a),h&&h(n,t))},function(e){var t=d.imageIds[c];m&&m(n,t,e)})}}}},"./synchronization/updateImageSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n){n!==t&&a.default.cornerstone.updateImage(n)}},"./synchronization/wwwcSynchronizer.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n){if(n!==t){var o=a.default.cornerstone,r=o.getViewport(t),i=o.getViewport(n);(i.voi.windowWidth!==r.voi.windowWidth||i.voi.windowCenter!==r.voi.windowCenter||i.invert!==r.invert)&&(i.voi.windowWidth=r.voi.windowWidth,i.voi.windowCenter=r.voi.windowCenter,i.invert=r.invert,e.setViewport(n,i))}}},"./thirdParty/register.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n(/*! ./registerModule.js */ "./thirdParty/registerModule.js"),i=n(/*! ./registerMixin.js */ "./thirdParty/registerMixin.js"),l=n(/*! ./registerItem.js */ "./thirdParty/registerItem.js"),s=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("thirdParty:register");t.default=function(e,t,n){var a,u,d,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(a=e,u=t,d=n,a?u?"object"===o()(d)||"function"==typeof d||(s.warn("The %s is a %s, it should be an Object or a function.",d,o()(d)),!1):(s.warn("The %s must have a name in order to register.",a),!1):(s.warn("The type must be given in order to register."),!1))switch(e){case"module":Object(r.default)(t,n,c);break;case"mixin":Object(i.default)(t,n,c);break;default:Object(l.default)(e,t,n,c)}}},"./thirdParty/registerItem.js":function(e,t,n){n.r(t);var a=n(/*! ../lib.js */ "./lib.js"),o=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("thirdParty:registerType");t.default=function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l="".concat(e,"/").concat(t),s=(r=l,void 0!==a.lib[r]);if(s&&!i){o.warn("%s is already registered",l);return}s&&o.warn("Overwriting %s",l),a.lib[l]=n}},"./thirdParty/registerMixin.js":function(e,t,n){n.r(t);var a=n(/*! ../lib.js */ "./lib.js"),o=n(/*! ../mixins/index.js */ "./mixins/index.js"),r=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("thirdParty:registerMixin");t.default=function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=(n=e,void 0!==o.default[n]);if(l&&!i){r.warn("mixins/%s is already registered",e);return}l&&r.warn("Overwriting mixins/%s",e),o.default[e]=t,a.lib["mixins/".concat(e)]=o.default[e]}},"./thirdParty/registerModule.js":function(e,t,n){n.r(t);var a=n(/*! ../store/index.js */ "./store/index.js"),o=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("thirdParty:registerModule");t.default=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=(n=e,void 0!==a.modules[n]);if(i&&!r){o.warn("A module with the name %s is already registered",e);return}i&&o.warn("Overwriting module %s",e),a.modules[e]=t}},"./thirdParty/registerSome.js":function(e,t,n){n.r(t);var a=n(/*! ./register.js */ "./thirdParty/register.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach(function(e){var n=e.type,o=e.name,r=e.item;Object(a.default)(n,o,r,t)})}},"./toolOptions.js":function(e,t,n){n.r(t),n.d(t,"getToolOptions",function(){return o}),n.d(t,"setToolOptions",function(){return r}),n.d(t,"clearToolOptions",function(){return i}),n.d(t,"clearToolOptionsByToolType",function(){return l}),n.d(t,"clearToolOptionsByElement",function(){return s});var a={};function o(e,t){if(!a[e])return{};var n=a[e].find(function(e){return e.element===t});return n?n.options:{}}function r(e,t,n){if(!a[e]){a[e]=[{element:t,options:n}];return}var o=a[e].findIndex(function(e){return e.element===t});if(-1===o)a[e].push({element:t,options:n});else{var r=a[e][o].options||{};a[e][o].options=Object.assign(r,n)}}function i(e,t){var n=a[e];n&&(a[e]=n.filter(function(e){return e.element!==t}))}function l(e){delete a[e]}function s(e){for(var t in a)a[t]=a[t].filter(function(t){return t.element!==e})}},"./tools/CrosshairsTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return b});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),v=n(/*! ./../externalModules.js */ "./externalModules.js"),$=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),p=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),_=n(/*! ../util/pointProjector.js */ "./util/pointProjector.js"),y=n(/*! ../util/convertToVector3.js */ "./util/convertToVector3.js"),x=n(/*! ../toolOptions.js */ "./toolOptions.js"),T=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.crosshairsCursor};return(e=s()(this,d()(t).call(this,n,a))).mouseDownCallback=e._chooseLocation.bind(f()(e)),e.mouseDragCallback=e._chooseLocation.bind(f()(e)),e.touchDragCallback=e._chooseLocation.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_chooseLocation",value:function e(t){var n=t.detail,a=n.element;t.stopImmediatePropagation();var o=Object(p.getToolState)(a,this.name);if(o){var r=a,i=v.default.cornerstone.getEnabledElement(r).image.imageId,l=v.default.cornerstone.metaData.get("imagePlaneModule",i);if(l){var s=n.currentPoints.image,u=Object(_.imagePointToPatientPoint)(s,l);o.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,a=Object(p.getToolState)(e,"stack");if(void 0!==a){var o=a.data[0];if(o.imageIds.forEach(function(e,a){var o=v.default.cornerstone.metaData.get("imagePlaneModule",e);if(o&&o.imagePositionPatient&&o.rowCosines&&o.columnCosines){var r=Object(y.default)(o.imagePositionPatient),i=Object(y.default)(o.rowCosines),l=Object(y.default)(o.columnCosines).clone().cross(i.clone()),s=Math.abs(l.clone().dot(r)-l.clone().dot(u));s<t&&(t=s,n=a)}}),n!==o.currentImageIdIndex&&-1!==n&&void 0!==o.imageIds[n]){var i,l=$.default.getStartLoadHandler(e),s=$.default.getEndLoadHandler(e),d=$.default.getErrorLoadingHandler(e);l&&l(e),(i=!0===o.preventCache?v.default.cornerstone.loadImage(o.imageIds[n]):v.default.cornerstone.loadAndCacheImage(o.imageIds[n])).then(function(t){var a=v.default.cornerstone.getViewport(e);o.currentImageIdIndex=n,v.default.cornerstone.displayImage(e,t,a),s&&s(e,t)},function(t){var a=o.imageIds[n];d&&d(e,a,t)})}}}})}}}},{key:"activeCallback",value:function e(t,n){var a=n.mouseButtonMask,o=n.synchronizationContext;Object(x.setToolOptions)(this.name,t,{mouseButtonMask:a}),Object(p.clearToolState)(t,this.name),Object(p.addToolState)(t,this.name,{synchronizationContext:o})}}]),t}(g.default)},"./tools/DoubleTapFitToWindowTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return m});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ../externalModules.js */ "./externalModules.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),s()(this,d()(t).call(this,e,{name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]}))}return f()(t,e),i()(t,[{key:"doubleTapCallback",value:function e(t){var n=t.detail;h.default.cornerstone.fitToWindow(n.element)}}]),t}(n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js").default)},"./tools/DragProbeTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return w});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../externalModules.js */ "./externalModules.js"),v=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),$=n(/*! ../stateManagement/textStyle.js */ "./stateManagement/textStyle.js"),p=n(/*! ../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),_=n(/*! ../util/getRGBPixels.js */ "./util/getRGBPixels.js"),y=n(/*! ../util/calculateSUV.js */ "./util/calculateSUV.js"),x=n(/*! ../drawing/index.js */ "./drawing/index.js"),T=n(/*! ../drawing/drawTextBox.js */ "./drawing/drawTextBox.js"),b=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"DragProbe",strategies:{default:C,minimal:E},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:b.probeCursor};return(e=s()(this,d()(t).call(this,n,a))).touchDragCallback=e._movingEventCallback.bind(f()(e)),e.touchEndCallback=e._endMovingEventCallback.bind(f()(e)),e.mouseDragCallback=e._movingEventCallback.bind(f()(e)),e.mouseUpCallback=e._endMovingEventCallback.bind(f()(e)),e.dragEventData={},e}return m()(t,e),i()(t,[{key:"_movingEventCallback",value:function e(t){var n=t.detail,a=n.element;this.dragEventData=n,g.default.cornerstone.updateImage(a)}},{key:"_endMovingEventCallback",value:function e(t){var n=t.detail.element;this.dragEventData={},g.default.cornerstone.updateImage(n)}},{key:"renderToolData",value:function e(t){this.dragEventData.currentPoints&&t&&t.detail&&Boolean(Object.keys(this.dragEventData.currentPoints).length)&&(t.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(t))}}]),t}(v.default),C=function e(t,n){var a=g.default.cornerstone,o=t.detail,r=o.element,i=o.image,l=o.currentPoints,s=o.canvasContext,u=Object(x.getNewContext)(s.canvas),d=p.default.getActiveColor(),c=$.default.getFontSize(),f=Math.round(l.image.x),h=Math.round(l.image.y);!(f<0)&&!(h<0)&&!(f>=i.columns)&&!(h>=i.rows)&&Object(x.draw)(u,function(e){Object(x.setShadow)(e,n);var t,o,s="".concat(f,", ").concat(h);if(i.color)t=Object(_.default)(r,f,h,1,1),o="R: ".concat(t[0]," G: ").concat(t[1]," B: ").concat(t[2]," A: ").concat(t[3]);else{var u=(t=a.getStoredPixels(r,f,h,1,1))[0],m=u*i.slope+i.intercept,g=Object(y.default)(i,u);o="SP: ".concat(u," MO: ").concat(parseFloat(m.toFixed(3))),g&&(o+=" SUV: ".concat(parseFloat(g.toFixed(3))))}var v={x:l.canvas.x+5,y:l.canvas.y-5};Object(T.default)(e,o,v.x,v.y+c+5,d),Object(T.default)(e,s,v.x,v.y,d)})},E=function e(t,n){var a=g.default.cornerstone,o=t.detail,r=o.element,i=o.image,l=o.currentPoints,s=o.canvasContext,u=o.isTouchEvent,d=Object(x.getNewContext)(s.canvas),c=p.default.getActiveColor(),f=l.page.y-$.default.getFontSize()/2;u&&(f=l.page.y-4*$.default.getFontSize());var h=a.pageToPixel(r,l.page.x,f);!(h.x<0)&&!(h.y<0)&&!(h.x>=i.columns)&&!(h.y>=i.rows)&&Object(x.draw)(d,function(e){Object(x.setShadow)(e,n);var t,o=a.metaData.get("generalSeriesModule",i.imageId),l=o&&o.modality,s="";if(i.color)t=Object(_.default)(r,h.x,h.y,1,1),s="R: ".concat(t[0]," G: ").concat(t[1]," B: ").concat(t[2]);else{var d=(t=a.getStoredPixels(r,h.x,h.y,1,1))[0],f=parseFloat((d*i.slope+i.intercept).toFixed(2));if("CT"===l)s+="HU: ".concat(f);else if("PT"===l){s+=f;var m=Object(y.default)(i,d);m&&(s+=" SUV: ".concat(parseFloat(m.toFixed(2))))}else s+=f}var g=a.pixelToCanvas(r,h),v={x:12,y:-($.default.getFontSize()+10)/2},p=Object(T.textBoxWidth)(e,s,5);u&&(v={x:-p/2,y:-$.default.getFontSize()-10-12}),Object(x.drawCircle)(e,r,g,6,{color:c},"canvas"),Object(T.default)(e,s,g.x+v.x,g.y+v.y,c)})}},"./tools/EraserTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return y});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../externalModules.js */ "./externalModules.js"),v=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),$=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),p=n(/*! ../store/index.js */ "./store/index.js"),_=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_.eraserCursor};return(e=s()(this,d()(t).call(this,n,a))).preMouseDownCallback=e._deleteAllNearbyTools.bind(f()(e)),e.preTouchStartCallback=e._deleteAllNearbyTools.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_deleteAllNearbyTools",value:function e(t){var n=t.detail.currentPoints.canvas,a=t.detail.element;return p.state.tools.forEach(function(e){var t=Object($.getToolState)(a,e.name);t&&t.data.forEach(function(t){"function"==typeof e.pointNearTool&&e.pointNearTool(a,t,n)&&(Object($.removeToolState)(a,e.name,t),g.default.cornerstone.updateImage(a))})}),!0}}]),t}(v.default)},"./tools/FreehandSculpterMouseTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return S});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../events.js */ "./events.js"),v=n(/*! ../externalModules.js */ "./externalModules.js"),$=n(/*! ../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=n(/*! ../drawing/drawHandles.js */ "./drawing/drawHandles.js"),_=n(/*! ../store/index.js */ "./store/index.js"),y=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),x=n(/*! ../util/clip.js */ "./util/clip.js"),T=n(/*! ../store/getToolForElement.js */ "./store/getToolForElement.js"),b=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),w=n(/*! ../store/setToolCursor.js */ "./store/setToolCursor.js"),C=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),E=n(/*! ../util/freehand/index.js */ "./util/freehand/index.js"),j=E.default.FreehandHandleData,S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"FreehandSculpterMouse",referencedToolName:"FreehandMouse",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:$.default.getActiveColor(),hoverColor:$.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2},svgCursor:C.freehandSculpterMouseCursor};return(e=s()(this,d()(t).call(this,n,a))).updateOnMouseMove=!0,e.isMultiPartTool=!0,e.referencedToolName=a.referencedToolName,e._active=!1,e.activeMouseUpCallback=e.activeMouseUpCallback.bind(f()(e)),e.activeTouchEndCallback=e.activeTouchEndCallback.bind(f()(e)),e.activeMouseDragCallback=e.activeMouseDragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderToolData",value:function e(t){var n=t.detail;if(null===this.configuration.currentTool)return!1;var a=n.element,o=this.configuration;if(!Object(y.getToolState)(a,this.referencedToolName).data[o.currentTool])return!1;if(this._active){var r=n.canvasContext.canvas.getContext("2d"),i={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(p.default)(r,n,this.configuration.mouseLocation.handles,i)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(t)}},{key:"doubleClickCallback",value:function e(t){var n=t.detail;this._selectFreehandTool(n),v.default.cornerstone.updateImage(n.element)}},{key:"doubleTapCallback",value:function e(t){var n=t.detail;this._selectFreehandTool(n),v.default.cornerstone.updateImage(n.element)}},{key:"preTouchStartCallback",value:function e(t){return this._initialiseSculpting(t),!0}},{key:"preMouseDownCallback",value:function e(t){if(this.options.mouseButtonMask.includes(t.detail.buttons))return this._initialiseSculpting(t),!0}},{key:"activeMouseDragCallback",value:function e(t){var n=this.configuration;if(this._active){var a=t.detail,o=Object(y.getToolState)(a.element,this.referencedToolName);if(o){var r=o.data[n.currentTool].handles.points;this._getMouseLocation(a),this._sculpt(a,r),v.default.cornerstone.updateImage(a.element)}}}},{key:"activeMouseUpCallback",value:function e(t){this._activeEnd(t)}},{key:"activeTouchEndCallback",value:function e(t){this._activeEnd(t),this._deselectAllTools(t),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function e(t){var n,a=t.detail,o=a.element,r=this.configuration;this._active=!1,_.state.isMultiPartToolActive=!1,this._getMouseLocation(a),this._invalidateToolData(a),r.mouseUpRender=!0,this._deactivateSculpt(o),v.default.cornerstone.updateImage(a.element),(n=t).stopImmediatePropagation(),n.stopPropagation(),n.preventDefault()}},{key:"_renderHoverCursor",value:function e(t){var n,a=t.detail,o=a.element,r=a.canvasContext.canvas.getContext("2d"),i=Object(y.getToolState)(o,this.referencedToolName).data[this.configuration.currentTool];this._recentTouchEnd=!1,this.configuration.mouseUpRender?(n=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):n=_.state.mousePositionImage;var l=Object(T.default)(o,this.referencedToolName).distanceFromPointCanvas(o,i,n);if(this.configuration.mouseLocation.handles.start.x=n.x,this.configuration.mouseLocation.handles.start.y=n.y,this.configuration.limitRadiusOutsideRegion){var s=l;l=this._limitCursorRadiusCanvas(a,l),s>this.configuration.hoverCursorFadeDistance*l&&(r.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var u={fill:null,color:this.configuration.hoverColor,handleRadius:l};Object(p.default)(r,a,this.configuration.mouseLocation.handles,u),this.configuration.limitRadiusOutsideRegion&&(r.globalAlpha=1)}},{key:"newImageCallback",value:function e(t){this._deselectAllTools(t)}},{key:"enabledCallback",value:function e(t){this._deselectAllTools(t)}},{key:"passiveCallback",value:function e(t){this._deselectAllTools(t)}},{key:"disabledCallback",value:function e(t){this._deselectAllTools(t)}},{key:"_selectFreehandTool",value:function e(t){var n=this.configuration,a=t.element,o=this._getClosestFreehandToolOnElement(a,t);void 0!==o&&(n.currentTool=o,Object(w.hideToolCursor)(a))}},{key:"_activateFreehandTool",value:function e(t,n){var a=Object(y.getToolState)(t,this.referencedToolName).data;this.configuration.currentTool=n;for(var o=0;o<a.length;o++)o===n?a[o].active=!0:a[o].active=!1}},{key:"_initialiseSculpting",value:function e(t){var n=t.detail,a=this.configuration,o=n.element;(null!==a.currentTool||(this._selectFreehandTool(n),null!==a.currentTool))&&(this._active=!0,_.state.isMultiPartToolActive=!0,this._configureToolSize(n),this._getMouseLocation(n),this._activateFreehandTool(o,a.currentTool),this._activateSculpt(o),v.default.cornerstone.updateImage(n.element))}},{key:"_sculpt",value:function e(t,n){var a=this.configuration;this._sculptData={element:t.element,image:t.image,mousePoint:t.currentPoints.image,points:n,toolSize:this._toolSizeImage,minSpacing:a.minSpacing,maxSpacing:Math.max(this._toolSizeImage,2*a.minSpacing)};var o=this._pushHandles();void 0!==o.first&&(this._insertNewHandles(o),this._consolidateHandles())}},{key:"_pushHandles",value:function e(){for(var t=this._sculptData,n=t.points,a=t.mousePoint,o=t.toolSize,r={},i=0;i<n.length;i++){var l=v.default.cornerstoneMath.point.distance(n[i],a);!(l>o)&&(this._pushOneHandle(i,l),void 0===r.first&&(r.first=i),r.last=i)}return r}},{key:"_pushOneHandle",value:function e(t,n){var a=this._sculptData,o=a.points,r=a.mousePoint,i=a.toolSize,l=a.image,s=o[t],u={x:(s.x-r.x)/n,y:(s.y-r.y)/n},d={x:r.x+i*u.x,y:r.y+i*u.y};Object(x.clipToBox)(d,l),s.x=d.x,s.y=d.y;var c=this.constructor._getPreviousHandleIndex(t,o.length);o[c].lines.pop(),o[c].lines.push(s)}},{key:"_insertNewHandles",value:function e(t){for(var n=this._findNewHandleIndicies(t),a=0,o=0;o<n.length;o++){var r=n[o]+1+a;this._insertHandleRadially(r),a++}}},{key:"_findNewHandleIndicies",value:function e(t){for(var n=this._sculptData,a=n.points,o=n.maxSpacing,r=[],i=t.first;i<=t.last;i++)this._checkSpacing(i,a,r,o);var l=this.constructor._getNextHandleIndex(t.last,a.length);if(l!==t.first){this._checkSpacing(l,a,r,o);var s=this.constructor._getPreviousHandleIndex(t.first,a.length);s!==l&&this._checkSpacing(s,a,r,o)}return r}},{key:"_checkSpacing",value:function e(t,n,a,o){var r=this.constructor._getNextHandleIndex(t,n.length);v.default.cornerstoneMath.point.distance(n[t],n[r])>o&&a.push(t)}},{key:"_insertHandleRadially",value:function e(t){var n=this._sculptData.points,a=t-1,o=this.constructor._getNextHandleIndexBeforeInsert(t,n.length),r=this._getInsertPosition(t,a,o),i=new j(r);n.splice(t,0,i),n[a].lines.pop(),n[a].lines.push(n[t]),E.default.addLine(n,t)}},{key:"_consolidateHandles",value:function e(){if(!(this._sculptData.points.length<=3)){var t=this._findCloseHandlePairs();this._mergeCloseHandles(t)}}},{key:"_findCloseHandlePairs",value:function e(){for(var t=this._sculptData,n=t.points,a=t.minSpacing,o=[],r=n.length,i=0;i<r;i++){var l=this.constructor._getNextHandleIndex(i,n.length);if(v.default.cornerstoneMath.point.distance(n[i],n[l])<a){var s=[i,l];o.push(s),0===i&&(r-=1),i++}}return o}},{key:"_mergeCloseHandles",value:function e(t){for(var n=0,a=0;a<t.length;a++){var o=this.constructor._getCorrectedPair(t[a],n);this._combineHandles(o),n++}var r=this._findCloseHandlePairs();r.length&&this._mergeCloseHandles(r)}},{key:"_combineHandles",value:function e(t){var n=this._sculptData,a=n.points,o=n.image,r={x:(a[t[0]].x+a[t[1]].x)/2,y:(a[t[0]].y+a[t[1]].y)/2};Object(x.clipToBox)(r,o),a[t[0]].x=r.x,a[t[0]].y=r.y;var i=this.constructor._getNextHandleIndex(t[1],a.length);a[t[0]].lines.pop(),a[t[0]].lines.push(a[i]),a.splice(t[1],1)}},{key:"_configureToolSize",value:function e(t){var n=t.element,a=this.configuration,o=a.currentTool,r=t.currentPoints.image,i=Object(y.getToolState)(n,this.referencedToolName).data[o],l=Object(T.default)(n,this.referencedToolName),s=l.distanceFromPoint(n,i,r),u=l.distanceFromPointCanvas(n,i,r);a.limitRadiusOutsideRegion&&(s=this._limitCursorRadiusImage(t,s),u=this._limitCursorRadiusCanvas(t,u)),this._toolSizeImage=s,this._toolSizeCanvas=u}},{key:"_getMouseLocation",value:function e(t){var n=this.configuration;n.mouseLocation.handles.start.x=t.currentPoints.image.x,n.mouseLocation.handles.start.y=t.currentPoints.image.y,Object(x.clipToBox)(n.mouseLocation.handles.start,t.image)}},{key:"_activateSculpt",value:function e(t){this._deactivateSculpt(t),t.addEventListener(g.default.MOUSE_UP,this.activeMouseUpCallback),t.addEventListener(g.default.MOUSE_CLICK,this.activeMouseUpCallback),t.addEventListener(g.default.MOUSE_DRAG,this.activeMouseDragCallback),t.addEventListener(g.default.TOUCH_END,this.activeTouchEndCallback),t.addEventListener(g.default.TOUCH_TAP,this.activeTouchEndCallback),t.addEventListener(g.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(t)}},{key:"_deactivateSculpt",value:function e(t){t.removeEventListener(g.default.MOUSE_UP,this.activeMouseUpCallback),t.removeEventListener(g.default.MOUSE_CLICK,this.activeMouseUpCallback),t.removeEventListener(g.default.MOUSE_DRAG,this.activeMouseDragCallback),t.removeEventListener(g.default.TOUCH_END,this.activeTouchEndCallback),t.removeEventListener(g.default.TOUCH_TAP,this.activeTouchEndCallback),t.removeEventListener(g.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(t)}},{key:"_invalidateToolData",value:function e(t){var n=this.configuration,a=t.element;Object(y.getToolState)(a,this.referencedToolName).data[n.currentTool].invalidated=!0}},{key:"_deselectAllTools",value:function e(t){var n=this.configuration,a=Object(y.getToolState)(this.element,this.referencedToolName);if(n.currentTool=null,a)for(var o=0;o<a.data.length;o++)a.data[o].active=!1;Object(w.setToolCursor)(this.element,this.svgCursor),v.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function e(t,n){return this._limitCursorRadius(t,n,!0)}},{key:"_limitCursorRadiusImage",value:function e(t,n){return this._limitCursorRadius(t,n,!1)}},{key:"_limitCursorRadius",value:function e(t,n){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.element,i=t.image,l=this.configuration,s=Object(y.getToolState)(r,this.referencedToolName).data[l.currentTool],u=1;if(o){var d=v.default.cornerstone.pixelToCanvas(r,{x:0,y:0}),c=v.default.cornerstone.pixelToCanvas(r,{x:i.width,y:i.height});u=(c.x-d.x)*(c.y-d.y)/(i.width*i.height)}return Math.min(n,Math.pow(s.area*u/Math.PI,.5))}},{key:"_getClosestFreehandToolOnElement",value:function e(t,n){var a=Object(T.default)(t,this.referencedToolName),o=Object(y.getToolState)(t,this.referencedToolName);if(o){for(var r=o.data,i=n.currentPoints.image,l={distance:1/0,toolIndex:null},s=0;s<r.length;s++){var u=a.distanceFromPoint(t,r[s],i);-1!==u&&u<l.distance&&(l.distance=u,l.toolIndex=s)}return l.toolIndex}}},{key:"_getInsertPosition",value:function e(t,n,a){var o,r=this._sculptData,i=r.points,l=r.toolSize,s=r.mousePoint,u=r.image,d={x:(i[n].x+i[a].x)/2,y:(i[n].y+i[a].y)/2},c=v.default.cornerstoneMath.point.distance(s,d);if(c<l){var f={x:(d.x-s.x)/c,y:(d.y-s.y)/c};o={x:s.x+l*f.x,y:s.y+l*f.y}}else o=d;return Object(x.clipToBox)(o,u),o}},{key:"minSpacing",get:function e(){return this.configuration.minSpacing},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=t}},{key:"maxSpacing",get:function e(){return this.configuration.maxSpacing},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=t}},{key:"showCursorOnHover",get:function e(){return this.configuration.showCursorOnHover},set:function e(t){if("boolean"!=typeof t)throw Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=t,v.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function e(){return this.configuration.limitRadiusOutsideRegion},set:function e(t){if("boolean"!=typeof t)throw Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=t,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function e(){return this.configuration.hoverCursorFadeAlpha},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");t=Math.max(Math.min(t,1),0),this.configuration.hoverCursorFadeAlpha=t,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function e(){return this.configuration.hoverCursorFadeDistance},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");t=Math.max(t,1),this.configuration.hoverCursorFadeDistance=t,v.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function e(t,n){var a=[t[0]-n,t[1]-n];return a[1]<0&&(a[1]=0),a}},{key:"_getNextHandleIndex",value:function e(t,n){return t===n-1?0:t+1}},{key:"_getPreviousHandleIndex",value:function e(t,n){return 0===t?n-1:t-1}},{key:"_getNextHandleIndexBeforeInsert",value:function e(t,n){return t===n?0:t}}]),t}(b.default)},"./tools/MagnifyTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return y});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../externalModules.js */ "./externalModules.js"),v=n(/*! ../drawing/index.js */ "./drawing/index.js"),$=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),p=n(/*! ../store/setToolCursor.js */ "./store/setToolCursor.js"),_=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:_.magnifyCursor};return(e=s()(this,d()(t).call(this,n,a))).zoomCanvas=void 0,e.zoomElement=void 0,e.activeCallback=e._createMagnificationCanvas.bind(f()(e)),e.enabledCallback=e._createMagnificationCanvas.bind(f()(e)),e.disabledCallback=e._destroyMagnificationCanvas.bind(f()(e)),e.postTouchStartCallback=e._addMagnifyingGlass.bind(f()(e)),e.touchDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.touchEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.touchDragEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.postMouseDownCallback=e._addMagnifyingGlass.bind(f()(e)),e.mouseDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.mouseUpCallback=e._removeMagnifyingGlass.bind(f()(e)),e.mouseClickCallback=e._removeMagnifyingGlass.bind(f()(e)),e.newImageCallback=e._drawMagnificationTool.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_addMagnifyingGlass",value:function e(t){var n=this;this._removeZoomElement(),this._drawZoomedElement(t),window.requestAnimationFrame(function(){return n._drawMagnificationTool(t)}),Object(p.hideToolCursor)(t.detail.element),t.preventDefault(),t.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function e(t){this._drawMagnificationTool(t),t.preventDefault(),t.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function e(t){var n=t.detail.element;Object(p.setToolCursor)(this.element,this.svgCursor),n.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function e(t){var n=t.detail.element,a=n.querySelector(".magnifyTool");if(a||this._createMagnificationCanvas(n),void 0!==this.zoomCanvas){var o=n.querySelector("canvas:not(.magnifyTool)"),r=Object(v.getNewContext)(a),i=g.default.cornerstone.pixelToCanvas(t.detail.element,t.detail.currentPoints.image),l=Math.min(this.configuration.magnifySize,o.width,o.height),s=this.configuration.magnificationLevel;a.width=l,a.height=l,i.x=Math.max(i.x,.5*l/s),i.x=Math.min(i.x,o.width-.5*l/s),i.y=Math.max(i.y,.5*l/s),i.y=Math.min(i.y,o.height-.5*l/s);var u={x:i.x*s-.5*l,y:i.y*s-.5*l};u.x=Math.max(u.x,0),u.y=Math.max(u.y,0),r.drawImage(this.zoomCanvas,u.x,u.y,l,l,0,0,l,l);var d=t.detail.isTouchEvent?120:0,c={top:Math.max(i.y-.5*l-d,0),left:Math.max(i.x-.5*l,0)},f=a.getBoundingClientRect();c.top=Math.min(c.top,o.height-f.height),c.left=Math.min(c.left,o.width-f.width),a.style.top="".concat(c.top,"px"),a.style.left="".concat(c.left,"px"),a.style.display="block"}}},{key:"_drawZoomedElement",value:function e(t){var n=t.detail.element,a=t.detail.enabledElement;void 0===a&&(a=g.default.cornerstone.getEnabledElement(n));var o=this.configuration.magnificationLevel,r=a.canvas,i=a.image;this.zoomElement||(this.zoomElement=document.createElement("div"),this.zoomElement.width=r.width*o,this.zoomElement.height=r.height*o,g.default.cornerstone.enable(this.zoomElement,a.options));var l=g.default.cornerstone.getEnabledElement(this.zoomElement),s=g.default.cornerstone.getViewport(a.element);this.zoomCanvas=l.canvas,this.zoomCanvas.width=r.width*o,this.zoomCanvas.height=r.height*o,l.viewport=Object.assign({},s),s.scale*=o,g.default.cornerstone.displayImage(this.zoomElement,i),g.default.cornerstone.setViewport(this.zoomElement,s)}},{key:"_removeZoomElement",value:function e(){void 0!==this.zoomElement&&(g.default.cornerstone.disable(this.zoomCanvas),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function e(t){if(null===t.querySelector(".magnifyTool")){var n=document.createElement("canvas");n.classList.add("magnifyTool"),n.width=this.configuration.magnifySize,n.height=this.configuration.magnifySize,n.style.position="absolute",n.style.display="none",t.appendChild(n)}}},{key:"_destroyMagnificationCanvas",value:function e(t){var n=t.querySelector(".magnifyTool");n&&t.removeChild(n)}}]),t}($.default)},"./tools/PanMultiTouchTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return v});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../externalModules.js */ "./externalModules.js"),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),(e=s()(this,d()(t).call(this,n,{name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}}))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function e(t){var n=t.detail,a=n.element,o=n.viewport;if(n.numPointers===this.configuration.touchPointers){var r=this._getTranslation(n);this._applyTranslation(o,r),g.default.cornerstone.setViewport(a,o)}}},{key:"_getTranslation",value:function e(t){var n=t.viewport,a=t.image,o=t.deltaPoints,r=n.scale,i=n.scale;return a.rowPixelSpacing<a.columnPixelSpacing?r*=a.columnPixelSpacing/a.rowPixelSpacing:a.columnPixelSpacing<a.rowPixelSpacing&&(i*=a.rowPixelSpacing/a.columnPixelSpacing),{x:o.page.x/r,y:o.page.y/i}}},{key:"_applyTranslation",value:function e(t,n){t.translation.x+=n.x,t.translation.y+=n.y}}]),t}(n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js").default)},"./tools/PanTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return p});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ./../externalModules.js */ "./externalModules.js"),v=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),$=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:$.panCursor};return(e=s()(this,d()(t).call(this,n,a))).touchDragCallback=e._dragCallback.bind(f()(e)),e.mouseDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function e(t){var n=t.detail,a=n.element,o=n.viewport,r=this._getTranslation(n);this._applyTranslation(o,r),g.default.cornerstone.setViewport(a,o)}},{key:"_getTranslation",value:function e(t){var n=t.viewport,a=t.image,o=t.deltaPoints,r=n.scale,i=n.scale;return a.rowPixelSpacing<a.columnPixelSpacing?r*=a.columnPixelSpacing/a.rowPixelSpacing:a.columnPixelSpacing<a.rowPixelSpacing&&(i*=a.rowPixelSpacing/a.columnPixelSpacing),{x:o.page.x/r,y:o.page.y/i}}},{key:"_applyTranslation",value:function e(t,n){t.translation.x+=n.x,t.translation.y+=n.y}}]),t}(v.default)},"./tools/ReferenceLinesTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return w});var a=n(/*! @babel/runtime/regenerator */ "../node_modules/@babel/runtime/regenerator/index.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/asyncToGenerator */ "../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),g=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),v=n.n(g),$=n(/*! ./../externalModules.js */ "./externalModules.js"),p=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),_=n(/*! ../drawing/index.js */ "./drawing/index.js"),y=n(/*! ./referenceLines/renderActiveReferenceLine.js */ "./tools/referenceLines/renderActiveReferenceLine.js"),x=n(/*! ../util/wait.js */ "./util/wait.js"),T=n(/*! ../util/logger.js */ "./util/logger.js"),b=Object(T.getLogger)("tools:ReferenceLinesTool"),w=function(e){var t;function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,n);var a={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:y.default}};return(e=f()(this,m()(n).call(this,t,a))).renderer=null,e.synchronizationContext=null,e}return v()(n,e),d()(n,[{key:"enabledCallback",value:(t=i()(o.a.mark(function e(t){var n,a,r,i,l=arguments;return o.a.wrap(function e(o){for(;;)switch(o.prev=o.next){case 0:return a=(n=l.length>1&&void 0!==l[1]?l[1]:{}).synchronizationContext,r=this.configuration.renderer,o.next=4,Object(x.waitForEnabledElementImageToLoad)(t);case 4:if(!(!(i=o.sent)||!r||!a)){o.next=8;break}return b.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),o.abrupt("return");case 8:this.renderer=r,this.synchronizationContext=a,this.forceImageUpdate(t);case 11:case"end":return o.stop()}},e,this)})),function e(n){return t.apply(this,arguments)})},{key:"disabledCallback",value:function e(t){this.forceImageUpdate(t)}},{key:"forceImageUpdate",value:function e(t){$.default.cornerstone.getEnabledElement(t).image&&$.default.cornerstone.updateImage(t)}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail;if(this.renderer&&this.synchronizationContext){var o=this.synchronizationContext.getSourceElements(),r=Object(_.getNewContext)(a.canvasContext.canvas);$.default.cornerstone.setToPixelCoordinateSystem(a.enabledElement,r),o.forEach(function(e){e!==t.currentTarget&&n.renderer(r,a,t.currentTarget,e)})}}}]),n}(p.default)},"./tools/RotateTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return $});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../externalModules.js */ "./externalModules.js"),m=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),g=n(/*! ../util/angleBetweenPoints.js */ "./util/angleBetweenPoints.js"),v=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),$=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Rotate",strategies:{default:p,horizontal:_,vertical:y},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:v.rotateCursor};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function e(t){this.dragCallback(t)}},{key:"mouseDragCallback",value:function e(t){this.dragCallback(t)}},{key:"postMouseDownCallback",value:function e(t){this.initialRotation=t.detail.viewport.rotation}},{key:"dragCallback",value:function e(t){t.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(t,this.configuration),h.default.cornerstone.setViewport(t.detail.element,t.detail.viewport)}}]),t}(m.default),p=function e(t){var n=t.detail,a=n.element,o=n.viewport,r=o.initialRotation,i=a.getBoundingClientRect(a),l=a.clientWidth,s=a.clientHeight,u={x:n.startPoints.client.x,y:n.startPoints.client.y},d=o.scale,c=o.translation,f={x:i.left+l/2+c.x*d,y:i.top+s/2+c.y*d},h={x:n.currentPoints.client.x,y:n.currentPoints.client.y},m=Object(g.default)(f,u,h);m.direction<0&&(m.angle=-m.angle),o.rotation=r+m.angle},_=function e(t){var n=t.detail,a=n.viewport,o=n.deltaPoints;a.rotation+=o.page.x/a.scale},y=function e(t){var n=t.detail,a=n.viewport,o=n.deltaPoints;a.rotation+=o.page.y/a.scale}},"./tools/RotateTouchTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return m});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../externalModules.js */ "./externalModules.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),s()(this,d()(t).call(this,e,{name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]}))}return f()(t,e),i()(t,[{key:"touchRotateCallback",value:function e(t){var n=t.detail,a=n.element,o=n.viewport,r=n.rotation;o.rotation+=r,h.default.cornerstone.setViewport(a,o)}}]),t}(n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js").default)},"./tools/ScaleOverlayTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return _});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ../externalModules.js */ "./externalModules.js"),m=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),g=n(/*! ../drawing/index.js */ "./drawing/index.js"),v=n(/*! ../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),$=n(/*! ../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=Object(n(/*! ../util/logger.js */ "./util/logger.js").getLogger)("tools:ScaleOverlayTool"),_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),s()(this,d()(t).call(this,e,{name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]}))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function e(t){this.forceImageUpdate(t)}},{key:"disabledCallback",value:function e(t){this.forceImageUpdate(t)}},{key:"forceImageUpdate",value:function e(t){h.default.cornerstone.getEnabledElement(t).image&&h.default.cornerstone.updateImage(t)}},{key:"renderToolData",value:function e(t){var n=t.detail,a=Object(g.getNewContext)(n.canvasContext.canvas),o=n.image,r=n.viewport,i=n.element,l=o.rowPixelSpacing,s=o.columnPixelSpacing,u=h.default.cornerstone.metaData.get("imagePlaneModule",o.imageId);if(u&&(l=u.rowPixelSpacing||u.rowImagePixelSpacing,s=u.columnPixelSpacing||u.colImagePixelSpacing),!l||!s){p.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"));return}var d={width:a.canvas.width,height:a.canvas.height},c=10/l*r.scale,f=10/s*r.scale,m=y(d,.25,.05),_=y(d,.05,.15);if(d.width&&d.height&&m&&_){var b=$.default.getToolColor(),w=v.default.getToolWidth(),C=Object.assign({},{hscaleBounds:m,vscaleBounds:_,verticalMinorTick:c,horizontalMinorTick:f,verticalLine:{start:{x:_.bottomRight.x,y:_.topLeft.y},end:{x:_.bottomRight.x,y:_.bottomRight.y}},horizontalLine:{start:{x:m.topLeft.x,y:m.bottomRight.y},end:{x:m.bottomRight.x,y:m.bottomRight.y}},color:b,lineWidth:w},this.configuration);Object(g.draw)(a,function(e){Object(g.setShadow)(e,C),Object(g.drawLine)(e,i,C.verticalLine.start,C.verticalLine.end,{color:b,lineWidth:w},"canvas"),x(e,i,C),Object(g.drawLine)(e,i,C.horizontalLine.start,C.horizontalLine.end,{color:b,lineWidth:w},"canvas"),T(e,i,C)})}}}]),t}(m.default),y=function e(t,n,a){var o=n*Math.min(1e3,t.width),r=a*Math.min(1e3,t.height),i={left:o,top:r,width:t.width-2*o,height:t.height-2*r};return{topLeft:{x:i.left,y:i.top},bottomRight:{x:i.left+i.width,y:i.top+i.height}}},x=function e(t,n,a){for(var o=0;a.verticalLine.start.y+o*a.verticalMinorTick<=a.vscaleBounds.bottomRight.y;){var r=a.color,i=a.lineWidth,l={x:a.verticalLine.start.x,y:a.verticalLine.start.y+o*a.verticalMinorTick},s={x:0,y:a.verticalLine.start.y+o*a.verticalMinorTick};o%5==0?s.x=a.verticalLine.start.x-a.majorTickLength:s.x=a.verticalLine.start.x-a.minorTickLength,Object(g.drawLine)(t,n,l,s,{color:r,lineWidth:i},"canvas"),o++}},T=function e(t,n,a){for(var o=0;a.horizontalLine.start.x+o*a.horizontalMinorTick<=a.hscaleBounds.bottomRight.x;){var r=a.color,i=a.lineWidth,l={x:a.horizontalLine.start.x+o*a.horizontalMinorTick,y:a.horizontalLine.start.y},s={x:a.horizontalLine.start.x+o*a.horizontalMinorTick,y:0};o%5==0?s.y=a.horizontalLine.start.y-a.majorTickLength:s.y=a.horizontalLine.start.y-a.minorTickLength,Object(g.drawLine)(t,n,l,s,{color:r,lineWidth:i},"canvas"),o++}}},"./tools/StackScrollMouseWheelTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return g});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),m=n(/*! ../util/scroll.js */ "./util/scroll.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),s()(this,d()(t).call(this,e,{name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}}))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function e(t){var n=t.detail,a=n.direction,o=n.element,r=this.configuration,i=r.loop,l=r.allowSkipping,s=r.invert;Object(m.default)(o,s?-a:a,i,l)}}]),t}(h.default)},"./tools/StackScrollMultiTouchTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return _});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),v=n(/*! ../util/scroll.js */ "./util/scroll.js"),$=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),p=n(/*! ../toolOptions.js */ "./toolOptions.js"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),(e=s()(this,d()(t).call(this,n,{name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}}))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function e(t){var n=t.detail;if(n.numPointers===this.configuration.touchPointers){var a=n.element,o=n.deltaPoints,r=this.configuration,i=r.loop,l=r.allowSkipping,s=Object(p.getToolOptions)(this.name,a),u=this._getPixelPerImage(a),d=this._getDeltaY(a,o.page.y);if(!u)return;Math.abs(d)>=u?(Object(v.default)(a,Math.round(d/u),i,l),s.deltaY=d%u):s.deltaY=d,Object(p.setToolOptions)(this.name,a,s)}}},{key:"_getDeltaY",value:function e(t,n){return(Object(p.getToolOptions)(this.name,t).deltaY||0)+n}},{key:"_getPixelPerImage",value:function e(t){var n=Object($.getToolState)(t,"stack");if(n&&n.data&&n.data.length){var a=n.data[0];return this.configuration.stackScrollSpeed||Math.max(2,t.offsetHeight/Math.max(a.imageIds.length,8))}}}]),t}(g.default)},"./tools/StackScrollTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return y});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),v=n(/*! ../util/scroll.js */ "./util/scroll.js"),$=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),p=n(/*! ../toolOptions.js */ "./toolOptions.js"),_=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:_.stackScrollCursor};return(e=s()(this,d()(t).call(this,n,a))).mouseDragCallback=e._dragCallback.bind(f()(e)),e.touchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function e(t){var n=t.detail,a=n.element,o=n.deltaPoints,r=this.configuration,i=r.loop,l=r.allowSkipping,s=Object(p.getToolOptions)(this.name,a),u=this._getPixelPerImage(a),d=this._getDeltaY(a,o.page.y);u&&(Math.abs(d)>=u?(Object(v.default)(a,Math.round(d/u),i,l),s.deltaY=d%u):s.deltaY=d,Object(p.setToolOptions)(this.name,a,s))}},{key:"_getDeltaY",value:function e(t,n){return(Object(p.getToolOptions)(this.name,t).deltaY||0)+n}},{key:"_getPixelPerImage",value:function e(t){var n=Object($.getToolState)(t,"stack");if(n&&n.data&&n.data.length){var a=n.data[0];return this.configuration.stackScrollSpeed||Math.max(2,t.offsetHeight/Math.max(a.imageIds.length,8))}}}]),t}(g.default)},"./tools/WwwcRegionTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return T});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../externalModules.js */ "./externalModules.js"),v=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),$=n(/*! ../drawing/index.js */ "./drawing/index.js"),p=n(/*! ../util/clip.js */ "./util/clip.js"),_=n(/*! ../util/getLuminance.js */ "./util/getLuminance.js"),y=n(/*! ../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),x=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:x.wwwcRegionCursor};return(e=s()(this,d()(t).call(this,n,a)))._resetHandles(),e.postTouchStartCallback=e._startOutliningRegion.bind(f()(e)),e.touchDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.touchEndCallback=e._applyStrategy.bind(f()(e)),e.postMouseDownCallback=e._startOutliningRegion.bind(f()(e)),e.mouseClickCallback=e._startOutliningRegion.bind(f()(e)),e.mouseDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseMoveCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseUpCallback=e._applyStrategy.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderToolData",value:function e(t){var n=this,a=t.detail,o=a.element,r=y.default.getColorIfActive({active:!0}),i=Object($.getNewContext)(a.canvasContext.canvas);Object($.draw)(i,function(e){Object($.drawRect)(e,o,n.handles.start,n.handles.end,{color:r})})}},{key:"_startOutliningRegion",value:function e(t){var n=t.detail.element,a=t.detail.currentPoints.image;return b(this.handles.start)?this.handles.start=a:(this.handles.end=a,this._applyStrategy(t)),g.default.cornerstone.updateImage(n),!0}},{key:"_setHandlesAndUpdate",value:function e(t){var n=t.detail.element,a=t.detail.currentPoints.image;this.handles.end=a,g.default.cornerstone.updateImage(n)}},{key:"_applyStrategy",value:function e(t){!(b(this.handles.start)||b(this.handles.end))&&(t.detail.handles=this.handles,w(t,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function e(){this.handles={start:{},end:{}}}}]),t}(v.default),b=function e(t){return 0===Object.keys(t).length&&t.constructor===Object},w=function e(t,n){var a=t.detail,o=a.image,r=a.element,i=t.detail.handles,l=i.start,s=i.end,u=Math.min(l.x,s.x),d=Math.min(l.y,s.y),c=Math.abs(l.x-s.x),f=Math.abs(l.y-s.y);u=Object(p.default)(u,0,o.width),d=Object(p.default)(d,0,o.height),c=Math.floor(Math.min(c,Math.abs(o.width-u))),f=Math.floor(Math.min(f,Math.abs(o.height-d)));var h=Object(_.default)(r,u,d,c,f),m=C(h,o.minPixelValue,o.maxPixelValue),v=a.viewport;void 0===n.minWindowWidth&&(n.minWindowWidth=10),v.voi.windowWidth=Math.max(Math.abs(m.max-m.min),n.minWindowWidth),v.voi.windowCenter=m.mean,g.default.cornerstone.setViewport(r,v),g.default.cornerstone.updateImage(r)},C=function e(t,n,a){var o=t.length,r=a,i=n,l=0;if(o<2)return{min:r,max:i,mean:(n+a)/2};for(var s=0;s<o;s++){var u=t[s];r=Math.min(r,u),i=Math.max(i,u),l+=u}return{min:r,max:i,mean:l/o}}},"./tools/WwwcTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return v});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ../externalModules.js */ "./externalModules.js"),m=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),g=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Wwwc",strategies:{basicLevelingStrategy:$},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:g.wwwcCursor};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseDragCallback",value:function e(t){this.applyActiveStrategy(t),h.default.cornerstone.setViewport(t.detail.element,t.detail.viewport)}},{key:"touchDragCallback",value:function e(t){t.stopImmediatePropagation(),this.applyActiveStrategy(t),h.default.cornerstone.setViewport(t.detail.element,t.detail.viewport)}}]),t}(m.default);function $(e,t){var n,a=t.orientation,o=e.detail,r=o.image.maxPixelValue*o.image.slope+o.image.intercept,i=(r-(o.image.minPixelValue*o.image.slope+o.image.intercept))/1024,l=o.deltaPoints.page.x*i,s=o.deltaPoints.page.y*i;0===a?(o.viewport.voi.windowWidth+=l,o.viewport.voi.windowCenter+=s):(o.viewport.voi.windowWidth+=s,o.viewport.voi.windowCenter+=l)}},"./tools/ZoomMouseWheelTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return v});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../externalModules.js */ "./externalModules.js"),m=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),g=n(/*! ../util/zoom/index.js */ "./util/zoom/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),s()(this,d()(t).call(this,e,{name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}}))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function e(t){var n=t.detail,a=n.element,o=n.viewport,r=n.spinY,i=this.configuration,l=i.invert,s=i.maxScale,u=i.minScale,d=Object(g.changeViewportScale)(o,l?r/4:-r/4,{maxScale:s,minScale:u});h.default.cornerstone.setViewport(a,d)}}]),t}(m.default)},"./tools/ZoomTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return y});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ../externalModules.js */ "./externalModules.js"),m=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),g=n(/*! ../util/clip.js */ "./util/clip.js"),v=n(/*! ../util/zoom/index.js */ "./util/zoom/index.js"),$=n(/*! ./cursors/index.js */ "./tools/cursors/index.js"),p=v.default.correctShift,_=v.default.changeViewportScale,y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Zoom",strategies:{default:T,translate:b,zoomToCenter:w},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:$.zoomCursor};return s()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function e(t){x.call(this,t)}},{key:"mouseDragCallback",value:function e(t){x.call(this,t)}}]),t}(m.default),x=function e(t){if(!t.detail.deltaPoints.page.y)return!1;this.applyActiveStrategy(t,this.configuration),h.default.cornerstone.setViewport(t.detail.element,t.detail.viewport)};function T(e,t){var n=t.invert,a=t.maxScale,o=t.minScale,r=e.detail.deltaPoints.page.y,i=e.detail,l=i.element,s=i.viewport,u=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],d=u[0],c=u[1],f=u[2],m=u[3],g=_(s,n?-r/100:r/100,{maxScale:a,minScale:o});h.default.cornerstone.setViewport(l,g);var v=h.default.cornerstone.pageToPixel(l,d,c),$={x:f-v.x,y:m-v.y};$=p($,g),s.translation.x-=$.x,s.translation.y-=$.y}function b(e,t){var n=t.invert,a=t.preventZoomOutsideImage,o=t.maxScale,r=t.minScale,i=e.detail.deltaPoints.page.y,l=n?-i/100:i/100,s=e.detail.image,u=e.detail.viewport,d=[e.detail.startPoints.image.x,e.detail.startPoints.image.y],c=d[0],f=d[1],h=_(u,l,{maxScale:o,minScale:r}),m={x:0,y:0};if(l<0)h.scale<3&&(.01>Math.abs(h.translation.x)?h.translation.x=0:m.x=h.translation.x/8,.01>Math.abs(h.translation.y)?h.translation.y=0:m.y=h.translation.y/8);else{a&&Object(g.clipToBox)(e.detail.startPoints.image,s);var v={x:s.width/2-c,y:s.height/2-f};v=p(v,h);var $={x:h.translation.x-v.x,y:h.translation.y-v.y};.01>Math.abs($.x)?h.translation.x=v.x:m.x=$.x/8,.01>Math.abs($.y)?h.translation.y=v.y:m.y=$.y/8}h.translation.x-=m.x,h.translation.y-=m.y}function w(e,t){var n=t.invert,a=t.maxScale,o=t.minScale,r=e.detail.deltaPoints.page.y;_(e.detail.viewport,n?-r/100:r/100,{maxScale:a,minScale:o})}},"./tools/ZoomTouchPinchTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return v});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../externalModules.js */ "./externalModules.js"),m=n(/*! ./base/BaseTool.js */ "./tools/base/BaseTool.js"),g=n(/*! ../util/zoom/index.js */ "./util/zoom/index.js").default.correctShift,v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),s()(this,d()(t).call(this,e,{name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}}))}return f()(t,e),i()(t,[{key:"touchPinchCallback",value:function e(t){var n=t.detail,a=n.element,o=n.viewport,r=n.scaleChange,i=[t.detail.startPoints.page.x,t.detail.startPoints.page.y,t.detail.startPoints.image.x,t.detail.startPoints.image.y],l=i[0],s=i[1],u=i[2],d=i[3],c=this.configuration,f=c.maxScale,m=c.minScale;o.scale+=r*o.scale,f&&o.scale>f?o.scale=f:m&&o.scale<m&&(o.scale=m),h.default.cornerstone.setViewport(a,o);var v=h.default.cornerstone.pageToPixel(a,l,s),$={x:u-v.x,y:d-v.y};$=g($,o),o.translation.x-=$.x,o.translation.y-=$.y,h.default.cornerstone.setViewport(a,o)}}]),t}(m.default)},"./tools/annotation/AngleTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return P});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),v=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),$=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=n(/*! ./../../manipulators/index.js */ "./manipulators/index.js"),_=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),y=n(/*! ./../../drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),x=n(/*! ./../../drawing/drawTextBox.js */ "./drawing/drawTextBox.js"),T=n(/*! ./../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),b=n(/*! ./../../util/lineSegDistance.js */ "./util/lineSegDistance.js"),w=n(/*! ./../../util/roundToDecimal.js */ "./util/roundToDecimal.js"),C=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),E=n(/*! ../../util/triggerEvent.js */ "./util/triggerEvent.js"),j=n(/*! ../../events.js */ "./events.js"),S=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),I=n(/*! ../../util/throttle */ "./util/throttle.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:C.angleCursor};return(e=s()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e.throttledUpdateCachedStats=Object(I.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1},middle:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0},end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a){return!1!==n.visible&&(25>Object(b.default)(t,n.handles.start,n.handles.middle,a)||25>Object(b.default)(t,n.handles.middle,n.handles.end,a))}},{key:"updateCachedStats",value:function e(t,n,a){var o=Object(S.default)(t),r=o.rowPixelSpacing,i=o.colPixelSpacing,l={x:(a.handles.middle.x-a.handles.start.x)*i,y:(a.handles.middle.y-a.handles.start.y)*r},s={x:(a.handles.end.x-a.handles.middle.x)*i,y:(a.handles.end.y-a.handles.middle.y)*r},u={x:(a.handles.end.x-a.handles.start.x)*i,y:(a.handles.end.y-a.handles.start.y)*r},d=M(l),c=M(s),f=Math.acos((Math.pow(d,2)+Math.pow(c,2)-Math.pow(M(u),2))/(2*d*c));f*=180/Math.PI,a.rAngle=Object(w.default)(f,2),a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail,o=a.enabledElement,r=this.configuration,i=r.handleRadius,l=r.drawHandlesOnHover,s=Object(g.getToolState)(t.currentTarget,this.name);if(s){for(var u=Object(_.getNewContext)(a.canvasContext.canvas),d=a.image,c=a.element,f=Object(S.default)(d),m=f.rowPixelSpacing,p=f.colPixelSpacing,b=v.default.getToolWidth(),w=0;w<s.data.length;w++)if("continue"===function e(t){var r=s.data[t];if(!1===r.visible)return"continue";Object(_.draw)(u,function(e){Object(_.setShadow)(e,n.configuration);var t=$.default.getColorIfActive(r),s=h.default.cornerstone.pixelToCanvas(a.element,r.handles.start),u=h.default.cornerstone.pixelToCanvas(a.element,r.handles.middle);if(Object(_.drawJoinedLines)(e,a.element,r.handles.start,[r.handles.middle,r.handles.end],{color:t}),Object(T.default)(e,a,r.handles,{color:t,handleRadius:i,drawHandlesIfActive:l}),!0===r.invalidated&&(r.rAngle?n.throttledUpdateCachedStats(d,c,r):n.updateCachedStats(d,c,r)),r.rAngle){var f,g,v,w,E=(f=r,g=m,v=p,f.rAngle.toString()+String.fromCharCode(parseInt("00B0",16))+(g&&v?"":" (isotropic)"));if(!r.handles.textBox.hasMoved){w={x:u.x,y:u.y};var j=Object(x.textBoxWidth)(e,E,5);u.x<s.x?w.x-=15+j+10:w.x+=15;var S=h.default.cornerstone.internal.getTransform(o);S.invert();var I=S.transformPoint(w.x,w.y);r.handles.textBox.x=I.x,r.handles.textBox.y=I.y}Object(y.default)(e,a.element,r.handles.textBox,E,r.handles,C,t,b,0,!0)}})}(w))continue}function C(e){return[e.start,e.middle,e.end]}}},{key:"addNewMeasurement",value:function e(t,n){var a=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,t.preventDefault(),t.stopPropagation();var o=t.detail,r=this.createNewMeasurement(o),i=t.detail.element;Object(g.addToolState)(i,this.name,r),h.default.cornerstone.updateImage(i);var l=Object.assign({},{doneMovingCallback:function e(){r.active=!1,a.preventNewMeasurement=!1;var t=j.default.MEASUREMENT_COMPLETED,n={toolType:a.name,element:i,measurementData:r};Object(E.default)(i,t,n),h.default.cornerstone.updateImage(i)}},this.options),s=Object.assign({},{doneMovingCallback:function e(){r.active=!1,r.handles.end.active=!0,h.default.cornerstone.updateImage(i),Object(p.moveNewHandle)(o,a.name,r,r.handles.end,l,n)}},this.options);Object(p.moveNewHandle)(o,this.name,r,r.handles.middle,s,n)}}}]),t}(m.default);function M(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}},"./tools/annotation/ArrowAnnotateTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return P});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ./../../events.js */ "./events.js"),v=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),$=n(/*! ./../../stateManagement/textStyle.js */ "./stateManagement/textStyle.js"),p=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),_=n(/*! ./../../manipulators/index.js */ "./manipulators/index.js"),y=n(/*! ./../../util/pointInsideBoundingBox.js */ "./util/pointInsideBoundingBox.js"),x=n(/*! ./../../util/lineSegDistance.js */ "./util/lineSegDistance.js"),T=n(/*! ./../../util/triggerEvent.js */ "./util/triggerEvent.js"),b=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),w=n(/*! ./../../drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),C=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),E=n(/*! ./../../drawing/drawArrow.js */ "./drawing/drawArrow.js"),j=n(/*! ./../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),S=n(/*! ./../../drawing/drawTextBox.js */ "./drawing/drawTextBox.js"),I=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:M,changeTextCallback:k,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},svgCursor:I.arrowAnnotateCursor};return(e=s()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){return{visible:!0,active:!0,color:void 0,handles:{start:{x:t.detail.currentPoints.image.x,y:t.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:t.detail.currentPoints.image.x,y:t.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a){return!1!==n.visible&&25>Object(x.default)(t,n.handles.start,n.handles.end,a)}},{key:"updateCachedStats",value:function e(){}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail,o=a.element,r=a.enabledElement,i=this.configuration,l=i.handleRadius,s=i.drawHandlesOnHover,u=Object(b.getToolState)(o,this.name);if(u){for(var d=t.detail.canvasContext.canvas,c=Object(C.getNewContext)(d),f=v.default.getToolWidth(),m=0;m<u.data.length;m++)if("continue"===function e(a){var i=u.data[a];if(!1===i.visible)return"continue";Object(C.draw)(c,function(e){Object(C.setShadow)(e,n.configuration);var a,u=p.default.getColorIfActive(i),d=h.default.cornerstone.pixelToCanvas(o,i.handles.start),c=h.default.cornerstone.pixelToCanvas(o,i.handles.end);n.configuration.arrowFirst?Object(E.default)(e,c,d,u,f):Object(E.default)(e,d,c,u,f),n.configuration.drawHandles&&Object(j.default)(e,t.detail,i.handles,{color:u,handleRadius:l,drawHandlesIfActive:s});var m=(a=i,a.text);if(m&&""!==m){var v=Object(S.textBoxWidth)(e,m,5),_=$.default.getFontSize()+10,y=Math.max(v,_)/2+5;if(c.x<d.x&&(y=-y),!i.handles.textBox.hasMoved){x=n.configuration.arrowFirst?{x:c.x-v/2+y,y:c.y-_/2}:{x:d.x-v/2-y,y:d.y-_/2};var x,T=h.default.cornerstone.internal.getTransform(r);T.invert();var b=T.transformPoint(x.x,x.y);i.handles.textBox.x=b.x,i.handles.textBox.y=b.y}Object(w.default)(e,o,i.handles.textBox,m,i.handles,g,u,f,0,!1)}})}(m))continue}function g(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}},{key:"addNewMeasurement",value:function e(t,n){var a=this,o=t.detail.element,r=this.createNewMeasurement(t);Object(b.addToolState)(o,this.name,r),h.default.cornerstone.updateImage(o);var i=Object.assign({},{doneMovingCallback:function e(){void 0===r.text&&a.configuration.getTextCallback(function(e){if(r.active=!1,e){r.text=e;var t=g.default.MEASUREMENT_COMPLETED,n={toolName:a.name,element:o,measurementData:r};Object(T.default)(o,t,n)}else Object(b.removeToolState)(o,a.name,r);h.default.cornerstone.updateImage(o)}),h.default.cornerstone.updateImage(o)}},this.options);Object(_.moveNewHandle)(t.detail,this.name,r,r.handles.end,i,n)}},{key:"doubleClickCallback",value:function e(t){return this._updateTextForNearbyAnnotation(t)}},{key:"touchPressCallback",value:function e(t){return this._updateTextForNearbyAnnotation(t)}},{key:"_updateTextForNearbyAnnotation",value:function e(t){var n=t.detail.element,a=t.detail.currentPoints.canvas,o=Object(b.getToolState)(n,this.name);if(!o)return!1;for(var r=0;r<o.data.length;r++){var i=o.data[r];if(this.pointNearTool(n,i,a)||Object(y.default)(i.handles.textBox,a))return i.active=!0,h.default.cornerstone.updateImage(n),this.configuration.changeTextCallback(i,t.detail,this._doneChangingTextCallback.bind(this,n,i)),t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function e(t,n,a,o){!0===o?Object(b.removeToolState)(t,this.name,n):n.text=a,n.active=!1,h.default.cornerstone.updateImage(t)}}]),t}(m.default);function M(e){e(prompt("Enter your annotation:"))}function k(e,t,n){n(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return I});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),v=n(/*! ./bidirectionalTool/createNewMeasurement.js */ "./tools/annotation/bidirectionalTool/createNewMeasurement.js"),$=n(/*! ./bidirectionalTool/pointNearTool.js */ "./tools/annotation/bidirectionalTool/pointNearTool.js"),p=n(/*! ./bidirectionalTool/renderToolData.js */ "./tools/annotation/bidirectionalTool/renderToolData.js"),_=n(/*! ./bidirectionalTool/addNewMeasurement.js */ "./tools/annotation/bidirectionalTool/addNewMeasurement.js"),y=n(/*! ./bidirectionalTool/mouseMoveCallback.js */ "./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),x=n(/*! ./bidirectionalTool/handleSelectedCallback.js */ "./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),T=n(/*! ./bidirectionalTool/handleSelectedMouseCallback.js */ "./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),b=n(/*! ./bidirectionalTool/handleSelectedTouchCallback.js */ "./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),w=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),C=n(/*! ../../util/throttle */ "./util/throttle.js"),E=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),j=n(/*! ./bidirectionalTool/utils/calculateLongestAndShortestDiameters */ "./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),S=function e(t,n,a){return a()},I=function(e){function t(e){o()(this,t);var n,a={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:S,getMeasurementLocationCallback:S,textBox:"",shadow:"",drawHandlesOnHover:!0,additionalData:[]},svgCursor:w.bidirectionalCursor};return(n=s()(this,d()(t).call(this,e,a))).throttledUpdateCachedStats=Object(C.default)(n.updateCachedStats,110),n.createNewMeasurement=v.default.bind(f()(n)),n.pointNearTool=$.default.bind(f()(n)),n.renderToolData=p.default.bind(f()(n)),n.addNewMeasurement=_.default.bind(f()(n)),n._moveCallback=y.default.bind(f()(n)),n.handleSelectedCallback=x.default.bind(f()(n)),n.handleSelectedMouseCallback=T.default.bind(f()(n)),n.handleSelectedTouchCallback=b.default.bind(f()(n)),n}return m()(t,e),i()(t,[{key:"updateCachedStats",value:function e(t,n,a){var o=Object(E.default)(t),r=Object(j.default)(a,o),i=r.longestDiameter,l=r.shortestDiameter;a.longestDiameter=i,a.shortestDiameter=l,a.invalidated=!1}}]),t}(g.default)},"./tools/annotation/CircleRoiTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return S});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),v=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),$=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),_=n(/*! ./../../util/calculateSUV.js */ "./util/calculateSUV.js"),y=n(/*! ./../../util/ellipse/index.js */ "./util/ellipse/index.js"),x=n(/*! ../../util/getROITextBoxCoords.js */ "./util/getROITextBoxCoords.js"),T=n(/*! ./../../util/numbersWithCommas.js */ "./util/numbersWithCommas.js"),b=n(/*! ./../../util/throttle.js */ "./util/throttle.js"),w=n(/*! ../../util/logger.js */ "./util/logger.js"),C=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),E=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),j=Object(w.getLogger)("tools:annotation:CircleRoiTool"),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"CircleRoi",supportedInteractionTypes:["Mouse","Touch"],svgCursor:E.circleRoiCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(b.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){if(!(t&&t.currentPoints&&t.currentPoints.image)){j.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1},end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0},initialRotation:t.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a,o){var r=n&&n.handles&&n.handles.start&&n.handles.end;if(r||j.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===n.visible)return!1;var i="mouse"===o?15:25,l=h.default.cornerstone.pixelToCanvas(t,n.handles.start),s=h.default.cornerstone.pixelToCanvas(t,n.handles.end),u=D(l,a),d=D(l,s);return u>d-i/2&&u<d+i/2}},{key:"updateCachedStats",value:function e(t,n,a){var o,r,i,l,s,u,d,c,f,m=(h.default.cornerstone.metaData.get("generalSeriesModule",t.imageId)||{}).modality,g=Object(C.default)(t),v=(o=t,r=n,i=a.handles,l=m,s=g,d=k(i.start,i.end),c=h.default.cornerstone.getPixels(r,d.left,d.top,d.width,d.height),f=Object(y.calculateEllipseStatistics)(c,d),"PT"===l&&(u={mean:Object(_.default)(o,f.mean,!0)||0,stdDev:Object(_.default)(o,f.stdDev,!0)||0}),{area:Math.PI*(d.width*(s.colPixelSpacing||1)/2)*(d.height*(s.rowPixelSpacing||1)/2)||0,count:f.count||0,mean:f.mean||0,variance:f.variance||0,stdDev:f.stdDev||0,min:f.min||0,max:f.max||0,meanStdDevSUV:u});a.cachedStats=v,a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=Object(g.getToolState)(t.currentTarget,this.name);if(a){var o=t.detail,r=o.image,i=o.element,l=o.canvasContext,s=v.default.getToolWidth(),u=this.configuration,d=u.handleRadius,c=u.drawHandlesOnHover,f=Object(p.getNewContext)(l.canvas),m=Object(C.default)(r),_=m.rowPixelSpacing,y=m.colPixelSpacing,T=(h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,b=_&&y;Object(p.draw)(f,function(e){for(var t=0;t<a.data.length;t++){var l=a.data[t];if(!1!==l.visible){var u=$.default.getColorIfActive(l),f={color:u,handleRadius:d,drawHandlesIfActive:c};Object(p.setShadow)(e,n.configuration);var m=h.default.cornerstone.pixelToCanvas(i,l.handles.start),g=h.default.cornerstone.pixelToCanvas(i,l.handles.end),v=D(m,g);if(Object(p.drawCircle)(e,i,l.handles.start,v,{color:u},"pixel"),Object(p.drawHandles)(e,o,l.handles,f),!0===l.invalidated&&(l.cachedStats?n.throttledUpdateCachedStats(r,i,l):n.updateCachedStats(r,i,l)),!l.handles.textBox.hasMoved){var _=Object(x.default)(o.viewport,l.handles);Object.assign(l.handles.textBox,_)}var y=function e(t){return I(t.start,t.end)},w=M(e,r.color,l.cachedStats,T,b,n.configuration);l.unit=P(T,n.configuration.showHounsfieldUnits),Object(p.drawLinkedTextBox)(e,i,l.handles.textBox,w,l.handles,y,u,s,10,!0)}}})}}}]),t}(m.default);function I(e,t){var n=k(e,t),a=n.left,o=n.top,r=n.width,i=n.height;return[{x:a+r/2,y:o},{x:a,y:o+i/2},{x:a+r/2,y:o+i},{x:a+r,y:o+i/2}]}function P(e,t){return"CT"===e&&!1!==t?"HU":""}function M(e,t){var n,a,o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.area,l=r.mean,s=r.stdDev,u=r.min,d=r.max,c=r.meanStdDevSUV,f=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=m.showMinMax||!1,v=[],$=[];if(!t){var p=c&&0!==c.mean,_=P(f,m.showHounsfieldUnits),y="Mean: ".concat(Object(T.default)(l.toFixed(2))," ").concat(_),x="Std Dev: ".concat(Object(T.default)(s.toFixed(2))," ").concat(_);if(p){for(var b=" SUV: ",w="".concat(b).concat(Object(T.default)(c.mean.toFixed(2))),C="".concat(b).concat(Object(T.default)(c.stdDev.toFixed(2))),E=Math.floor(e.measureText("".concat(x,"     ")).width);e.measureText(y).width<E;)y+=" ";$.push("".concat(y).concat(w)),$.push("".concat(x,"     ").concat(C))}else $.push("".concat(y,"     ").concat(x));if(g){for(var j="Min: ".concat(u," ").concat(_),S="Max: ".concat(d," ").concat(_),I=p?Math.floor(e.measureText("".concat(x,"     ")).width):Math.floor(e.measureText("".concat(y,"     ")).width);e.measureText(j).width<I;)j+=" ";$.push("".concat(j).concat(S))}}return v.push((n=i,a=h,o=a?" mm".concat("\xb2"):" px".concat("\xb2"),"Area: ".concat(Object(T.default)(n.toFixed(2))).concat(o))),$.forEach(function(e){return v.push(e)}),v}function k(e,t){var n=D(e,t);return{left:Math.round(Math.min(e.x-n,t.x)),top:Math.round(Math.min(e.y-n,t.y)),width:2*n,height:2*n}}function D(e,t){var n=e.x-t.x,a=e.y-t.y;return Math.sqrt(n*n+a*a)}},"./tools/annotation/CobbAngleTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return P});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ./../../stateManagement/textStyle.js */ "./stateManagement/textStyle.js"),v=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),$=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),p=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),_=n(/*! ./../../manipulators/index.js */ "./manipulators/index.js"),y=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),x=n(/*! ./../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),T=n(/*! ./../../drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),b=n(/*! ./../../util/lineSegDistance.js */ "./util/lineSegDistance.js"),w=n(/*! ./../../util/roundToDecimal.js */ "./util/roundToDecimal.js"),C=n(/*! ./../../events.js */ "./events.js"),E=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),j=n(/*! ../../util/triggerEvent.js */ "./util/triggerEvent.js"),S=n(/*! ../../util/throttle */ "./util/throttle.js"),I=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:E.cobbAngleCursor};return(e=s()(this,d()(t).call(this,n,a))).hasIncomplete=!1,e.throttledUpdateCachedStats=Object(S.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,invalidated:!0,complete:!1,value:"",handles:{start:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1},end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0},start2:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:t.currentPoints.image.x+1,y:t.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a){return!1!==n.visible&&!this.hasIncomplete&&(25>Object(b.default)(t,n.handles.start,n.handles.end,a)||25>Object(b.default)(t,n.handles.start2,n.handles.end2,a))}},{key:"updateCachedStats",value:function e(t,n,a){var o=Object(I.default)(t),r=o.rowPixelSpacing,i=o.colPixelSpacing,l=(Math.ceil(a.handles.start.x)-Math.ceil(a.handles.end.x))*i,s=(Math.ceil(a.handles.start.y)-Math.ceil(a.handles.end.y))*r,u=(Math.ceil(a.handles.start2.x)-Math.ceil(a.handles.end2.x))*i,d=(Math.ceil(a.handles.start2.y)-Math.ceil(a.handles.end2.y))*r,c=Math.acos(Math.abs((l*u+s*d)/(Math.sqrt(l*l+s*s)*Math.sqrt(u*u+d*d))));c*=180/Math.PI,a.rAngle=Object(w.default)(c,2),a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail,o=this.configuration,r=o.handleRadius,i=o.drawHandlesOnHover,l=Object(v.getToolState)(t.currentTarget,this.name);if(l){for(var s=Object(y.getNewContext)(a.canvasContext.canvas),u=$.default.getToolWidth(),d=g.default.getFont(),c=0;c<l.data.length;c++)if("continue"===function e(t){var o=l.data[t];if(!1===o.visible)return"continue";Object(y.draw)(s,function(e){Object(y.setShadow)(e,n.configuration);var t=p.default.getColorIfActive(o);Object(y.drawLine)(e,a.element,o.handles.start,o.handles.end,{color:t}),o.complete&&Object(y.drawLine)(e,a.element,o.handles.start2,o.handles.end2,{color:t}),Object(x.default)(e,a,o.handles,{color:t,handleRadius:r,drawHandlesIfActive:i}),e.fillStyle=t;var l=o.value;if(!o.handles.textBox.hasMoved){var s={x:(o.handles.start.x+o.handles.end.x)/2,y:(o.handles.start.y+o.handles.end.y)/2-10};e.font=d,o.handles.textBox.x=s.x,o.handles.textBox.y=s.y}Object(T.default)(e,a.element,o.handles.textBox,l,o.handles,f,t,u,0,!0)})}(c))continue}function f(e){return[e.start,e.start2,e.end,e.end2]}}},{key:"getIncomplete",value:function e(t){var n=Object(v.getToolState)(t,this.name);if(n&&Array.isArray(n.data))return n.data.find(function(e){return!1===e.complete})}},{key:"addNewMeasurement",value:function e(t,n){var a,o,r,i=this;t.preventDefault(),t.stopPropagation();var l=t.detail,s=t.detail.element,u=this.getIncomplete(s);u?((a=u).complete=!0,a.handles.start2={x:l.currentPoints.image.x,y:l.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},a.handles.end2={x:l.currentPoints.image.x,y:l.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},o=a.handles.end2,this.hasIncomplete=!1,r=Object.assign({doneMovingCallback:function e(){var t=C.default.MEASUREMENT_COMPLETED,n={toolType:i.name,element:s,measurementData:a};Object(j.default)(s,t,n)}},this.options)):(a=this.createNewMeasurement(l),Object(v.addToolState)(s,this.name,a),o=a.handles.end,r=this.options),h.default.cornerstone.updateImage(s),Object(_.moveNewHandle)(l,this.name,a,o,r,n)}},{key:"onMeasureModified",value:function e(t){var n=t.detail.element,a=h.default.cornerstone.getEnabledElement(n).image,o=Object(I.default)(a),r=o.rowPixelSpacing,i=o.colPixelSpacing;if(t.detail.toolName===this.name){var l=t.detail.measurementData;!0===l.invalidated&&(l.rAngle?this.throttledUpdateCachedStats(a,n,l):this.updateCachedStats(a,n,l));var s,u,d,c=l.rAngle;l.value="",Number.isNaN(c)||(l.value=(s=c,u=r,d=i,s.toString()+String.fromCharCode(parseInt("00B0",16))+(u&&d?"":" (isotropic)")))}}},{key:"activeCallback",value:function e(t){this.onMeasureModified=this.onMeasureModified.bind(this),t.addEventListener(C.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function e(t){this.onMeasureModified=this.onMeasureModified.bind(this),t.addEventListener(C.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function e(t){t.removeEventListener(C.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function e(t){t.removeEventListener(C.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),t}(m.default)},"./tools/annotation/EllipticalRoiTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return S});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),v=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),$=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),_=n(/*! ./../../util/calculateSUV.js */ "./util/calculateSUV.js"),y=n(/*! ./../../util/ellipse/index.js */ "./util/ellipse/index.js"),x=n(/*! ../../util/getROITextBoxCoords.js */ "./util/getROITextBoxCoords.js"),T=n(/*! ./../../util/numbersWithCommas.js */ "./util/numbersWithCommas.js"),b=n(/*! ./../../util/throttle.js */ "./util/throttle.js"),w=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),C=n(/*! ../../util/logger.js */ "./util/logger.js"),E=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),j=Object(C.getLogger)("tools:annotation:EllipticalRoiTool"),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{},svgCursor:w.ellipticalRoiCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(b.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){if(!(t&&t.currentPoints&&t.currentPoints.image)){j.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1},end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0},initialRotation:t.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a,o){var r=n&&n.handles&&n.handles.start&&n.handles.end;if(r||j.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===n.visible)return!1;var i="mouse"===o?15:25,l=h.default.cornerstone.pixelToCanvas(t,n.handles.start),s=h.default.cornerstone.pixelToCanvas(t,n.handles.end),u={left:Math.min(l.x,s.x)+i/2,top:Math.min(l.y,s.y)+i/2,width:Math.abs(l.x-s.x)-i,height:Math.abs(l.y-s.y)-i},d={left:Math.min(l.x,s.x)-i/2,top:Math.min(l.y,s.y)-i/2,width:Math.abs(l.x-s.x)+i,height:Math.abs(l.y-s.y)+i},c=Object(y.pointInEllipse)(u,a);return!!Object(y.pointInEllipse)(d,a)&&!c}},{key:"updateCachedStats",value:function e(t,n,a){var o,r,i,l,s,u,d,c,f,m=(h.default.cornerstone.metaData.get("generalSeriesModule",t.imageId)||{}).modality,g=Object(E.default)(t),v=(o=t,r=n,i=a.handles,l=m,s=g,d=k(i.start,i.end),c=h.default.cornerstone.getPixels(r,d.left,d.top,d.width,d.height),f=Object(y.calculateEllipseStatistics)(c,d),"PT"===l&&(u={mean:Object(_.default)(o,f.mean,!0)||0,stdDev:Object(_.default)(o,f.stdDev,!0)||0}),{area:Math.PI*(d.width*(s.colPixelSpacing||1)/2)*(d.height*(s.rowPixelSpacing||1)/2)||0,count:f.count||0,mean:f.mean||0,variance:f.variance||0,stdDev:f.stdDev||0,min:f.min||0,max:f.max||0,meanStdDevSUV:u});a.cachedStats=v,a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=Object(g.getToolState)(t.currentTarget,this.name);if(a){var o=t.detail,r=o.image,i=o.element,l=v.default.getToolWidth(),s=this.configuration,u=s.handleRadius,d=s.drawHandlesOnHover,c=Object(p.getNewContext)(o.canvasContext.canvas),f=Object(E.default)(r),m=f.rowPixelSpacing,_=f.colPixelSpacing,y=(h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,T=m&&_;Object(p.draw)(c,function(e){for(var t=0;t<a.data.length;t++){var s=a.data[t];if(!1!==s.visible){var c=$.default.getColorIfActive(s),f={color:c,handleRadius:u,drawHandlesIfActive:d};if(Object(p.setShadow)(e,n.configuration),Object(p.drawEllipse)(e,i,s.handles.start,s.handles.end,{color:c},"pixel",s.handles.initialRotation),Object(p.drawHandles)(e,o,s.handles,f),!0===s.invalidated&&(s.cachedStats?n.throttledUpdateCachedStats(r,i,s):n.updateCachedStats(r,i,s)),!s.handles.textBox.hasMoved){var h=Object(x.default)(o.viewport,s.handles);Object.assign(s.handles.textBox,h)}var m=function e(t){return I(t.start,t.end)},g=M(e,r.color,s.cachedStats,y,T,n.configuration);s.unit=P(y,n.configuration.showHounsfieldUnits),Object(p.drawLinkedTextBox)(e,i,s.handles.textBox,g,s.handles,m,c,l,10,!0)}}})}}}]),t}(m.default);function I(e,t){var n=k(e,t),a=n.left,o=n.top,r=n.width,i=n.height;return[{x:a+r/2,y:o},{x:a,y:o+i/2},{x:a+r/2,y:o+i},{x:a+r,y:o+i/2}]}function P(e,t){return"CT"===e&&!1!==t?"HU":""}function M(e,t){var n,a,o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.area,l=r.mean,s=r.stdDev,u=r.min,d=r.max,c=r.meanStdDevSUV,f=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=m.showMinMax||!1,v=[],$=[];if(!t){var p=c&&0!==c.mean,_=P(f,m.showHounsfieldUnits),y="Mean: ".concat(Object(T.default)(l.toFixed(2))," ").concat(_),x="Std Dev: ".concat(Object(T.default)(s.toFixed(2))," ").concat(_);if(p){for(var b=" SUV: ",w="".concat(b).concat(Object(T.default)(c.mean.toFixed(2))),C="".concat(b).concat(Object(T.default)(c.stdDev.toFixed(2))),E=Math.floor(e.measureText("".concat(x,"     ")).width);e.measureText(y).width<E;)y+=" ";$.push("".concat(y).concat(w)),$.push("".concat(x,"     ").concat(C))}else $.push("".concat(y,"     ").concat(x));if(g){for(var j="Min: ".concat(u," ").concat(_),S="Max: ".concat(d," ").concat(_),I=p?Math.floor(e.measureText("".concat(x,"     ")).width):Math.floor(e.measureText("".concat(y,"     ")).width);e.measureText(j).width<I;)j+=" ";$.push("".concat(j).concat(S))}}return v.push((n=i,a=h,o=a?" mm".concat("\xb2"):" px".concat("\xb2"),"Area: ".concat(Object(T.default)(n.toFixed(2))).concat(o))),$.forEach(function(e){return v.push(e)}),v}function k(e,t){return{left:Math.round(Math.min(e.x,t.x)),top:Math.round(Math.min(e.y,t.y)),width:Math.round(Math.abs(e.x-t.x)),height:Math.round(Math.abs(e.y-t.y))}}},"./tools/annotation/FreehandMouseTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return V});var a=n(/*! @babel/runtime/helpers/toConsumableArray */ "../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),m=n.n(h),g=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),v=n.n(g),$=n(/*! ./../../events.js */ "./events.js"),p=n(/*! ./../../externalModules.js */ "./externalModules.js"),_=n(/*! ./../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),y=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),x=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),T=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),b=n(/*! ../../store/index.js */ "./store/index.js"),w=n(/*! ../../util/triggerEvent.js */ "./util/triggerEvent.js"),C=n(/*! ../../util/findAndMoveHelpers.js */ "./util/findAndMoveHelpers.js"),E=n(/*! ../../util/pointInsideBoundingBox.js */ "./util/pointInsideBoundingBox.js"),j=n(/*! ../../util/calculateSUV.js */ "./util/calculateSUV.js"),S=n(/*! ../../util/numbersWithCommas.js */ "./util/numbersWithCommas.js"),I=n(/*! ../../drawing/index.js */ "./drawing/index.js"),P=n(/*! ../../drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),M=n(/*! ../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),k=n(/*! ../../util/clip.js */ "./util/clip.js"),D=n(/*! ../../store/setToolCursor.js */ "./store/setToolCursor.js"),L=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),R=n(/*! ../../util/freehand/index.js */ "./util/freehand/index.js"),A=n(/*! ../../util/logger.js */ "./util/logger.js"),O=n(/*! ../../util/throttle */ "./util/throttle.js"),H=Object(A.getLogger)("tools:annotation:FreehandMouseTool"),B=R.default.insertOrDelete,U=R.default.freehandArea,F=R.default.calculateFreehandStatistics,N=R.default.freehandIntersect,z=R.default.FreehandHandleData,V=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t);var a={name:"FreehandMouse",supportedInteractionTypes:["Mouse","Touch"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1},svgCursor:L.freehandMouseCursor};return(e=d()(this,f()(t).call(this,n,a))).isMultiPartTool=!0,e._drawing=!1,e._dragging=!1,e._modifying=!1,e._drawingMouseDownCallback=e._drawingMouseDownCallback.bind(m()(e)),e._drawingMouseMoveCallback=e._drawingMouseMoveCallback.bind(m()(e)),e._drawingMouseDragCallback=e._drawingMouseDragCallback.bind(m()(e)),e._drawingMouseUpCallback=e._drawingMouseUpCallback.bind(m()(e)),e._drawingMouseDoubleClickCallback=e._drawingMouseDoubleClickCallback.bind(m()(e)),e._editMouseUpCallback=e._editMouseUpCallback.bind(m()(e)),e._editMouseDragCallback=e._editMouseDragCallback.bind(m()(e)),e._drawingTouchStartCallback=e._drawingTouchStartCallback.bind(m()(e)),e._drawingTouchDragCallback=e._drawingTouchDragCallback.bind(m()(e)),e._drawingDoubleTapClickCallback=e._drawingDoubleTapClickCallback.bind(m()(e)),e._editTouchDragCallback=e._editTouchDragCallback.bind(m()(e)),e.throttledUpdateCachedStats=Object(O.default)(e.updateCachedStats,110),e}return v()(t,e),s()(t,[{key:"createNewMeasurement",value:function e(t){if(!(t&&t.currentPoints&&t.currentPoints.image)){H.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}var n={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return n.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},n}},{key:"pointNearTool",value:function e(t,n,a){var o=n&&n.handles&&n.handles.points;if(!o)throw Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!!o&&!1!==n.visible&&void 0!==this._pointNearHandle(t,n,a)}},{key:"distanceFromPoint",value:function e(t,n,a){for(var o=1/0,r=0;r<n.handles.points.length;r++)o=Math.min(o,p.default.cornerstoneMath.point.distance(n.handles.points[r],a));return o===1/0?-1:o}},{key:"distanceFromPointCanvas",value:function e(t,n,a){var o=1/0;if(!n)return -1;for(var r=p.default.cornerstone.pixelToCanvas(t,a),i=n.handles.points,l=0;l<i.length;l++){var s=p.default.cornerstone.pixelToCanvas(t,i[l]);o=Math.min(o,p.default.cornerstoneMath.point.distance(s,r))}return o===1/0?-1:o}},{key:"updateCachedStats",value:function e(t,n,a){for(var o,r,i=p.default.cornerstone.metaData.get("generalSeriesModule",t.imageId),l=i?i.modality:null,s=a.handles.points,u={left:s[0].x,right:s[0].x,bottom:s[0].y,top:s[0].x},d=0;d<s.length;d++)u.left=Math.min(u.left,s[d].x),u.right=Math.max(u.right,s[d].x),u.bottom=Math.min(u.bottom,s[d].y),u.top=Math.max(u.top,s[d].y);var c={left:u.left,top:u.bottom,width:Math.abs(u.right-u.left),height:Math.abs(u.top-u.bottom)};if(a.polyBoundingBox=c,!t.color){var f=p.default.cornerstone.getPixels(n,c.left,c.top,c.width,c.height);o=F.call(this,f,c,a.handles.points),"PT"===l&&(r={mean:Object(j.default)(t,(o.mean-t.intercept)/t.slope),stdDev:Object(j.default)(t,(o.stdDev-t.intercept)/t.slope)}),o&&!isNaN(o.mean)&&(a.meanStdDev=o,a.meanStdDevSUV=r)}var h=t.columnPixelSpacing||1,m=t.rowPixelSpacing||1,g=U(a.handles.points,h*m);isNaN(g)||(a.area=g),a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail,r=Object(y.getToolState)(t.currentTarget,this.name);if(r){for(var i=a.image,l=a.element,s=this.configuration,u=p.default.cornerstone.metaData.get("generalSeriesModule",i.imageId),d=u?u.modality:null,c=Object(I.getNewContext)(a.canvasContext.canvas),f=x.default.getToolWidth(),h=0;h<r.data.length;h++)if("continue"===function e(t){var u=r.data[t];if(!1===u.visible)return"continue";Object(I.draw)(c,function(e){var t,r=T.default.getColorIfActive(u);if(u.active?u.handles.invalidHandlePlacement?(r=s.invalidColor,t=s.invalidColor):(r=T.default.getColorIfActive(u),t=T.default.getFillColor()):t=T.default.getToolColor(),u.handles.points.length)for(var d=0;d<u.handles.points.length;d++){var c=o()(u.handles.points[d].lines);d!==u.handles.points.length-1||u.polyBoundingBox||c.push(s.mouseLocation.handles.start),Object(I.drawJoinedLines)(e,l,u.handles.points[d],c,{color:r})}var h={color:r,fill:t};if((s.alwaysShowHandles||u.active&&u.polyBoundingBox)&&(h.handleRadius=s.activeHandleRadius,Object(M.default)(e,a,u.handles.points,h)),u.canComplete){h.handleRadius=s.completeHandleRadius;var v=u.handles.points[0];Object(M.default)(e,a,[v],h)}if(u.active&&!u.polyBoundingBox){h.handleRadius=s.activeHandleRadius,Object(M.default)(e,a,s.mouseLocation.handles,h);var $=u.handles.points[0];Object(M.default)(e,a,[$],h)}if(!0!==u.invalidated||u.active||(u.meanStdDev&&u.meanStdDevSUV&&u.area?n.throttledUpdateCachedStats(i,l,u):n.updateCachedStats(i,l,u)),u.polyBoundingBox&&!u.handles.textBox.freehand){u.handles.textBox.hasMoved||(u.handles.textBox.x=u.polyBoundingBox.left+u.polyBoundingBox.width,u.handles.textBox.y=u.polyBoundingBox.top+u.polyBoundingBox.height/2);var p=m.call(n,u);Object(P.default)(e,l,u.handles.textBox,p,u.handles.points,g,r,f,0,!0)}})}(h))continue}function m(e){var t=e.meanStdDev,n=e.meanStdDevSUV,a=e.area,o=[];if(t&&void 0!==t.mean){var r="";"CT"===d&&(r="HU"),e.unit=r;var l="Mean: ".concat(Object(S.default)(t.mean.toFixed(2))," ").concat(r),s="StdDev: ".concat(Object(S.default)(t.stdDev.toFixed(2))," ").concat(r);if(n&&void 0!==n.mean){var u=" SUV: ";l+=u+Object(S.default)(n.mean.toFixed(2)),s+=u+Object(S.default)(n.stdDev.toFixed(2))}o.push(l),o.push(s)}if(a){var c=" mm".concat("\xb2");i.rowPixelSpacing&&i.columnPixelSpacing||(c=" pixels".concat("\xb2"));var f="Area: ".concat(Object(S.default)(a.toFixed(2))).concat(c);o.push(f)}return o}function g(e){return e}}},{key:"addNewMeasurement",value:function e(t){var n=t.detail;this._startDrawing(t),this._addPoint(n),q(t)}},{key:"preMouseDownCallback",value:function e(t){var n=t.detail,a=this._pointNearHandleAllTools(n);return!!n.event.ctrlKey&&(void 0!==a&&a.handleNearby.hasBoundingBox||B.call(this,t,a),q(t),!0)}},{key:"handleSelectedCallback",value:function e(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",r=t.detail.element,i=Object(y.getToolState)(r,this.name);if(a.hasBoundingBox){Object(C.moveHandleNearImagePoint)(t,this,n,a,o);return}var l=this.configuration;l.dragOrigin={x:a.x,y:a.y};for(var s=0;s<i.data.length;s++)for(var u=i.data[s].handles.points,d=0;d<u.length;d++)u[d]===a&&(l.currentHandle=d,l.currentTool=s);this._modifying=!0,this._activateModify(r),q(t)}},{key:"_drawingMouseMoveCallback",value:function e(t){var n=t.detail,a=n.currentPoints,o=n.element,r=Object(y.getToolState)(o,this.name),i=this.configuration,l=i.currentTool,s=r.data[l],u=a.canvas;this._getMouseLocation(n),this._checkInvalidHandleLocation(s,n);var d=this._pointNearHandle(o,s,u),c=s.handles.points;void 0!==d&&!d.hasBoundingBox&&d<c.length-1&&(i.mouseLocation.handles.start.x=c[d].x,i.mouseLocation.handles.start.y=c[d].y),p.default.cornerstone.updateImage(o)}},{key:"_drawingMouseDragCallback",value:function e(t){this.options.mouseButtonMask.includes(t.detail.buttons)&&this._drawingDrag(t)}},{key:"_drawingTouchDragCallback",value:function e(t){this._drawingDrag(t)}},{key:"_drawingDrag",value:function e(t){var n=t.detail,a=n.element,o=Object(y.getToolState)(a,this.name),r=this.configuration.currentTool,i=o.data[r];this._getMouseLocation(n),this._checkInvalidHandleLocation(i,n),this._addPointPencilMode(n,i.handles.points),this._dragging=!0,p.default.cornerstone.updateImage(a)}},{key:"_drawingMouseUpCallback",value:function e(t){var n=t.detail.element;if(this._dragging){this._dragging=!1;var a=this.configuration,o=a.currentTool,r=Object(y.getToolState)(n,this.name).data[o];if(!N.end(r.handles.points)&&r.canComplete){var i=a.currentHandle;this._endDrawing(n,i)}q(t)}}},{key:"_drawingMouseDownCallback",value:function e(t){var n=t.detail,a=n.buttons,o=n.currentPoints,r=n.element;if(this.options.mouseButtonMask.includes(a)){var i=o.canvas,l=this.configuration,s=l.currentTool,u=Object(y.getToolState)(r,this.name).data[s],d=this._pointNearHandle(r,u,i);if(!N.end(u.handles.points)&&u.canComplete){var c=l.currentHandle;this._endDrawing(r,c)}else void 0===d&&this._addPoint(n);q(t)}}},{key:"_drawingTouchStartCallback",value:function e(t){var n=t.detail,a=n.currentPoints,o=n.element,r=a.canvas,i=this.configuration,l=i.currentTool,s=Object(y.getToolState)(o,this.name).data[l],u=this._pointNearHandle(o,s,r);if(!N.end(s.handles.points)&&s.canComplete){var d=i.currentHandle;this._endDrawing(o,d)}else void 0===u&&this._addPoint(n);q(t)}},{key:"completeDrawing",value:function e(t){if(this._drawing){var n=Object(y.getToolState)(t,this.name),a=this.configuration,o=n.data[a.currentTool];if(!N.end(o.handles.points)&&o.handles.points.length>=2){var r=a.currentHandle;o.polyBoundingBox={},this._endDrawing(t,r)}}}},{key:"_drawingMouseDoubleClickCallback",value:function e(t){var n=t.detail.element;this.completeDrawing(n),q(t)}},{key:"_drawingDoubleTapClickCallback",value:function e(t){var n=t.detail.element;this.completeDrawing(n),q(t)}},{key:"_editMouseDragCallback",value:function e(t){var n=t.detail,a=n.element,o=n.buttons;if(this.options.mouseButtonMask.includes(o)){var r=Object(y.getToolState)(a,this.name),i=this.configuration,l=r.data[i.currentTool],s=i.currentHandle,u=l.handles.points,d=-1;if(this._getMouseLocation(n),l.handles.invalidHandlePlacement=N.modify(u,s),l.active=!0,l.highlight=!0,u[s].x=i.mouseLocation.handles.start.x,u[s].y=i.mouseLocation.handles.start.y,d=this._getPrevHandleIndex(s,u),s>=0){var c=u[d].lines.length-1,f=u[d].lines[c];f.x=i.mouseLocation.handles.start.x,f.y=i.mouseLocation.handles.start.y}p.default.cornerstone.updateImage(a)}}},{key:"_editTouchDragCallback",value:function e(t){var n=t.detail,a=n.element,o=Object(y.getToolState)(a,this.name),r=this.configuration,i=o.data[r.currentTool],l=r.currentHandle,s=i.handles.points,u=-1;if(this._getMouseLocation(n),i.handles.invalidHandlePlacement=N.modify(s,l),i.active=!0,i.highlight=!0,s[l].x=r.mouseLocation.handles.start.x,s[l].y=r.mouseLocation.handles.start.y,u=this._getPrevHandleIndex(l,s),l>=0){var d=s[u].lines.length-1,c=s[u].lines[d];c.x=r.mouseLocation.handles.start.x,c.y=r.mouseLocation.handles.start.y}p.default.cornerstone.updateImage(a)}},{key:"_getPrevHandleIndex",value:function e(t,n){return 0===t?n.length-1:t-1}},{key:"_editMouseUpCallback",value:function e(t){var n=t.detail,a=n.element,o=Object(y.getToolState)(a,this.name);this._deactivateModify(a),this._dropHandle(n,o),this._endDrawing(a),p.default.cornerstone.updateImage(a)}},{key:"_dropHandle",value:function e(t,n){var a=this.configuration,o=a.currentTool,r=n.data[o].handles,i=r.points;if(r.invalidHandlePlacement){var l,s=a.currentHandle,u=i[s];l=0===s?i[i.length-1]:i[s-1],u.x=a.dragOrigin.x,u.y=a.dragOrigin.y,l.lines[0]=u,r.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function e(t){var n,a=t.detail,o=this.createNewMeasurement(a),r=a.element,i=this.configuration;t.type===$.default.MOUSE_DOWN_ACTIVATE?n="Mouse":t.type===$.default.TOUCH_START_ACTIVE&&(n="Touch"),this._activateDraw(r,n),this._getMouseLocation(a),Object(y.addToolState)(r,this.name,o);var l=Object(y.getToolState)(r,this.name);i.currentTool=l.data.length-1,this._activeDrawingToolReference=l.data[i.currentTool]}},{key:"_addPoint",value:function e(t){var n=t.currentPoints,a=t.element,o=Object(y.getToolState)(a,this.name),r=this.configuration,i=o.data[r.currentTool];if(!i.handles.invalidHandlePlacement){var l=new z(n.image);i.handles.points.length&&i.handles.points[r.currentHandle-1].lines.push(n.image),i.handles.points.push(l),r.currentHandle+=1,p.default.cornerstone.updateImage(a),this.fireModifiedEvent(a,i)}}},{key:"_addPointPencilMode",value:function e(t,n){var a=this,o=this.configuration,r=t.element,i=o.mouseLocation.handles.start,l=function e(t){return a._isDistanceLargerThanSpacing(r,t,i)};n.every(l)&&this._addPoint(t)}},{key:"_endDrawing",value:function e(t,n){var a=Object(y.getToolState)(t,this.name),o=this.configuration,r=a.data[o.currentTool];if(r.active=!1,r.highlight=!1,r.handles.invalidHandlePlacement=!1,void 0!==n){var i=r.handles.points;i[o.currentHandle-1].lines.push(i[0])}this._modifying&&(this._modifying=!1,r.invalidated=!0),o.currentHandle=0,o.currentTool=-1,r.canComplete=!1,this._drawing&&this._deactivateDraw(t),p.default.cornerstone.updateImage(t),this.fireModifiedEvent(t,r),this.fireCompletedEvent(t,r)}},{key:"_pointNearHandle",value:function e(t,n,a){if(void 0!==n.handles&&void 0!==n.handles.points&&!1!==n.visible){for(var o=0;o<n.handles.points.length;o++){var r=p.default.cornerstone.pixelToCanvas(t,n.handles.points[o]);if(6>p.default.cornerstoneMath.point.distance(r,a))return o}if(n.handles.textBox&&Object(E.default)(n.handles.textBox,a))return n.handles.textBox}}},{key:"_pointNearHandleAllTools",value:function e(t){var n,a=t.currentPoints,o=t.element,r=a.canvas,i=Object(y.getToolState)(o,this.name);if(i){for(var l=0;l<i.data.length;l++)if(void 0!==(n=this._pointNearHandle(o,i.data[l],r)))return{handleNearby:n,toolIndex:l}}}},{key:"_getMouseLocation",value:function e(t){var n=t.currentPoints,a=t.image,o=this.configuration;o.mouseLocation.handles.start.x=n.image.x,o.mouseLocation.handles.start.y=n.image.y,Object(k.clipToBox)(o.mouseLocation.handles.start,a)}},{key:"_checkInvalidHandleLocation",value:function e(t,n){var a;if(t.handles.points.length<2)return!0;a=this._dragging?this._checkHandlesPencilMode(t,n):this._checkHandlesPolygonMode(t,n),t.handles.invalidHandlePlacement=a}},{key:"_checkHandlesPolygonMode",value:function e(t,n){var a=this.configuration,o=n.element,r=a.mouseLocation.handles.start,i=t.handles.points,l=!1;return t.canComplete=!1,this._isDistanceSmallerThanCompleteSpacingCanvas(o,i[0],r)&&!N.end(i)&&i.length>2?(t.canComplete=!0,l=!1):l=N.newHandle(r,i),l}},{key:"_checkHandlesPencilMode",value:function e(t,n){var a=this.configuration.mouseLocation.handles.start,o=t.handles.points,r=N.newHandle(a,o);return!1===r&&(r=this._invalidHandlePencilMode(t,n)),r}},{key:"_invalidHandlePencilMode",value:function e(t,n){var a=this.configuration,o=n.element,r=a.mouseLocation.handles.start,i=t.handles.points;if(this._isDistanceSmallerThanCompleteSpacingCanvas(o,i[0],r))return t.canComplete=!0,!1;t.canComplete=!1;for(var l=1;l<i.length-1;l++)if(this._isDistanceSmallerThanSpacing(o,i[l],r))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function e(t,n,a){var o,r=p.default.cornerstone.pixelToCanvas(t,n),i=p.default.cornerstone.pixelToCanvas(t,a);return"Mouse"===this._drawingInteractionType?o=this.configuration.completeHandleRadius:"Touch"===this._drawingInteractionType&&(o=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(t,r,i,"<",o)}},{key:"_isDistanceSmallerThanSpacing",value:function e(t,n,a){return this._compareDistanceToSpacing(t,n,a,"<")}},{key:"_isDistanceLargerThanSpacing",value:function e(t,n,a){return this._compareDistanceToSpacing(t,n,a,">")}},{key:"_compareDistanceToSpacing",value:function e(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:">",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;return">"===o?p.default.cornerstoneMath.point.distance(n,a)>r:p.default.cornerstoneMath.point.distance(n,a)<r}},{key:"_activateDraw",value:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=n,b.state.isMultiPartToolActive=!0,Object(D.hideToolCursor)(this.element),t.addEventListener($.default.MOUSE_DOWN,this._drawingMouseDownCallback),t.addEventListener($.default.MOUSE_MOVE,this._drawingMouseMoveCallback),t.addEventListener($.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),t.addEventListener($.default.MOUSE_DRAG,this._drawingMouseDragCallback),t.addEventListener($.default.MOUSE_UP,this._drawingMouseUpCallback),t.addEventListener($.default.TOUCH_START,this._drawingMouseMoveCallback),t.addEventListener($.default.TOUCH_START,this._drawingTouchStartCallback),t.addEventListener($.default.TOUCH_DRAG,this._drawingTouchDragCallback),t.addEventListener($.default.TOUCH_END,this._drawingMouseUpCallback),t.addEventListener($.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),p.default.cornerstone.updateImage(t)}},{key:"_deactivateDraw",value:function e(t){this._drawing=!1,b.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(D.setToolCursor)(this.element,this.svgCursor),t.removeEventListener($.default.MOUSE_DOWN,this._drawingMouseDownCallback),t.removeEventListener($.default.MOUSE_MOVE,this._drawingMouseMoveCallback),t.removeEventListener($.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),t.removeEventListener($.default.MOUSE_DRAG,this._drawingMouseDragCallback),t.removeEventListener($.default.MOUSE_UP,this._drawingMouseUpCallback),t.removeEventListener($.default.TOUCH_START,this._drawingTouchStartCallback),t.removeEventListener($.default.TOUCH_DRAG,this._drawingTouchDragCallback),t.removeEventListener($.default.TOUCH_START,this._drawingMouseMoveCallback),t.removeEventListener($.default.TOUCH_END,this._drawingMouseUpCallback),p.default.cornerstone.updateImage(t)}},{key:"_activateModify",value:function e(t){b.state.isToolLocked=!0,t.addEventListener($.default.MOUSE_UP,this._editMouseUpCallback),t.addEventListener($.default.MOUSE_DRAG,this._editMouseDragCallback),t.addEventListener($.default.MOUSE_CLICK,this._editMouseUpCallback),t.addEventListener($.default.TOUCH_END,this._editMouseUpCallback),t.addEventListener($.default.TOUCH_DRAG,this._editTouchDragCallback),p.default.cornerstone.updateImage(t)}},{key:"_deactivateModify",value:function e(t){b.state.isToolLocked=!1,t.removeEventListener($.default.MOUSE_UP,this._editMouseUpCallback),t.removeEventListener($.default.MOUSE_DRAG,this._editMouseDragCallback),t.removeEventListener($.default.MOUSE_CLICK,this._editMouseUpCallback),t.removeEventListener($.default.TOUCH_END,this._editMouseUpCallback),t.removeEventListener($.default.TOUCH_DRAG,this._editTouchDragCallback),p.default.cornerstone.updateImage(t)}},{key:"passiveCallback",value:function e(t){this._closeToolIfDrawing(t)}},{key:"enabledCallback",value:function e(t){this._closeToolIfDrawing(t)}},{key:"disabledCallback",value:function e(t){this._closeToolIfDrawing(t)}},{key:"_closeToolIfDrawing",value:function e(t){if(this._drawing){var n=this.configuration.currentHandle;this._endDrawing(t,n),p.default.cornerstone.updateImage(t)}}},{key:"fireModifiedEvent",value:function e(t,n){var a=$.default.MEASUREMENT_MODIFIED,o={toolName:this.name,element:t,measurementData:n};Object(w.default)(t,a,o)}},{key:"fireCompletedEvent",value:function e(t,n){var a=$.default.MEASUREMENT_COMPLETED,o={toolName:this.name,element:t,measurementData:n};Object(w.default)(t,a,o)}},{key:"cancelDrawing",value:function e(t){if(this._drawing){var n=Object(y.getToolState)(t,this.name),a=this.configuration,o=n.data[a.currentTool];o.active=!1,o.highlight=!1,o.handles.invalidHandlePlacement=!1,a.currentHandle=0,a.currentTool=-1,o.canComplete=!1,Object(y.removeToolState)(t,this.name,o),this._deactivateDraw(t),p.default.cornerstone.updateImage(t)}}},{key:"newImageCallback",value:function e(t){var n=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var a=t.detail.element,o=this._activeDrawingToolReference;o.active=!1,o.highlight=!1,o.handles.invalidHandlePlacement=!1;var r=o.handles.points;r[n.currentHandle-1].lines.push(r[0]),n.currentHandle=0,n.currentTool=-1,o.canComplete=!1,this._deactivateDraw(a),p.default.cornerstone.updateImage(a)}}},{key:"spacing",get:function e(){return this.configuration.spacing},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=t,p.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function e(){return this.configuration.activeHandleRadius},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=t,p.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function e(){return this.configuration.completeHandleRadius},set:function e(t){if("number"!=typeof t)throw Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=t,p.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function e(){return this.configuration.alwaysShowHandles},set:function e(t){if("boolean"!=typeof t)throw Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=t,p.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function e(){return this.configuration.invalidColor},set:function e(t){this.configuration.invalidColor=t,p.default.cornerstone.updateImage(this.element)}}]),t}(_.default);function q(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/LengthTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return E});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),m=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),g=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),v=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),$=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),p=n(/*! ./../../drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),_=n(/*! ./../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),y=n(/*! ./../../util/lineSegDistance.js */ "./util/lineSegDistance.js"),x=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),T=n(/*! ../../util/logger.js */ "./util/logger.js"),b=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),w=n(/*! ../../util/throttle */ "./util/throttle.js"),C=Object(T.getLogger)("tools:annotation:LengthTool"),E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:x.lengthCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(w.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){if(!(t&&t.currentPoints&&t.currentPoints.image)){C.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}var n=t.currentPoints.image,a=n.x,o=n.y;return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:a,y:o,highlight:!0,active:!1},end:{x:a,y:o,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a){var o;return n&&n.handles&&n.handles.start&&n.handles.end?!1!==n.visible&&25>Object(y.default)(t,n.handles.start,n.handles.end,a):(C.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"updateCachedStats",value:function e(t,n,a){var o=Object(b.default)(t),r=o.rowPixelSpacing,i=o.colPixelSpacing,l=(a.handles.end.x-a.handles.start.x)*(i||1),s=(a.handles.end.y-a.handles.start.y)*(r||1);a.length=Math.sqrt(l*l+s*s),a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail,o=this.configuration,r=o.handleRadius,i=o.drawHandlesOnHover,l=Object(m.getToolState)(t.currentTarget,this.name);if(l){for(var s=Object($.getNewContext)(a.canvasContext.canvas),u=a.image,d=a.element,c=Object(b.default)(u),f=c.rowPixelSpacing,h=c.colPixelSpacing,y=g.default.getToolWidth(),x=0;x<l.data.length;x++)if("continue"===function e(t){var o=l.data[t];if(!1===o.visible)return"continue";Object($.draw)(s,function(e){Object($.setShadow)(e,n.configuration);var t=v.default.getColorIfActive(o);if(Object($.drawLine)(e,d,o.handles.start,o.handles.end,{color:t}),Object(_.default)(e,a,o.handles,{color:t,handleRadius:r,drawHandlesIfActive:i}),!o.handles.textBox.hasMoved){var l={x:Math.max(o.handles.start.x,o.handles.end.x)};l.x===o.handles.start.x?l.y=o.handles.start.y:l.y=o.handles.end.y,o.handles.textBox.x=l.x,o.handles.textBox.y=l.y}!0===o.invalidated&&(o.length?n.throttledUpdateCachedStats(u,d,o):n.updateCachedStats(u,d,o));var s=function e(t,n,a){var o="mm";return n&&a||(o="pixels"),t.unit=o,"".concat(t.length.toFixed(2)," ").concat(o)}(o,f,h);Object(p.default)(e,d,o.handles.textBox,s,o.handles,T,t,y,10,!0)})}(x))continue}function T(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}}]),t}(h.default)},"./tools/annotation/ProbeTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return j});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),v=n(/*! ../../stateManagement/textStyle.js */ "./stateManagement/textStyle.js"),$=n(/*! ../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=n(/*! ../../drawing/index.js */ "./drawing/index.js"),_=n(/*! ../../drawing/drawTextBox.js */ "./drawing/drawTextBox.js"),y=n(/*! ../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),x=n(/*! ../../util/getRGBPixels.js */ "./util/getRGBPixels.js"),T=n(/*! ../../util/calculateSUV.js */ "./util/calculateSUV.js"),b=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),w=n(/*! ../../util/logger.js */ "./util/logger.js"),C=n(/*! ../../util/throttle */ "./util/throttle.js"),E=Object(w.getLogger)("tools:annotation:ProbeTool"),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:b.probeCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(C.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){if(!(t&&t.currentPoints&&t.currentPoints.image)){E.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0}}}}},{key:"pointNearTool",value:function e(t,n,a){var o=n&&n.handles&&n.handles.end;if(o||E.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!o||!1===n.visible)return!1;var r=h.default.cornerstone.pixelToCanvas(t,n.handles.end);return 5>h.default.cornerstoneMath.point.distance(r,a)}},{key:"updateCachedStats",value:function e(t,n,a){var o=Math.round(a.handles.end.x),r=Math.round(a.handles.end.y),i={};o>=0&&r>=0&&o<t.columns&&r<t.rows&&(i.x=o,i.y=r,t.color?i.storedPixels=Object(x.default)(n,o,r,1,1):(i.storedPixels=h.default.cornerstone.getStoredPixels(n,o,r,1,1),i.sp=i.storedPixels[0],i.mo=i.sp*t.slope+t.intercept,i.suv=Object(T.default)(t,i.sp))),a.cachedStats=i,a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=t.detail,o=this.configuration.handleRadius,r=Object(g.getToolState)(t.currentTarget,this.name);if(r){for(var i=Object(p.getNewContext)(a.canvasContext.canvas),l=a.image,s=a.element,u=v.default.getFontSize(),d=0;d<r.data.length;d++)if("continue"===function e(t){var d=r.data[t];if(!1===d.visible)return"continue";Object(p.draw)(i,function(e){var t,r,i=$.default.getColorIfActive(d);Object(y.default)(e,a,d.handles,{handleRadius:o,color:i}),!0===d.invalidated&&(d.cachedStats?n.throttledUpdateCachedStats(l,s,d):n.updateCachedStats(l,s,d));var c=d.cachedStats,f=c.x,m=c.y,g=c.storedPixels,v=c.sp,p=c.mo,x=c.suv;if(f>=0&&m>=0&&f<l.columns&&m<l.rows){t="".concat(f,", ").concat(m),l.color?r="R: ".concat(g[0]," G: ").concat(g[1]," B: ").concat(g[2]):(r="SP: ".concat(v," MO: ").concat(parseFloat(p.toFixed(3))),x&&(r+=" SUV: ".concat(parseFloat(x.toFixed(3)))));var T={x:d.handles.end.x+3,y:d.handles.end.y-3},b=h.default.cornerstone.pixelToCanvas(a.element,T);Object(_.default)(e,r,b.x,b.y+u+5,i),Object(_.default)(e,t,b.x,b.y,i)}})}(d))continue}}}]),t}(m.default)},"./tools/annotation/RectangleRoiTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return j});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./../../externalModules.js */ "./externalModules.js"),m=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),g=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),v=n(/*! ./../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),$=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),p=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),_=n(/*! ./../../util/calculateSUV.js */ "./util/calculateSUV.js"),y=n(/*! ../../util/getROITextBoxCoords.js */ "./util/getROITextBoxCoords.js"),x=n(/*! ./../../util/numbersWithCommas.js */ "./util/numbersWithCommas.js"),T=n(/*! ./../../util/throttle.js */ "./util/throttle.js"),b=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),w=n(/*! ../../util/logger.js */ "./util/logger.js"),C=n(/*! ../../util/getPixelSpacing */ "./util/getPixelSpacing.js"),E=Object(w.getLogger)("tools:annotation:RectangleRoiTool"),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{},svgCursor:b.rectangleRoiCursor};return(e=s()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(T.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){if(!(t&&t.currentPoints&&t.currentPoints.image)){E.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!1},end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0},initialRotation:t.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function e(t,n,a,o){var r=n&&n.handles&&n.handles.start&&n.handles.end;if(r||E.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===n.visible)return!1;var i=h.default.cornerstone.pixelToCanvas(t,n.handles.start),l=h.default.cornerstone.pixelToCanvas(t,n.handles.end),s={left:Math.min(i.x,l.x),top:Math.min(i.y,l.y),width:Math.abs(i.x-l.x),height:Math.abs(i.y-l.y)};return h.default.cornerstoneMath.rect.distanceToPoint(s,a)<("mouse"===o?15:25)}},{key:"updateCachedStats",value:function e(t,n,a){var o,r,i,l,s,u,d,c,f,m=(h.default.cornerstone.metaData.get("generalSeriesModule",t.imageId)||{}).modality,g=Object(C.default)(t),v=(o=t,r=n,i=a.handles,l=m,s=g,d=S(i.start,i.end),f=function e(t,n){for(var a=0,o=0,r=0,i=0,l=t?t[0]:null,s=t?t[0]:null,u=n.top;u<n.top+n.height;u++)for(var d=n.left;d<n.left+n.width;d++)a+=t[i],o+=t[i]*t[i],l=Math.min(l,t[i]),s=Math.max(s,t[i]),r++,i++;if(0===r)return{count:r,mean:0,variance:0,stdDev:0,min:0,max:0};var c=a/r,f=o/r-c*c;return{count:r,mean:c,variance:f,stdDev:Math.sqrt(f),min:l,max:s}}(h.default.cornerstone.getPixels(r,d.left,d.top,d.width,d.height),d),"PT"===l&&(u={mean:Object(_.default)(o,f.mean,!0)||0,stdDev:Object(_.default)(o,f.stdDev,!0)||0}),{area:d.width*(s.colPixelSpacing||1)*(d.height*(s.rowPixelSpacing||1))||0,count:f.count||0,mean:f.mean||0,variance:f.variance||0,stdDev:f.stdDev||0,min:f.min||0,max:f.max||0,meanStdDevSUV:u});a.cachedStats=v,a.invalidated=!1}},{key:"renderToolData",value:function e(t){var n=this,a=Object(g.getToolState)(t.currentTarget,this.name);if(a){var o=t.detail,r=o.image,i=o.element,l=v.default.getToolWidth(),s=this.configuration,u=s.handleRadius,d=s.drawHandlesOnHover,c=Object(p.getNewContext)(o.canvasContext.canvas),f=Object(C.default)(r),m=f.rowPixelSpacing,_=f.colPixelSpacing,x=(h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,T=m&&_;Object(p.draw)(c,function(e){for(var t=0;t<a.data.length;t++){var s=a.data[t];if(!1!==s.visible){var c=$.default.getColorIfActive(s),f={color:c,handleRadius:u,drawHandlesIfActive:d};if(Object(p.setShadow)(e,n.configuration),Object(p.drawRect)(e,i,s.handles.start,s.handles.end,{color:c},"pixel",s.handles.initialRotation),Object(p.drawHandles)(e,o,s.handles,f),!0===s.invalidated&&(s.cachedStats?n.throttledUpdateCachedStats(r,i,s):n.updateCachedStats(r,i,s)),!s.handles.textBox.hasMoved){var h=Object(y.default)(o.viewport,s.handles);Object.assign(s.handles.textBox,h)}var m=function e(t){return I(t.start,t.end)},g=M(e,r.color,s.cachedStats,x,T,n.configuration);s.unit=P(x,n.configuration.showHounsfieldUnits),Object(p.drawLinkedTextBox)(e,i,s.handles.textBox,g,s.handles,m,c,l,10,!0)}}})}}}]),t}(m.default);function S(e,t){return{left:Math.min(e.x,t.x),top:Math.min(e.y,t.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}}function I(e,t){var n=S(e,t),a=n.left,o=n.top,r=n.width,i=n.height;return[{x:a+r/2,y:o},{x:a,y:o+i/2},{x:a+r/2,y:o+i},{x:a+r,y:o+i/2}]}function P(e,t){return"CT"===e&&!1!==t?"HU":""}function M(e,t,n,a,o){var r,i,l,s=n.area,u=n.mean,d=n.stdDev,c=n.min,f=n.max,h=n.meanStdDevSUV,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},g=m.showMinMax||!1,v=[],$=[];if(!t){var p=h&&0!==h.mean,_=P(a,m.showHounsfieldUnits),y="Mean: ".concat(Object(x.default)(u.toFixed(2))," ").concat(_),T="Std Dev: ".concat(Object(x.default)(d.toFixed(2))," ").concat(_);if(p){for(var b=" SUV: ",w="".concat(b).concat(Object(x.default)(h.mean.toFixed(2))),C="".concat(b).concat(Object(x.default)(h.stdDev.toFixed(2))),E=Math.floor(e.measureText("".concat(T,"     ")).width);e.measureText(y).width<E;)y+=" ";$.push("".concat(y).concat(w)),$.push("".concat(T,"     ").concat(C))}else $.push("".concat(y,"     ").concat(T));if(g){for(var j="Min: ".concat(c," ").concat(_),S="Max: ".concat(f," ").concat(_),I=p?Math.floor(e.measureText("".concat(T,"     ")).width):Math.floor(e.measureText("".concat(y,"     ")).width);e.measureText(j).width<I;)j+=" ";$.push("".concat(j).concat(S))}}return v.push((r=s,l=(i=o)?" mm".concat("\xb2"):" px".concat("\xb2"),"Area: ".concat(Object(x.default)(r.toFixed(2))).concat(l))),$.forEach(function(e){return v.push(e)}),v}},"./tools/annotation/TextMarkerTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return b});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ../base/BaseAnnotationTool.js */ "./tools/base/BaseAnnotationTool.js"),v=n(/*! ./../../externalModules.js */ "./externalModules.js"),$=n(/*! ./../../util/pointInsideBoundingBox.js */ "./util/pointInsideBoundingBox.js"),p=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),_=n(/*! ./../../drawing/index.js */ "./drawing/index.js"),y=n(/*! ./../../drawing/drawTextBox.js */ "./drawing/drawTextBox.js"),x=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),T=n(/*! ../cursors/index.js */ "./tools/cursors/index.js"),b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var a={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:w},svgCursor:T.textMarkerCursor};return(e=s()(this,d()(t).call(this,n,a))).touchPressCallback=e._changeText.bind(f()(e)),e.doubleClickCallback=e._changeText.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){var n=this.configuration;if(n.current){var a={visible:!0,active:!0,text:n.current,color:void 0,handles:{end:{x:t.currentPoints.image.x,y:t.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},o={left:0,top:0,width:t.image.width,height:t.image.height};if(v.default.cornerstoneMath.point.insideRect(a.handles.end,o)){var r=n.markers.indexOf(n.current);return(r+=n.ascending?1:-1)>=n.markers.length?r=n.loop?0:-1:r<0&&(r=n.loop?n.markers.length:-1),n.current=n.markers[r],a}}}},{key:"pointNearTool",value:function e(t,n,a){if(!1===n.visible)return!1;if(n.handles.end.boundingBox){var o=v.default.cornerstoneMath.rect.distanceToPoint(n.handles.end.boundingBox,a),r=Object($.default)(n.handles.end,a);return o<10||r}}},{key:"updateCachedStats",value:function e(){}},{key:"renderToolData",value:function e(t){var n=t.detail,a=this.configuration,o=Object(x.getToolState)(n.element,this.name);if(o){for(var r=Object(_.getNewContext)(n.canvasContext.canvas),i=0;i<o.data.length;i++)if("continue"===function e(t){var i=o.data[t];if(!1===i.visible)return"continue";var l=p.default.getColorIfActive(i);Object(_.draw)(r,function(e){Object(_.setShadow)(e,a);var t=v.default.cornerstone.pixelToCanvas(n.element,i.handles.end);i.handles.end.boundingBox=Object(y.default)(e,i.text,t.x,t.y-10,l,{centering:{x:!0,y:!0}})})}(i))continue}}},{key:"_changeText",value:function e(t){var n,a=t.detail,o=a.element,r=a.currentPoints;function i(e,t,n){!0===n?Object(x.removeToolState)(o,this.name,e):e.text=t,e.active=!1,v.default.cornerstone.updateImage(o)}var l=this.configuration,s=r.canvas,u=Object(x.getToolState)(o,this.name);if(u){for(var d=0;d<u.data.length;d++)if(n=u.data[d],this.pointNearTool(o,n,s)){n.active=!0,v.default.cornerstone.updateImage(o),l.changeTextCallback(n,a,i),t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation();return}}}}]),t}(g.default),w=function e(t,n,a){a(t,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../externalModules.js */ "./externalModules.js"),o=n(/*! ./../../../events.js */ "./events.js"),r=n(/*! ./../../../manipulators/index.js */ "./manipulators/index.js"),i=n(/*! ./../../../manipulators/anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),l=n(/*! ./../../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),s=n(/*! ../../../util/triggerEvent.js */ "./util/triggerEvent.js"),u=n(/*! ../../../util/getActiveTool */ "./util/getActiveTool.js"),d=n(/*! ../../base/BaseAnnotationTool */ "./tools/base/BaseAnnotationTool.js");t.default=function(e,t){var n=this,f=e.detail,h=f.element,m=f.image,g=f.buttons,v=this.configuration;if(!c(m)){var $=this.createNewMeasurement(f),p=function e(){$.active=!1,a.default.cornerstone.updateImage(h)};Object(l.addToolState)(h,this.name,$),a.default.cornerstone.updateImage(h);var _=new Date().getTime(),y=$.handles,x=y.end,T=y.perpendicularStart;Object(r.moveNewHandle)(f,this.name,$,x,{doneMovingCallback:function e(){var r=$.handles,c=$.longestDiameter,y=$.shortestDiameter,x=Object(i.default)(f,r),b=parseFloat(c)||0,w=parseFloat(y)||0,C=new Date().getTime()-_<150;x||b<1||w<1||C?($.cancelled=!0,Object(l.removeToolState)(h,n.name,$)):v.getMeasurementLocationCallback($,f,p),T.locked=!1,$.invalidated=!0,a.default.cornerstone.updateImage(h);var E=Object(u.default)(h,g,t);E instanceof d.default&&E.updateCachedStats(m,h,$);var j={toolType:n.name,element:h,measurementData:$};Object(s.default)(h,o.default.MEASUREMENT_MODIFIED,j),Object(s.default)(h,o.default.MEASUREMENT_COMPLETED,j)}},t)}};var c=function e(t){var n=a.default.cornerstone.metaData.get("imagePlaneModule",t.imageId),o=t.rowPixelSpacing,r=t.columnPixelSpacing;return n&&(o=n.rowPixelSpacing||n.rowImagePixelSpacing,r=n.columnPixelSpacing||n.colImagePixelSpacing),!o||!r}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(e,t,n){n.r(t);var a=function e(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:t,y:n,index:a,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},o)};t.default=function(e){var t=e.currentPoints.image,n=t.x,o=t.y;return{toolType:this.name,isCreating:!0,visible:!0,active:!0,invalidated:!0,handles:{start:a(n,o,0),end:a(n,o,1,{active:!0}),perpendicularStart:a(n,o,2,{locked:!0}),perpendicularEnd:a(n,o,3),textBox:a(n-50,o-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0}}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(e,t,n){n.r(t),t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";"touch"===a?this.handleSelectedTouchCallback(e):this.handleSelectedMouseCallback(e)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n(/*! ./../../../externalModules.js */ "./externalModules.js"),i=n(/*! ../../../store/index.js */ "./store/index.js"),l=n(/*! ./../../../events.js */ "./events.js"),s=n(/*! ./../../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),u=n(/*! ./../../../manipulators/anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),d=n(/*! ./../../../manipulators/getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js"),c=n(/*! ./../../../manipulators/index.js */ "./manipulators/index.js"),f=n(/*! ./moveHandle/moveHandle.js */ "./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),h=n(/*! ./invertHandles.js */ "./tools/annotation/bidirectionalTool/invertHandles.js"),m=n(/*! ../../../store/setToolCursor.js */ "./store/setToolCursor.js");t.default=function(e){var t,n=this,a=e.detail,p=a.element,_=i.state.clickProximity,y=function e(o){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(s.removeToolState)(p,n.name,t),o&&(o.moving=!1,o.selected=!0),Object(m.setToolCursor)(n.element,n.svgCursor),r.default.cornerstone.updateImage(p),p.addEventListener(l.default.MOUSE_MOVE,n._moveCallback),p.addEventListener(l.default.TOUCH_START,n._moveCallback)},x=a.startPoints.canvas,T=Object(s.getToolState)(e.currentTarget,this.name);if(T){for(var b=function o(r){var i=[p,(t=T.data[r]).handles,x,_],s=d.default.apply(void 0,i);if(s)return p.removeEventListener(l.default.MOUSE_MOVE,n._moveCallback),p.removeEventListener(l.default.TOUCH_START,n._moveCallback),t.active=!0,g(t.handles),s.moving=!0,(s=Object(h.default)(a,t,s)).hasBoundingBox||Object(m.hideToolCursor)(n.element),Object(f.default)(a,n.name,t,s,function(){return y(s)}),$(e),{v:!0}},w=0;w<T.data.length;w++){var C=b(w);if("object"===o()(C))return C.v}for(var E=function e(t){return function(){v(t,!1),y()}},w=0;w<T.data.length;w++)if(t=T.data[w],this.pointNearTool(p,t,x,"mouse")){p.removeEventListener(l.default.MOUSE_MOVE,this._moveCallback),p.removeEventListener(l.default.TOUCH_START,this._moveCallback),t.active=!0,g(t.handles),v(t.handles,!0);var j=E(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,doneMovingCallback:j},"mouse"),$(e),!0}}};var g=function e(t){var n=!1;return Object.keys(t).forEach(function(e){"textBox"!==e&&(t[e].selected=!1,n=t[e].active||n,t[e].active=!1)}),n},v=function e(t,n){Object.keys(t).forEach(function(e){"textBox"!==e&&(t[e].moving=n)})},$=function e(t){t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n(/*! ./../../../externalModules.js */ "./externalModules.js"),i=n(/*! ../../../store/index.js */ "./store/index.js"),l=n(/*! ./../../../events.js */ "./events.js"),s=n(/*! ./../../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),u=n(/*! ./../../../manipulators/anyHandlesOutsideImage.js */ "./manipulators/anyHandlesOutsideImage.js"),d=n(/*! ./../../../manipulators/getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js"),c=n(/*! ./../../../manipulators/index.js */ "./manipulators/index.js"),f=n(/*! ./moveHandle/touchMoveHandle.js */ "./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");t.default=function(e){var t,n=this,a=e.detail,v=a.element,$=i.state.touchProximity,p=function e(o){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(s.removeToolState)(v,n.name,t),o&&(o.moving=!1,o.selected=!0),r.default.cornerstone.updateImage(v),v.addEventListener(l.default.TOUCH_DRAG,n._moveCallback)},_=a.startPoints.canvas,y=Object(s.getToolState)(e.currentTarget,this.name);if(y){for(var x=function o(r){var i=[v,(t=y.data[r]).handles,_,$],s=d.default.apply(void 0,i);if(s)return v.removeEventListener(l.default.TOUCH_DRAG,n._moveCallback),t.active=!0,h(t.handles),s.moving=!0,Object(f.default)(a,n.name,t,s,function(){return p(s)}),g(e),{v:!0}},T=0;T<y.data.length;T++){var b=x(T);if("object"===o()(b))return b.v}for(var w=function e(t){return function(){m(t,!1),p()}},T=0;T<y.data.length;T++)if(t=y.data[T],this.pointNearTool(v,t,_,"touch")){v.removeEventListener(l.default.TOUCH_DRAG,this._moveCallback),t.active=!0,h(t.handles),m(t.handles,!0);var C=w(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,doneMovingCallback:C},"touch"),g(e),!0}}};var h=function e(t){var n=!1;return Object.keys(t).forEach(function(e){"textBox"!==e&&(t[e].selected=!1,n=t[e].active||n,t[e].active=!1)}),n},m=function e(t,n){Object.keys(t).forEach(function(e){"textBox"!==e&&(t[e].moving=n)})},g=function e(t){t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return r});var a=function e(t,n,a){var o=t[a],r=n[a];t[a]=r,n[a]=o},o=function e(t,n){a(t,n,"x"),a(t,n,"y"),a(t,n,"moving"),a(t,n,"hover"),a(t,n,"active"),a(t,n,"selected")};function r(e,t,n){var a=e.image,r=a.rowPixelSpacing,i=a.columnPixelSpacing,l=t.handles,s=l.start,u=l.end,d=l.perpendicularStart,c=l.perpendicularEnd,f=(s.x-u.x)*(i||1),h=(s.y-u.y)*(r||1),m=(d.x-c.x)*(i||1),g=(d.y-c.y)*(r||1);return(Math.sqrt(m*m+g*g)||0)>Math.sqrt(f*f+h*h)?(o(s,u),o(s,d),o(u,c),Object.values(l).find(function(e){return!0===e.moving})):n}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../externalModules.js */ "./externalModules.js"),o=n(/*! ./../../../stateManagement/toolCoordinates.js */ "./stateManagement/toolCoordinates.js"),r=n(/*! ./../../../manipulators/getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js"),i=n(/*! ./../../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),l=function e(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,i=Object(r.default)(t,n,a,o),l=!1;return Object.keys(n).forEach(function(e){if("textBox"!==e){var t=n[e],a=t===i;t.active!==a&&(l=!0),t.active=a}}),l};t.default=function(e){var t=this,n=e.detail,r=n.element;o.default.setCoords(n);var s=Object(i.getToolState)(r,this.name);if(s){for(var u=!1,d=0;d<s.data.length;d++)!function e(a){var o=n.currentPoints.canvas,i=s.data[a],d=l(r,i.handles,o);Object.keys(i.handles).forEach(function(e){if("textBox"!==e){var t=i.handles[e];t.hover=t.active}}),d&&(u=!0);var c=t.pointNearTool(r,i,o,"mouse"),f=c&&!i.active,h=!c&&i.active;(f||h)&&(i.active=!i.active,u=!0)}(d);!0===u&&a.default.cornerstone.updateImage(r)}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js"),o=n(/*! ../../../../store/index.js */ "./store/index.js"),r=n(/*! ./../../../../events.js */ "./events.js"),i=n(/*! ./setHandlesPosition.js */ "./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),l=n(/*! ../../../../util/getActiveTool */ "./util/getActiveTool.js"),s=n(/*! ../../../base/BaseAnnotationTool */ "./tools/base/BaseAnnotationTool.js");t.default=function(e,t,n,u,d,c){var f=e.element,h=e.image,m=e.buttons,g={x:u.x-e.currentPoints.image.x,y:u.y-e.currentPoints.image.y},v=function e(o){var d=o.detail;u.hasMoved=!0,void 0===u.index||null===u.index?(u.x=d.currentPoints.image.x+g.x,u.y=d.currentPoints.image.y+g.y):Object(i.default)(u,d,n,g),c&&(u.x=Math.max(u.x,0),u.x=Math.min(u.x,d.image.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,d.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(f);var v=Object(l.default)(f,m,"mouse");v instanceof s.default&&v.updateCachedStats(h,f,n),a.default.cornerstone.triggerEvent(f,r.default.MEASUREMENT_MODIFIED,{toolType:t,element:f,measurementData:n})};u.active=!0,o.state.isToolLocked=!0,f.addEventListener(r.default.MOUSE_DRAG,v),f.addEventListener(r.default.TOUCH_DRAG,v);var $=a.default.cornerstone.getImage(f),p=function e(){a.default.cornerstone.getImage(f).imageId!==$.imageId&&_()};f.addEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,p);var _=function e(){u.active=!1,o.state.isToolLocked=!1,f.removeEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,p),f.removeEventListener(r.default.MOUSE_DRAG,v),f.removeEventListener(r.default.MOUSE_UP,e),f.removeEventListener(r.default.MOUSE_CLICK,e),f.removeEventListener(r.default.TOUCH_DRAG,v),f.removeEventListener(r.default.TOUCH_DRAG_END,e),f.removeEventListener(r.default.TAP,e),a.default.cornerstone.updateImage(f),"function"==typeof d&&d()};f.addEventListener(r.default.MOUSE_UP,_),f.addEventListener(r.default.MOUSE_CLICK,_),f.addEventListener(r.default.TOUCH_DRAG_END,_),f.addEventListener(r.default.TAP,_)}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedLeft.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,o=t.handles,r=o.start,i=o.end,l=o.perpendicularStart,s=o.perpendicularEnd,u={start:{x:r.x,y:r.y},end:{x:i.x,y:i.y}},d={start:{x:l.x,y:l.y},end:{x:s.x,y:s.y}},c=a.default.cornerstoneMath.lineSegment.intersectLine(u,d),f=n(l,c),h=n(s,c),m=n(i,c),g=n(i,e);if(g<=m)return!1;var v=(i.x-e.x)/g,$=(i.y-e.y)/g,p=m/g,_={x:i.x+(e.x-i.x)*p,y:i.y+(e.y-i.y)*p};return l.x=_.x-f*$,l.y=_.y+f*v,s.x=_.x+h*$,s.y=_.y-h*v,!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedRight.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,o=t.handles,r=o.start,i=o.end,l=o.perpendicularStart,s=o.perpendicularEnd,u={start:{x:r.x,y:r.y},end:{x:i.x,y:i.y}},d={start:{x:l.x,y:l.y},end:{x:s.x,y:s.y}},c=a.default.cornerstoneMath.lineSegment.intersectLine(u,d),f=n(l,c),h=n(s,c),m=n(r,c),g=n(r,e);if(g<=m)return!1;var v=(r.x-e.x)/g,$=(r.y-e.y)/g,p=m/g,_={x:r.x+(e.x-r.x)*p,y:r.y+(e.y-r.y)*p};return l.x=_.x+f*$,l.y=_.y-f*v,s.x=_.x-h*$,s.y=_.y+h*v,!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularLeftFixedPoint.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,o=t.handles,r=o.start,i=o.end,l=o.perpendicularStart,s=o.perpendicularEnd,u=s,d=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,u),c=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,e),f=n(u,e),h=d+c;if(f<=d)return!1;var m=n(r,i);if(0===m)return!1;var g=(r.x-i.x)/m,v=(r.y-i.y)/m,$={x:r.x-1*g,y:r.y-1*v},p={x:i.x+1*g,y:i.y+1*v};l.x=e.x,l.y=e.y,s.x=e.x-h*v,s.y=e.y+h*g;var _={start:{x:r.x,y:r.y},end:{x:i.x,y:i.y}},y={start:{x:l.x,y:l.y},end:{x:s.x,y:s.y}};return a.default.cornerstoneMath.lineSegment.intersectLine(_,y)||(n(e,r)>n(e,i)?(l.x=p.x+c*v,l.y=p.y-c*g,s.x=l.x-h*v,s.y=l.y+h*g):(l.x=$.x+c*v,l.y=$.y-c*g,s.x=l.x-h*v,s.y=l.y+h*g)),!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularRightFixedPoint.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,o=t.handles,r=o.start,i=o.end,l=o.perpendicularStart,s=o.perpendicularEnd,u=l,d=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,u),c=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,e),f=n(u,e),h=d+c;if(f<=d)return!1;var m=n(r,i),g=(r.x-i.x)/m,v=(r.y-i.y)/m,$={x:r.x-1*g,y:r.y-1*v},p={x:i.x+1*g,y:i.y+1*v};l.x=e.x+h*v,l.y=e.y-h*g,s.x=e.x,s.y=e.y,s.locked=!1,l.locked=!1;var _={start:{x:r.x,y:r.y},end:{x:i.x,y:i.y}},y={start:{x:l.x,y:l.y},end:{x:s.x,y:s.y}};return a.default.cornerstoneMath.lineSegment.intersectLine(_,y)||(n(e,r)>n(e,i)?(s.x=p.x-c*v,s.y=p.y+c*g,l.x=s.x+h*v,l.y=s.y-h*g):(s.x=$.x-c*v,s.y=$.y+c*g,l.x=s.x+h*v,l.y=s.y-h*g)),!0}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js"),o=n(/*! ./perpendicularBothFixedLeft.js */ "./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedLeft.js"),r=n(/*! ./perpendicularBothFixedRight.js */ "./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedRight.js"),i=n(/*! ./perpendicularLeftFixedPoint.js */ "./tools/annotation/bidirectionalTool/moveHandle/perpendicularLeftFixedPoint.js"),l=n(/*! ./perpendicularRightFixedPoint.js */ "./tools/annotation/bidirectionalTool/moveHandle/perpendicularRightFixedPoint.js");t.default=function(e,t,n,s){var u,d,c,f,h,m,g={},v={},$={x:t.currentPoints.image.x+s.x,y:t.currentPoints.image.y+s.y};0===e.index?(c=Object(o.default)($,n))?(e.x=$.x,e.y=$.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):1===e.index?(c=Object(r.default)($,n))?(e.x=$.x,e.y=$.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):2===e.index?(d=!1,g.start={x:n.handles.start.x,y:n.handles.start.y},g.end={x:n.handles.end.x,y:n.handles.end.y},v.start={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},v.end={x:$.x,y:$.y},(f=a.default.cornerstoneMath.lineSegment.intersectLine(g,v))||(v.end={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},f=a.default.cornerstoneMath.lineSegment.intersectLine(g,v),h=a.default.cornerstoneMath.point.distance(f,n.handles.start),m=a.default.cornerstoneMath.point.distance(f,n.handles.end),(!f||h<3||m<3)&&(d=!0)),u=!1,d||(u=Object(i.default)($,n))||(t.currentPoints.image.x=n.handles.perpendicularStart.x,t.currentPoints.image.y=n.handles.perpendicularStart.y)):3!==e.index||(d=!1,g.start={x:n.handles.start.x,y:n.handles.start.y},g.end={x:n.handles.end.x,y:n.handles.end.y},v.start={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},v.end={x:$.x,y:$.y},(f=a.default.cornerstoneMath.lineSegment.intersectLine(g,v))||(v.end={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},f=a.default.cornerstoneMath.lineSegment.intersectLine(g,v),h=a.default.cornerstoneMath.point.distance(f,n.handles.start),m=a.default.cornerstoneMath.point.distance(f,n.handles.end),(!f||h<3||m<3)&&(d=!0)),u=!1,d||(u=Object(l.default)($,n))||(t.currentPoints.image.x=n.handles.perpendicularEnd.x,t.currentPoints.image.y=n.handles.perpendicularEnd.y))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(e,t,n){n.r(t);var a=n(/*! ./../../../../externalModules.js */ "./externalModules.js"),o=n(/*! ../../../../store/index.js */ "./store/index.js"),r=n(/*! ./../../../../events.js */ "./events.js"),i=n(/*! ./setHandlesPosition.js */ "./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),l=n(/*! ../../../../util/getActiveTool */ "./util/getActiveTool.js"),s=n(/*! ../../../base/BaseAnnotationTool */ "./tools/base/BaseAnnotationTool.js"),u=[r.default.TOUCH_END,r.default.TOUCH_DRAG_END,r.default.TOUCH_PINCH,r.default.TOUCH_PRESS,r.default.TAP];t.default=function(e,t,n,d,c,f){var h=e.element,m=e.image,g=e.buttons,v={x:d.x-e.currentPoints.image.x,y:d.y-e.currentPoints.image.y},$=function e(o){var u=o.detail;d.hasMoved=!0,void 0===d.index||null===d.index?(d.x=u.currentPoints.image.x+v.x,d.y=u.currentPoints.image.y+v.y):Object(i.default)(d,u,n,v),f&&(d.x=Math.max(d.x,0),d.x=Math.min(d.x,u.image.width),d.y=Math.max(d.y,0),d.y=Math.min(d.y,u.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(h);var c=Object(l.default)(h,g,"touch");c instanceof s.default&&c.updateCachedStats(m,h,n),a.default.cornerstone.triggerEvent(h,r.default.MEASUREMENT_MODIFIED,{toolType:t,element:h,measurementData:n})};d.active=!0,o.state.isToolLocked=!0,h.addEventListener(r.default.TOUCH_DRAG,$);var p=function e(){d.active=!1,o.state.isToolLocked=!1,h.removeEventListener(r.default.TOUCH_DRAG,$),u.forEach(function(t){h.removeEventListener(t,e)}),a.default.cornerstone.updateImage(h),"function"==typeof c&&c()};u.forEach(function(e){h.addEventListener(e,p)})}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(e,t,n){n.r(t);var a=n(/*! ../../../store/index.js */ "./store/index.js"),o=n(/*! ./../../../externalModules.js */ "./externalModules.js"),r=n(/*! ./../../../util/pointInsideBoundingBox.js */ "./util/pointInsideBoundingBox.js"),i=function e(t,n,a,r){var i=o.default.cornerstone,l=o.default.cornerstoneMath,s={start:i.pixelToCanvas(t,n.perpendicularStart),end:i.pixelToCanvas(t,n.perpendicularEnd)};return l.lineSegment.distanceToPoint(s,a)<r};t.default=function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",s=o.default.cornerstone,u=o.default.cornerstoneMath,d=t.handles,c={start:s.pixelToCanvas(e,d.start),end:s.pixelToCanvas(e,d.end)},f=u.lineSegment.distanceToPoint(c,n);if(Object(r.default)(d.textBox,n))return!0;var h="mouse"===l?a.state.clickProximity:a.state.touchProximity;return!!i(e,d,n,h)||f<h}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/toConsumableArray */ "../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a),r=n(/*! ./../../../drawing/drawHandles.js */ "./drawing/drawHandles.js"),i=n(/*! ./utils/updatePerpendicularLineHandles.js */ "./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),l=n(/*! ./../../../stateManagement/toolStyle.js */ "./stateManagement/toolStyle.js"),s=n(/*! ./../../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),u=n(/*! ./../../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),d=n(/*! ./../../../drawing/index.js */ "./drawing/index.js"),c=n(/*! ./../../../drawing/drawLinkedTextBox.js */ "./drawing/drawLinkedTextBox.js"),f=n(/*! ../../../util/getPixelSpacing */ "./util/getPixelSpacing.js");t.default=function(e){var t,n=this,a=e.detail,o=a.element,m=a.canvasContext,g=a.image,v=this.configuration,$=v.handleRadius,p=v.drawHandlesOnHover,_=Object(u.getToolState)(o,this.name);if(_){var y=Object(f.default)(g),x=y.rowPixelSpacing,T=y.colPixelSpacing;if(x&&T){for(var b=Object(d.getNewContext)(m.canvas),w=s.default.getActiveColor(),C=l.default.getToolWidth(),E=0;E<_.data.length;E++)if("continue"===function e(l){var u=_.data[l];if(!1===u.visible)return"continue";t=u.active?w:s.default.getToolColor(),!0===u.invalidated&&(u.longestDiameter&&u.shortestDiameter?n.throttledUpdateCachedStats(g,o,u):n.updateCachedStats(g,o,u)),Object(d.draw)(b,function(e){Object(d.setShadow)(e,n.configuration);var l=u.handles,s=l.start,f=l.end,m=l.perpendicularStart,g=l.perpendicularEnd,v=l.textBox;Object(d.drawLine)(e,o,s,f,{color:t}),Object(i.default)(a,u),Object(d.drawLine)(e,o,m,g,{color:t,strokeWidth:C});var _={color:t,handleRadius:$,drawHandlesIfActive:p};Object(r.default)(e,a,u.handles,_);var y=function e(t){return[t.start,t.end,t.perpendicularStart,t.perpendicularEnd]},b=h(u,x,T);Object(c.default)(e,o,v,b,u.handles,y,t,C,10,!0)})}(E))continue}}};var h=function e(t,n,a){var r=" mm";n&&a||(r=" pixels");var i=" L ".concat(t.longestDiameter).concat(r),l=" W ".concat(t.shortestDiameter).concat(r),s=t.labels;return s&&Array.isArray(s)?[].concat(o()(s),[i,l]):[i,l]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(e,t,n){function a(e,t){var n=t.rowPixelSpacing,a=t.colPixelSpacing,o=e.handles,r=o.start,i=o.end,l=o.perpendicularStart,s=o.perpendicularEnd,u=(r.x-i.x)*(a||1),d=(r.y-i.y)*(n||1),c=Math.sqrt(u*u+d*d),f=(l.x-s.x)*(a||1),h=(l.y-s.y)*(n||1),m=Math.sqrt(f*f+h*h);if(m||(m=0),m>c){var g=c;c=m,m=g}return{longestDiameter:c.toFixed(1),shortestDiameter:m.toFixed(1)}}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(e,t,n){n.r(t),t.default=function(e,t){if(t.handles.perpendicularStart.locked){var n,a,o,r,i=t.handles,l=i.start,s=i.end;if(l.x===s.x&&l.y===s.y)n=l.x,a=l.y,o=s.x,r=s.y;else{var u={x:(l.x+s.x)/2,y:(l.y+s.y)/2},d=(l.x-s.x)*(e.image.columnPixelSpacing||1),c=(l.y-s.y)*(e.image.rowPixelSpacing||1),f=Math.sqrt(d*d+c*c),h=(l.x-s.x)/f,m=(l.y-s.y)/f,g=f/2;n=u.x+g/2*m,a=u.y-g/2*h,o=u.x-g/2*m,r=u.y+g/2*h}t.handles.perpendicularStart.x=n,t.handles.perpendicularStart.y=a,t.handles.perpendicularEnd.x=o,t.handles.perpendicularEnd.y=r}}},"./tools/annotation/index.js":function(e,t,n){n.r(t);var a=n(/*! ./AngleTool.js */ "./tools/annotation/AngleTool.js"),o=n(/*! ./ArrowAnnotateTool.js */ "./tools/annotation/ArrowAnnotateTool.js"),r=n(/*! ./BidirectionalTool.js */ "./tools/annotation/BidirectionalTool.js"),i=n(/*! ./CircleRoiTool.js */ "./tools/annotation/CircleRoiTool.js"),l=n(/*! ./CobbAngleTool.js */ "./tools/annotation/CobbAngleTool.js"),s=n(/*! ./EllipticalRoiTool.js */ "./tools/annotation/EllipticalRoiTool.js"),u=n(/*! ./FreehandMouseTool.js */ "./tools/annotation/FreehandMouseTool.js"),d=n(/*! ./LengthTool.js */ "./tools/annotation/LengthTool.js"),c=n(/*! ./ProbeTool.js */ "./tools/annotation/ProbeTool.js"),f=n(/*! ./RectangleRoiTool.js */ "./tools/annotation/RectangleRoiTool.js"),h=n(/*! ./TextMarkerTool.js */ "./tools/annotation/TextMarkerTool.js");n.d(t,"AngleTool",function(){return a.default}),n.d(t,"ArrowAnnotateTool",function(){return o.default}),n.d(t,"BidirectionalTool",function(){return r.default}),n.d(t,"CircleRoiTool",function(){return i.default}),n.d(t,"CobbAngleTool",function(){return l.default}),n.d(t,"EllipticalRoiTool",function(){return s.default}),n.d(t,"FreehandMouseTool",function(){return u.default}),n.d(t,"LengthTool",function(){return d.default}),n.d(t,"ProbeTool",function(){return c.default}),n.d(t,"RectangleRoiTool",function(){return f.default}),n.d(t,"TextMarkerTool",function(){return h.default}),t.default={AngleTool:a.default,ArrowAnnotateTool:o.default,BidirectionalTool:r.default,CircleRoiTool:i.default,CobbAngleTool:l.default,EllipticalRoiTool:s.default,FreehandMouseTool:u.default,LengthTool:d.default,ProbeTool:c.default,RectangleRoiTool:f.default,TextMarkerTool:h.default}},"./tools/base/BaseAnnotationTool.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n(/*! ./BaseTool.js */ "./tools/base/BaseTool.js"),m=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),g=n(/*! ./../../manipulators/handleActivator.js */ "./manipulators/handleActivator.js"),v=n(/*! ./../../util/findAndMoveHelpers.js */ "./util/findAndMoveHelpers.js"),$=n(/*! ../../util/logger */ "./util/logger.js"),p=Object($.getLogger)("baseAnnotationTool"),_=function(e){function t(){return o()(this,t),s()(this,d()(t).apply(this,arguments))}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function e(t){throw Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function e(t,n,a){throw Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function e(t,n,a){throw Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function e(t){throw Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function e(t){for(var n=t.detail,a=n.element,o=n.currentPoints.canvas,r=Object(m.getToolState)(a,this.name),i=!1,l=0;l<r.data.length;l++){var s=r.data[l];!0===Object(g.default)(a,s.handles,o)&&(i=!0);var u=this.pointNearTool(a,s,o,"mouse")&&!s.active,d=!this.pointNearTool(a,s,o,"mouse")&&s.active;(u||d)&&(s.active=!s.active,i=!0)}return i}},{key:"handleSelectedCallback",value:function e(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";Object(v.moveHandleNearImagePoint)(t,this,n,a,o)}},{key:"toolSelectedCallback",value:function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";Object(v.moveAnnotation)(t,this,n,a)}},{key:"updateCachedStats",value:function e(t,n,a){p.warn("updateCachedStats not implemented for ".concat(this.name,"."))}}]),t}(h.default);t.default=_},"./tools/base/BaseBrushTool.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ./BaseTool.js */ "./tools/base/BaseTool.js"),v=n(/*! ./../../events.js */ "./events.js"),$=n(/*! ./../../externalModules.js */ "./externalModules.js"),p=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),_=n(/*! ../../stateManagement/imageIdSpecificStateManager.js */ "./stateManagement/imageIdSpecificStateManager.js"),y=n(/*! ./../../store/isToolActive.js */ "./store/isToolActive.js"),x=n(/*! ./../../store/index.js */ "./store/index.js"),T=n(/*! ./../../util/triggerEvent.js */ "./util/triggerEvent.js"),b=x.default.modules.brush,w=b.state,C=b.getters,E=b.setters,j=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o()(this,t),a.configuration||(a.configuration={skipPaintForInvisibleSegmentations:!1}),a.configuration.referencedToolData="brush",(n=s()(this,d()(t).call(this,e,a))).updateOnMouseMove=!0,n.hideDefaultCursor=!0,n._drawing=!1,n._drawingMouseUpCallback=n._drawingMouseUpCallback.bind(f()(n)),n}return m()(t,e),i()(t,[{key:"renderBrush",value:function e(t){throw Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function e(t){throw Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function e(t){this._startPainting(t)}},{key:"preMouseDownCallback",value:function e(t){return this._startPainting(t),!0}},{key:"_startPainting",value:function e(t){var n=t.detail,a=n.element;this._paint(t),this._drawing=!0,this._startListeningForMouseUp(a),this._lastImageCoords=n.currentPoints.image}},{key:"mouseMoveCallback",value:function e(t){var n=t.detail.currentPoints;this._lastImageCoords=n.image}},{key:"passiveCallback",value:function e(t){try{$.default.cornerstone.updateImage(this.element)}catch(n){return}}},{key:"renderToolData",value:function e(t){var n=t.detail.element;Object(y.default)(n,this.name)&&this.renderBrush(t)}},{key:"_getBrushColor",value:function e(t){var n=$.default.cornerstone.colors.getColormap(w.colorMapId).getColor(t);return this._drawing?"rgba(".concat(n[[0]],", ").concat(n[[1]],", ").concat(n[[2]],", 1.0 )"):"rgba(".concat(n[[0]],", ").concat(n[[1]],", ").concat(n[[2]],", 0.8 )")}},{key:"_drawingMouseUpCallback",value:function e(t){this._drawing=!1,this._mouseUpRender=!0;var n,a,o,r,i,l=t.detail.element,s=(Object(p.getToolState)(l,this.name)||Object(p.getToolState)(l,"brush")||{}).data,u=w.drawColorId;if(!this.configuration.skipPaintForInvisibleSegmentations||(n=l,a=u,o=s,r=$.default.cornerstone.getEnabledElement(n),i=C.visibleSegmentationsForElement(r.uuid),w.alpha>.001&&!0===i[a]&&(void 0===o[a]||void 0===o[a].alpha||o[a].alpha>.001))){var d=null;s&&s.length>u&&(d=s[u]);var c={toolName:this.name,element:l,measurementData:d,evtDetail:t.detail};Object(T.default)(l,v.default.MEASUREMENT_COMPLETED,c)}this._stopListeningForMouseUp(l)}},{key:"_startListeningForMouseUp",value:function e(t){t.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),t.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),t.addEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),t.addEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),$.default.cornerstone.updateImage(t)}},{key:"_stopListeningForMouseUp",value:function e(t){t.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),t.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),$.default.cornerstone.updateImage(t)}},{key:"nextSegmentation",value:function e(){var t=this.constructor.getNumberOfColors(),n=w.drawColorId+1;n===t&&(n=0),w.drawColorId=n}},{key:"previousSegmentation",value:function e(){var t=this.constructor.getNumberOfColors(),n=w.drawColorId-1;n<0&&(n=t-1),w.drawColorId=n}},{key:"increaseBrushSize",value:function e(){var t=w.radius,n=Math.floor(1.2*t);n===t&&(n+=1),E.radius(n)}},{key:"decreaseBrushSize",value:function e(){var t=w.radius;E.radius(Math.floor(.8*t))}},{key:"showSegmentationOnElement",value:function e(t){var n=this._getEnabledElement(),a=n.uuid;E.brushVisibilityForElement(a,t,!0),$.default.cornerstone.updateImage(n.element)}},{key:"hideSegmentationOnElement",value:function e(t){var n=this._getEnabledElement(),a=n.uuid;E.brushVisibilityForElement(a,t,!1),$.default.cornerstone.updateImage(n.element)}},{key:"showAllSegmentationsOnElement",value:function e(){for(var t=this._getEnabledElement(),n=t.uuid,a=$.default.cornerstone.colors.getColormap(w.colorMapId).getNumberOfColors(),o=0;o<a;o++)E.brushVisibilityForElement(n,o,!0);$.default.cornerstone.updateImage(t.element)}},{key:"hideAllSegmentationsOnElement",value:function e(){for(var t=this._getEnabledElement(),n=t.uuid,a=$.default.cornerstone.colors.getColormap(w.colorMapId).getNumberOfColors(),o=0;o<a;o++)E.brushVisibilityForElement(n,o,!1);$.default.cornerstone.updateImage(t.element)}},{key:"_getEnabledElement",value:function e(){return $.default.cornerstone.getEnabledElement(this.element)}},{key:"alpha",get:function e(){return w.alpha},set:function e(t){var n=this._getEnabledElement();w.alpha=t,$.default.cornerstone.updateImage(n.element)}},{key:"hiddenButActiveAlpha",get:function e(){return w.hiddenButActiveAlpha},set:function e(t){var n=this._getEnabledElement();w.hiddenButActiveAlpha=t,$.default.cornerstone.updateImage(n.element)}}],[{key:"getNumberOfColors",value:function e(){return $.default.cornerstone.colors.getColormap(w.colorMapId).getNumberOfColors()}},{key:"getReferencedToolDataName",value:function e(){return"brush"}},{key:"invalidateBrushOnEnabledElement",value:function e(t){var n=x.default.getters.enabledElementByUID(t),a=Object(p.getToolState)(n,"stack");if(a){for(var o=a.data[0].imageIds,r=_.globalImageIdSpecificToolStateManager.saveToolState(),i=0;i<o.length;i++){var l=o[i];if(r[l]&&r[l].brush)for(var s=r[l].brush.data,u=0;u<s.length;u++)s[u].pixelData&&(s[u].invalidated=!0)}$.default.cornerstone.updateImage(n,!0)}}},{key:"getDataAsVolume",value:function e(t){var n=x.default.getters.enabledElementByUID(t),a=Object(p.getToolState)(n,"stack");if(a)for(var o=a.data[0].imageIds,r=_.globalImageIdSpecificToolStateManager.saveToolState(),i=0;i<o.length;i++){var l=o[i];r[l]&&r[l].brush&&r[l].brush.data[0].pixelData}}}]),t}(g.default);t.default=j},"./tools/base/BaseTool.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),s=n.n(l),u=n(/*! ./../../mixins/index.js */ "./mixins/index.js"),d=n(/*! ../../util/logger.js */ "./util/logger.js"),c=n(/*! ./../../util/deepmerge.js */ "./util/deepmerge.js"),f=Object(d.getLogger)("tools:base:BaseTool"),h=function(){function e(t,n){i()(this,e),this.initialConfiguration=Object(c.default)(n,t);var a=this.initialConfiguration,o=a.name,r=a.strategies,l=a.defaultStrategy,s=a.configuration,u=a.supportedInteractionTypes,d=a.mixins,f=a.svgCursor;this.name=o,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=u||[],this.strategies=r||{},this.defaultStrategy=l||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,f&&(this.svgCursor=f),this._options={},this._configuration=Object.assign({},s),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,d&&d.length&&this._applyMixins(d)}return s()(e,[{key:"mergeOptions",value:function e(t){this._options=Object.assign({},this._options,t)}},{key:"clearOptions",value:function e(){this._options={}}},{key:"applyActiveStrategy",value:function e(t){return this.strategies[this.activeStrategy](t,this.configuration)}},{key:"_applyMixins",value:function e(t){for(var n=0;n<t.length;n++){var a=u.default["".concat(t[n])];"object"===o()(a)?Object.assign(this,a):f.warn("".concat(this.name,": mixin ").concat(u.default[n]," does not exist."))}}},{key:"configuration",get:function e(){return this._configuration},set:function e(t){this._configuration=t}},{key:"options",get:function e(){return this._options}}],[{key:"configuration",get:function e(){}}]),e}();t.default=h},"./tools/brush/BrushTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return C});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! @babel/runtime/helpers/possibleConstructorReturn */ "../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),s=n.n(l),u=n(/*! @babel/runtime/helpers/getPrototypeOf */ "../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n(/*! @babel/runtime/helpers/assertThisInitialized */ "../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n(/*! @babel/runtime/helpers/inherits */ "../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n(/*! ./../../externalModules.js */ "./externalModules.js"),v=n(/*! ./../base/BaseBrushTool.js */ "./tools/base/BaseBrushTool.js"),$=n(/*! ./../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),p=n(/*! ./../../store/index.js */ "./store/index.js"),_=n(/*! ./../../util/brush/index.js */ "./util/brush/index.js"),y=n(/*! ./../../util/triggerEvent.js */ "./util/triggerEvent.js"),x=n(/*! ../../events.js */ "./events.js"),T=_.default.drawBrushPixels,b=_.default.getCircle,w=p.default.modules.brush,C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),(e=s()(this,d()(t).call(this,n,{name:"Brush",supportedInteractionTypes:["Mouse","Touch"],strategies:{overlapping:E,nonOverlapping:j},defaultStrategy:"overlapping",configuration:{alwaysEraseOnClick:!1,skipPaintForInvisibleSegmentations:!1}}))).touchDragCallback=e._paint.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderBrush",value:function e(t){var n,a=t.detail,o=a.viewport;if(this._drawing?n=this._lastImageCoords:this._mouseUpRender?(n=this._lastImageCoords,this._mouseUpRender=!1):n=p.default.state.mousePositionImage,n){var r=a.image,i=r.rows,l=r.columns,s=n,u=s.x,d=s.y;if(!(u<0)&&!(u>l)&&!(d<0)&&!(d>i)){var c=w.state.radius,f=a.canvasContext,h=a.element,m=w.state.drawColorId,v=this._getBrushColor(m);f.setTransform(1,0,0,1,0,0);var $=g.default.cornerstone,_=c*o.scale,y=$.pixelToCanvas(h,n);f.beginPath(),f.strokeStyle=v,f.ellipse(y.x,y.y,_,_,0,0,2*Math.PI),f.stroke()}}}},{key:"_paint",value:function e(t){var n,a,o,r,i,l,s,u=t.detail.element,d=(n=u,a=Object($.getToolState)(n,v.default.getReferencedToolDataName()),a||(Object($.addToolState)(n,v.default.getReferencedToolDataName(),{}),a=Object($.getToolState)(n,v.default.getReferencedToolDataName())),a).data,c=w.state.drawColorId;if((!(this.configuration.alwaysEraseOnClick||I(t.detail))||d[c])&&(!this.configuration.skipPaintForInvisibleSegmentations||(o=u,r=c,i=d,l=g.default.cornerstone.getEnabledElement(o),s=w.getters.visibleSegmentationsForElement(l.uuid),w.state.alpha>.001&&!0===s[r]&&(void 0===i[r]||void 0===i[r].alpha||i[r].alpha>.001))))this.applyActiveStrategy(t,this.configuration),Object(y.default)(t.detail.element,x.default.MEASUREMENT_MODIFIED,t.detail),g.default.cornerstone.updateImage(t.detail.element)}}]),t}(v.default);function E(e,t){var n=e.detail,a=n.element,o=n.image,r=o.rows,i=o.columns,l=n.currentPoints.image,s=l.x,u=l.y,d=Object($.getToolState)(a,v.default.getReferencedToolDataName()).data;!(s<0)&&!(s>i)&&!(u<0)&&!(u>r)&&S(n,d,b(w.state.radius,r,i,s,u),t)}function j(e,t){var n=e.detail,a=n.element,o=n.image,r=o.rows,i=o.columns,l=n.currentPoints.image,s=l.x,u=l.y,d=Object($.getToolState)(a,v.default.getReferencedToolDataName()).data,c=w.state.drawColorId;if(!(s<0)&&!(s>i)&&!(u<0)&&!(u>r)){for(var f=b(w.state.radius,r,i,s,u),h=v.default.getNumberOfColors(),m=0;m<h;m++)m!==c&&d[m]&&d[m].pixelData&&(T(f,d[m],i,!0),d[m].invalidated=!0);S(n,d,f,t)}}function S(e,t,n,a){var o=a.alwaysEraseOnClick||I(e),r=w.state.drawColorId;if(t[r]||(t[r]={}),!t[r].pixelData){var i=g.default.cornerstone.getEnabledElement(e.element).uuid,l=w.getters.imageBitmapCacheForElement(i);l&&(l[r]=null),t[r].pixelData=new Uint8ClampedArray(e.image.width*e.image.height)}var s=t[r];T(n,s,e.image.columns,o),s.invalidated=!0}function I(e){return e.event&&e.event.ctrlKey||e.ctrlKey}},"./tools/brush/index.js":function(e,t,n){n.r(t);var a=n(/*! ./BrushTool.js */ "./tools/brush/BrushTool.js");n.d(t,"BrushTool",function(){return a.default}),t.default={BrushTool:a.default}},"./tools/cursors/MouseCursor.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return u});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! ../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),s=n(/*! ../../store/index.js */ "./store/index.js").modules.cursor,u=function(){function e(t,n){o()(this,e),this.iconGroupString=t,this.options=Object.assign({},s.getters.defaultOptions(),n)}return i()(e,[{key:"getIconSVG",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this._generateIconSVGString(t);return new Blob([n],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(t)}},{key:"getIconWithPointerSVG",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this._generateIconWithPointerSVGString(t);return new Blob([n],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(t)}},{key:"_generateIconWithPointerSVGString",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},this.options,t),a=n.mousePointerGroupString,o=n.iconSize,r=n.viewBox,i=o/Math.max(r.x,r.y),l=16+o,s='\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(l,'" height="').concat(l,'" viewBox="0 0 ').concat(l," ").concat(l,'"\n      >\n        <g>\n          ').concat(a,'\n        </g>\n        <g transform="translate(16, 16) scale(').concat(i,')">\n          ').concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(s,n)}},{key:"_generateIconSVGString",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},this.options,t),a=n.iconSize,o=n.viewBox,r='\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(a,'" height="').concat(a,'" viewBox="0 0\n        ').concat(o.x," ").concat(o.y,'"\n      >\n        ').concat(this.iconGroupString,"\n      </svg>");return this._injectColors(r,n)}},{key:"_injectColors",value:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.activeColor||l.default.getActiveColor(),o=n.toolColor||l.default.getToolColor(),r=n.fillColor||l.default.getFillColor();return t.replace(/ACTIVE_COLOR/g,"".concat(a)).replace(/TOOL_COLOR/g,"".concat(o)).replace(/FILL_COLOR/g,"".concat(r))}},{key:"mousePoint",get:function e(){var t=this.options.mousePoint;return"".concat(t.x," ").concat(t.y)}}]),e}()},"./tools/cursors/index.js":function(e,t,n){n.r(t),n.d(t,"angleCursor",function(){return o}),n.d(t,"arrowAnnotateCursor",function(){return r}),n.d(t,"bidirectionalCursor",function(){return i}),n.d(t,"cobbAngleCursor",function(){return l}),n.d(t,"circleRoiCursor",function(){return s}),n.d(t,"ellipticalRoiCursor",function(){return u}),n.d(t,"freehandMouseCursor",function(){return d}),n.d(t,"freehandSculpterMouseCursor",function(){return c}),n.d(t,"lengthCursor",function(){return f}),n.d(t,"probeCursor",function(){return h}),n.d(t,"rectangleRoiCursor",function(){return m}),n.d(t,"textMarkerCursor",function(){return g}),n.d(t,"crosshairsCursor",function(){return v}),n.d(t,"eraserCursor",function(){return $}),n.d(t,"magnifyCursor",function(){return p}),n.d(t,"panCursor",function(){return _}),n.d(t,"rotateCursor",function(){return y}),n.d(t,"stackScrollCursor",function(){return x}),n.d(t,"wwwcRegionCursor",function(){return T}),n.d(t,"wwwcCursor",function(){return b}),n.d(t,"zoomCursor",function(){return w});var a=n(/*! ./MouseCursor.js */ "./tools/cursors/MouseCursor.js"),o=new a.default('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />',{viewBox:{x:1792,y:1792}}),r=new a.default('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',{viewBox:{x:24,y:24}}),i=new a.default('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',{viewBox:{x:48,y:48}}),l=new a.default('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',{viewBox:{x:32,y:32}}),s=new a.default('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',{viewBox:{x:32,y:32}}),u=new a.default('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />',{viewBox:{x:32,y:32}}),d=new a.default('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',{viewBox:{x:18,y:18}}),c=new a.default('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>',{viewBox:{x:18,y:18}}),f=new a.default('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',{viewBox:{x:24,y:24}}),h=new a.default('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />',{viewBox:{x:1792,y:1792}}),m=new a.default('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),g=new a.default('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />',{viewBox:{x:1792,y:1792}}),v=new a.default('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />',{viewBox:{x:1792,y:1792}}),$=new a.default('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />',{viewBox:{x:2048,y:1792}}),p=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />',{viewBox:{x:512,y:512}}),_=new a.default('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />',{viewBox:{x:1792,y:1792}}),y=new a.default('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />',{viewBox:{x:1792,y:1792}}),x=new a.default('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />',{viewBox:{x:24,y:28}}),T=new a.default('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),b=new a.default('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />',{viewBox:{x:18,y:18}}),w=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />',{viewBox:{x:640,y:512}})},"./tools/index.js":function(e,t,n){n.r(t);var a=n(/*! ./CrosshairsTool.js */ "./tools/CrosshairsTool.js");n.d(t,"CrosshairsTool",function(){return a.default});var o=n(/*! ./DoubleTapFitToWindowTool.js */ "./tools/DoubleTapFitToWindowTool.js");n.d(t,"DoubleTapFitToWindowTool",function(){return o.default});var r=n(/*! ./DragProbeTool.js */ "./tools/DragProbeTool.js");n.d(t,"DragProbeTool",function(){return r.default});var i=n(/*! ./EraserTool.js */ "./tools/EraserTool.js");n.d(t,"EraserTool",function(){return i.default});var l=n(/*! ./FreehandSculpterMouseTool.js */ "./tools/FreehandSculpterMouseTool.js");n.d(t,"FreehandSculpterMouseTool",function(){return l.default});var s=n(/*! ./MagnifyTool.js */ "./tools/MagnifyTool.js");n.d(t,"MagnifyTool",function(){return s.default});var u=n(/*! ./PanMultiTouchTool.js */ "./tools/PanMultiTouchTool.js");n.d(t,"PanMultiTouchTool",function(){return u.default});var d=n(/*! ./PanTool.js */ "./tools/PanTool.js");n.d(t,"PanTool",function(){return d.default});var c=n(/*! ./ReferenceLinesTool.js */ "./tools/ReferenceLinesTool.js");n.d(t,"ReferenceLinesTool",function(){return c.default});var f=n(/*! ./RotateTool.js */ "./tools/RotateTool.js");n.d(t,"RotateTool",function(){return f.default});var h=n(/*! ./RotateTouchTool.js */ "./tools/RotateTouchTool.js");n.d(t,"RotateTouchTool",function(){return h.default});var m=n(/*! ./ScaleOverlayTool.js */ "./tools/ScaleOverlayTool.js");n.d(t,"ScaleOverlayTool",function(){return m.default});var g=n(/*! ./StackScrollMouseWheelTool.js */ "./tools/StackScrollMouseWheelTool.js");n.d(t,"StackScrollMouseWheelTool",function(){return g.default});var v=n(/*! ./StackScrollMultiTouchTool.js */ "./tools/StackScrollMultiTouchTool.js");n.d(t,"StackScrollMultiTouchTool",function(){return v.default});var $=n(/*! ./StackScrollTool.js */ "./tools/StackScrollTool.js");n.d(t,"StackScrollTool",function(){return $.default});var p=n(/*! ./WwwcRegionTool.js */ "./tools/WwwcRegionTool.js");n.d(t,"WwwcRegionTool",function(){return p.default});var _=n(/*! ./WwwcTool.js */ "./tools/WwwcTool.js");n.d(t,"WwwcTool",function(){return _.default});var y=n(/*! ./ZoomMouseWheelTool.js */ "./tools/ZoomMouseWheelTool.js");n.d(t,"ZoomMouseWheelTool",function(){return y.default});var x=n(/*! ./ZoomTool.js */ "./tools/ZoomTool.js");n.d(t,"ZoomTool",function(){return x.default});var T=n(/*! ./ZoomTouchPinchTool.js */ "./tools/ZoomTouchPinchTool.js");n.d(t,"ZoomTouchPinchTool",function(){return T.default}),t.default={CrosshairsTool:a.default,DoubleTapFitToWindowTool:o.default,DragProbeTool:r.default,EraserTool:i.default,FreehandSculpterMouseTool:l.default,MagnifyTool:s.default,PanMultiTouchTool:u.default,PanTool:d.default,ReferenceLinesTool:c.default,RotateTool:f.default,RotateTouchTool:h.default,ScaleOverlayTool:m.default,StackScrollMouseWheelTool:g.default,StackScrollMultiTouchTool:v.default,StackScrollTool:$.default,WwwcRegionTool:p.default,WwwcTool:_.default,ZoomMouseWheelTool:y.default,ZoomTool:x.default,ZoomTouchPinchTool:T.default}},"./tools/referenceLines/calculateReferenceLine.js":function(e,t,n){n.r(t);var a=n(/*! ./../../util/pointProjector.js */ "./util/pointProjector.js");t.default=function(e,t){var n=Object(a.planePlaneIntersection)(e,t);if(n)return{start:Object(a.projectPatientPointToImagePlane)(n.start,e),end:Object(a.projectPatientPointToImagePlane)(n.end,e)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(e,t,n){n.r(t);var a=n(/*! ./../../externalModules.js */ "./externalModules.js"),o=n(/*! ./calculateReferenceLine.js */ "./tools/referenceLines/calculateReferenceLine.js"),r=n(/*! ./../../stateManagement/toolColors.js */ "./stateManagement/toolColors.js"),i=n(/*! ./../../util/convertToVector3.js */ "./util/convertToVector3.js"),l=n(/*! ./../../drawing/index.js */ "./drawing/index.js");t.default=function(e,t,n,s){var u=a.default.cornerstone,d=u.getEnabledElement(n).image,c=u.getEnabledElement(s).image;if(d&&c){var f=u.metaData.get("imagePlaneModule",d.imageId),h=u.metaData.get("imagePlaneModule",c.imageId);if(f&&h&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&h.rowCosines&&h.columnCosines&&h.imagePositionPatient&&f.frameOfReferenceUID===h.frameOfReferenceUID){f.rowCosines=Object(i.default)(f.rowCosines),f.columnCosines=Object(i.default)(f.columnCosines),f.imagePositionPatient=Object(i.default)(f.imagePositionPatient),h.rowCosines=Object(i.default)(h.rowCosines),h.columnCosines=Object(i.default)(h.columnCosines),h.imagePositionPatient=Object(i.default)(h.imagePositionPatient);var m=f.rowCosines.clone().cross(f.columnCosines),g=h.rowCosines.clone().cross(h.columnCosines),v=m.angleTo(g);if(!((v=Math.abs(v))<.5)){var $=Object(o.default)(f,h);if($){var p=r.default.getActiveColor();e.setTransform(1,0,0,1,0,0),Object(l.draw)(e,function(e){Object(l.drawLine)(e,t.element,$.start,$.end,{color:p})})}}}}}},"./util/SaveAs.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=e.querySelector("canvas");if(a.msToBlob){var o=a.msToBlob();return window.navigator.msSaveBlob(o,t)}var r=document.createElement("a");if(r.download=t,r.href=a.toDataURL(n,1),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(i)}else r.fireEvent&&r.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(e,t,n){n.r(t),t.default=function(e,t,n){var a,o=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));return{angle:180*Math.acos((Math.pow(o,2)+Math.pow(r,2)-Math.pow(Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),2))/(2*o*r))/Math.PI,direction:(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)}}},"./util/brush/drawBrush.js":function(e,t,n){n.r(t),n.d(t,"drawBrushPixels",function(){return r}),n.d(t,"drawBrushOnCanvas",function(){return i});var a=n(/*! ../../externalModules.js */ "./externalModules.js"),o=n(/*! ../../drawing/index.js */ "./drawing/index.js");function r(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.pixelData;e.forEach(function(e){var t,r;o[t=e[0],(r=e[1])*n+t]=a?0:1}),a&&!o.some(function(e){return 0!==e})&&delete t.pixelData}function i(e,t,n,r){var i=a.default.cornerstone.pixelToCanvas(r,{x:0,y:0}),l=a.default.cornerstone.pixelToCanvas(r,{x:1,y:1}),s=l.x-i.x,u=l.y-i.y;Object(o.draw)(t,function(t){e.forEach(function(e){var i=a.default.cornerstone.pixelToCanvas(r,{x:e[0],y:e[1]}),l={left:i.x,top:i.y,width:s,height:u};Object(o.fillBox)(t,l,n)})})}},"./util/brush/getCircle.js":function(e,t,n){function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=Math.floor(a),i=Math.floor(o);if(1===e)return[[r,i]];for(var l=[],s=0,u=-e;u<=e;u++){var d=i+u;if(!(d>t)&&!(d<0))for(var c=-e;c<=e;c++){var f=r+c;!(f>=n)&&!(f<0)&&c*c+u*u<e*e&&(l[s++]=[r+c,i+u])}}return l}n.r(t),n.d(t,"default",function(){return a})},"./util/brush/index.js":function(e,t,n){n.r(t);var a=n(/*! ./drawBrush.js */ "./util/brush/drawBrush.js"),o=n(/*! ./getCircle.js */ "./util/brush/getCircle.js");t.default={drawBrushPixels:a.drawBrushPixels,drawBrushOnCanvas:a.drawBrushOnCanvas,getCircle:o.default}},"./util/calculateSUV.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");function o(e){return parseFloat(".".concat(e))}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=a.default.cornerstone,i=r.metaData.get("patientStudyModule",e.imageId),l=r.metaData.get("generalSeriesModule",e.imageId);if(i&&l&&"PT"===l.modality){var s=n?t:t*e.slope+e.intercept,u=i.patientWeight;if(u){var d=r.metaData.get("petIsotopeModule",e.imageId);if(d){var c=d.radiopharmaceuticalInfo,f=c.radiopharmaceuticalStartTime,h=c.radionuclideTotalDose,m=c.radionuclideHalfLife,g=l.seriesTime;if(f&&h&&m&&g){var v=o(g.fractionalSeconds||0)+g.seconds+60*g.minutes+3600*g.hours,$=o(f.fractionalSeconds)+f.seconds+60*f.minutes+3600*f.hours;return s*u/(h*Math.exp(-(v-$)*Math.log(2)/m))*1e3}}}}}},"./util/clip.js":function(e,t,n){function a(e,t,n){return Math.min(Math.max(t,e),n)}function o(e,t){e.x=a(e.x,0,t.width),e.y=a(e.y,0,t.height)}n.r(t),n.d(t,"default",function(){return a}),n.d(t,"clipToBox",function(){return o})},"./util/convertToVector3.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return o});var a=n(/*! ../externalModules.js */ "./externalModules.js");function o(e){var t=a.default.cornerstoneMath;return e instanceof t.Vector3?e:new t.Vector3(e[0],e[1],e[2])}},"./util/copyPoints.js":function(e,t,n){function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{x:t.x,y:t.y}}n.r(t),t.default=function(e){var t=a(e.page),n=a(e.image),o=a(e.client),r=a(e.canvas);return{page:t,image:n,client:o,canvas:r}}},"./util/debounce.js":function(e,t,n){n.r(t);var a=n(/*! ./isObject.js */ "./util/isObject.js");t.default=function e(t,n,o){var r,i,l,s,u,d,c=0,f=!1,h=!1,m=!0,g=!n&&0!==n&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof t)throw TypeError("Expected a function");function v(e){var n=r,a=i;return r=i=void 0,c=e,s=t.apply(a,n)}function $(e,t){return g?window.requestAnimationFrame(e):setTimeout(e,t)}function p(e){var t=e-d,a=e-c;return void 0===d||t>=n||t<0||h&&a>=l}function _(){var e,t,a,o,r=Date.now();if(p(r))return y(r);u=$(_,(t=(e=r)-d,a=e-c,o=n-t,h?Math.min(o,l-a):o))}function y(e){return(u=void 0,m&&r)?v(e):(r=i=void 0,s)}function x(){for(var e,t=Date.now(),a=p(t),o=arguments.length,l=Array(o),m=0;m<o;m++)l[m]=arguments[m];if(r=l,i=this,d=t,a){if(void 0===u)return c=e=d,u=$(_,n),f?v(e):s;if(h)return u=$(_,n),v(d)}return void 0===u&&(u=$(_,n)),s}return n=Number(n)||0,Object(a.default)(o)&&(f=Boolean(o.leading),l=(h="maxWait"in o)?Math.max(Number(o.maxWait)||0,n):l,m="trailing"in o?Boolean(o.trailing):m),x.cancel=function e(){void 0!==u&&function e(t){if(g)return window.cancelAnimationFrame(t);clearTimeout(t)}(u),c=0,r=d=i=u=void 0},x.flush=function e(){return void 0===u?s:y(Date.now())},x.pending=function e(){return void 0!==u},x}},"./util/debugLib/common.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/toConsumableArray */ "../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(a);t.default=function e(t){function a(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){var t;function n(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];if(n.enabled){var i=n,l=Number(new Date),s=l-(t||l);i.diff=s,i.prev=t,i.curr=l,t=l,a[0]=r.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;u++;var n=r.formatters[t];if("function"==typeof n){var o=a[u];e=n.call(i,o),a.splice(u,1),u--}return e}),r.formatArgs.call(i,a),(i.log||r.log).apply(i,a)}}return n.namespace=e,n.enabled=r.enabled(e),n.useColors=r.useColors(),n.color=a(e),n.destroy=i,n.extend=l,"function"==typeof r.init&&r.init(n),r.instances.push(n),n}function i(){var e=r.instances.indexOf(this);return -1!==e&&(r.instances.splice(e,1),!0)}function l(e,t){var n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function e(t){return t instanceof Error?t.stack||t.message:t},r.disable=function e(){var t=[].concat(o()(r.names.map(s)),o()(r.skips.map(s).map(function(e){return"-"+e}))).join(",");return r.enable(""),t},r.enable=function e(t){r.save(t),r.names=[],r.skips=[];var n,a=("string"==typeof t?t:"").split(/[\s,]+/),o=a.length;for(n=0;n<o;n++)a[n]&&("-"===(t=a[n].replace(/\*/g,".*?"))[0]?r.skips.push(RegExp("^"+t.substr(1)+"$")):r.names.push(RegExp("^"+t+"$")));for(n=0;n<r.instances.length;n++){var i=r.instances[n];i.enabled=r.enabled(i.namespace)}},r.enabled=function e(t){var n,a;if("*"===t[t.length-1])return!0;for(n=0,a=r.skips.length;n<a;n++)if(r.skips[n].test(t))return!1;for(n=0,a=r.names.length;n<a;n++)if(r.names[n].test(t))return!0;return!1},r.humanize=n(/*! ms */ "../node_modules/ms/index.js"),Object.keys(t).forEach(function(e){r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=a,r.enable(r.load()),r}},"./util/debugLib/index.js":function(e,t,n){n.r(t),(function(e){var a,o=n(/*! ./common.js */ "./util/debugLib/common.js"),r={formatArgs:function e(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+r.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var a=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(a++,"%c"===e&&(o=a))}),t.splice(o,0,n)}},save:function e(t){try{t?r.storage.setItem("debug",t):r.storage.removeItem("debug")}catch(n){}},load:function t(){var n;try{n=r.storage.getItem("debug")}catch(a){console.warn(a)}return!n&&void 0!==e&&"env"in e&&(n=e.env.DEBUG),n},useColors:function e(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},storage:function e(){try{return localStorage}catch(t){}}()};r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||function(){};var i=Object(o.default)(r);i.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.default=i}).call(this,n(/*! ./../../../node_modules/process/browser.js */ "../node_modules/process/browser.js"))},"./util/deepmerge.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a),r=function e(t){return t&&"object"===o()(t)&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)},i=function e(t,n){var a;return n&&!0===n.clone&&r(t)?u((a=t,Array.isArray(a)?[]:{}),t,n):t},l=function e(t,n,a){var o=t.slice();return n.forEach(function(e,n){void 0===o[n]?o[n]=i(e,a):r(e)?o[n]=u(t[n],e,a):-1===t.indexOf(e)&&o.push(i(e,a))}),o},s=function e(t,n,a){var o={};return r(t)&&Object.keys(t).forEach(function(e){o[e]=i(t[e],a)}),Object.keys(n).forEach(function(e){r(n[e])&&t[e]?o[e]=u(t[e],n[e],a):o[e]=i(n[e],a)}),o},u=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=Array.isArray(n),r=(a||{arrayMerge:l}).arrayMerge||l;return o?Array.isArray(t)?r(t,n,a):i(n,a):s(t,n,a)};t.default=u},"./util/ellipse/calculateEllipseStatistics.js":function(e,t,n){n.r(t);var a=n(/*! ./pointInEllipse.js */ "./util/ellipse/pointInEllipse.js");t.default=function(e,t){for(var n=0,o=0,r=0,i=0,l=null,s=null,u=t.top;u<t.top+t.height;u++)for(var d=t.left;d<t.left+t.width;d++){var c={x:d,y:u};Object(a.default)(t,c)&&(null===l&&(l=e[i],s=e[i]),n+=e[i],o+=e[i]*e[i],l=Math.min(l,e[i]),s=Math.max(s,e[i]),r++),i++}if(0===r)return{count:r,mean:0,variance:0,stdDev:0,min:0,max:0};var f=n/r,h=o/r-f*f;return{count:r,mean:f,variance:h,stdDev:Math.sqrt(h),min:l,max:s}}},"./util/ellipse/index.js":function(e,t,n){n.r(t);var a=n(/*! ./calculateEllipseStatistics.js */ "./util/ellipse/calculateEllipseStatistics.js");n.d(t,"calculateEllipseStatistics",function(){return a.default});var o=n(/*! ./pointInEllipse.js */ "./util/ellipse/pointInEllipse.js");n.d(t,"pointInEllipse",function(){return o.default}),t.default={calculateEllipseStatistics:a.default,pointInEllipse:o.default}},"./util/ellipse/pointInEllipse.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=e.width/2,a=e.height/2;if(n<=0||a<=0)return!1;var o={x:e.left+n,y:e.top+a},r={x:t.x-o.x,y:t.y-o.y};return r.x*r.x/(n*n)+r.y*r.y/(a*a)<=1}},"./util/findAndMoveHelpers.js":function(e,t,n){n.r(t),n.d(t,"moveHandleNearImagePoint",function(){return i}),n.d(t,"findHandleDataNearImagePoint",function(){return l}),n.d(t,"moveAnnotation",function(){return s});var a=n(/*! ../store/index.js */ "./store/index.js"),o=n(/*! ../manipulators/getHandleNearImagePoint.js */ "./manipulators/getHandleNearImagePoint.js"),r=n(/*! ./../manipulators/index.js */ "./manipulators/index.js"),i=function e(t,n,o,i,l){o.active=!0,a.state.isToolLocked=!0,Object(r.moveHandle)(t.detail,n.name,o,i,n.options,l),t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()},l=function e(t,n,r,i){for(var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mouse",s=0;s<n.data.length;s++){var u=n.data[s],d=Object(o.default)(t,u.handles,i,"mouse"===l?a.state.clickProximity:a.state.touchProximity);if(d)return{handle:d,data:u}}},s=function e(t,n,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",l=Object.assign({},{doneMovingCallback:function e(){o.active=!1,a.state.isToolLocked=!1}},n.options);o.active=!0,a.state.isToolLocked=!0,Object(r.moveAllHandles)(t.detail,n.name,o,null,l,i),t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()}},"./util/freehand/ClickedLineData.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return r});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=function e(t,n){o()(this,e),this.toolIndex=t,this.handleIndexArray=n}},"./util/freehand/FreehandHandleData.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return r});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=function e(t){var n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];o()(this,e),this.x=t.x,this.y=t.y,this.highlight=n,this.active=a,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return d});var a=n(/*! @babel/runtime/helpers/classCallCheck */ "../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n(/*! @babel/runtime/helpers/createClass */ "../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),s=n(/*! ../../externalModules.js */ "./externalModules.js"),u=n(/*! ./ClickedLineData.js */ "./util/freehand/ClickedLineData.js"),d=function(){function e(t,n){o()(this,e),this._eventData=t,this._toolName=n}return i()(e,[{key:"findLine",value:function e(){var t=this.findTool();if(null===t)return null;var n=this._getCloseLinesInTool(t);return n?this._findCorrectLine(t,n):null}},{key:"findTool",value:function e(){return(this._toolData=Object(l.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,this._toolData)?(0,this._nearestHandleToPointAllTools().toolIndex):null}},{key:"_nearestHandleToPointAllTools",value:function e(){for(var t=this._toolData,n={toolIndex:null,handleIndex:null,distance:1/0},a=0;a<t.data.length;a++){var o=this._nearestHandleToPoint(a);null!==o&&o.distance<n.distance&&(n=o)}return n}},{key:"_nearestHandleToPoint",value:function e(t){var n=this._eventData,a=this._toolData.data[t],o=a.handles.points;if(void 0===o||!1===a.visible)return null;for(var r={toolIndex:t,handleIndex:null,distance:1/0},i=0;i<o.length;i++){var l=s.default.cornerstone.pixelToCanvas(n.element,o[i]),u=s.default.cornerstoneMath.point.distance(l,this._mousePoint);u<r.distance&&(r.handleIndex=i,r.distance=u)}return r}},{key:"_getCloseLinesInTool",value:function t(n){for(var a=this._toolData.data[n].handles.points,o=[],r=0;r<a.length;r++){var i=e.getNextHandleIndex(r,a.length);10>this._distanceOfPointfromLine(a[r],a[i])&&o.push([r,i])}return o}},{key:"_findCorrectLine",value:function e(t,n){for(var a=0;a<n.length;a++)if(this._pointProjectsToLineSegment(t,n[a]))return new u.default(t,n[a]);return null}},{key:"_pointProjectsToLineSegment",value:function t(n,a){var o=this._eventData,r=this._toolData.data[n],i=r.handles.points;if(void 0!==r.handles.points){if(!1===r.visible)return!1;var l=i[a[0]],s=i[a[1]],u=e.getCanvasPointsFromHandles(l,s,o.element),d=e.getLineAsVector(u),c=this._getLineOriginToMouseAsVector(u),f=(c[0]*d[0]+c[1]*d[1])/d.magnitude;return!!(f>0)&&!!(f<d.magnitude)}}},{key:"_getLineOriginToMouseAsVector",value:function e(t){return[this._mousePoint.x-t[0].x,this._mousePoint.y-t[0].y]}},{key:"_distanceOfPointfromLine",value:function e(t,n){var a,o=this._eventData,r=s.default.cornerstone.pixelToCanvas(o.element,t),i=s.default.cornerstone.pixelToCanvas(o.element,n),l=this._mousePoint,u=Math.abs((i.y-r.y)*l.x-(i.x-r.x)*l.y+i.x*r.y-i.y*r.x);return u/s.default.cornerstoneMath.point.distance(r,i)}}],[{key:"getCanvasPointsFromHandles",value:function e(t,n,a){var o=[];return t.x<n.x?(o.push(s.default.cornerstone.pixelToCanvas(a,t)),o.push(s.default.cornerstone.pixelToCanvas(a,n))):(o.push(s.default.cornerstone.pixelToCanvas(a,n)),o.push(s.default.cornerstone.pixelToCanvas(a,t))),o}},{key:"getLineAsVector",value:function e(t){var n=[t[1].x-t[0].x,t[1].y-t[0].y];return n.magnitude=s.default.cornerstoneMath.point.distance(t[0],t[1]),n}},{key:"getNextHandleIndex",value:function e(t,n){var a;return t<n-1?t+1:0}}]),e}()},"./util/freehand/addLine.js":function(e,t,n){n.r(t),t.default=function(e,t){t===e.length-1?e[t].lines.push(e[0]):e[t].lines.push(e[t+1])}},"./util/freehand/calculateFreehandStatistics.js":function(e,t,n){n.r(t);var a=n(/*! ./pointInFreehand.js */ "./util/freehand/pointInFreehand.js");function o(e,t,n,o){Object(a.default)(e,t)&&(n.value+=o,n.squared+=o*o,n.count++)}t.default=function(e,t,n){var a={count:0,mean:0,variance:0,stdDev:0},r=function e(t,n,a){for(var r={value:0,squared:0,count:0},i=0,l=n.top;l<n.top+n.height;l++)for(var s=n.left;s<n.left+n.width;s++)o(a,{x:s,y:l},r,t[i]),i++;return r}(e,t,n);return 0===r.count||(a.count=r.count,a.mean=r.value/r.count,a.variance=r.squared/r.count-a.mean*a.mean,a.stdDev=Math.sqrt(a.variance)),a}},"./util/freehand/freehandArea.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=0,a=e.length-1;t=t||1;for(var o=0;o<e.length;o++)n+=(e[a].x+e[o].x)*(e[a].y-e[o].y),a=o;return Math.abs(n*t/2)}},"./util/freehand/freehandIntersect.js":function(e,t,n){function a(e,t,n,a){for(var i=e.length-1,l=0;l<e.length;l++){if(-1!==a.indexOf(l)||-1!==a.indexOf(i)){i=l;continue}var s=r(e[i]),u=r(e[l]);if(o(t,n,s,u))return!0;i=l}return!1}function o(e,t,n,a){var o=!1,r=[i(e,t,n),i(e,t,a),i(n,a,e),i(n,a,t)];return r[0]!==r[1]&&r[2]!==r[3]||(0===r[0]&&l(e,n,t)?o=!0:0===r[1]&&l(e,a,t)?o=!0:0===r[2]&&l(n,e,a)?o=!0:0===r[3]&&l(n,t,a)&&(o=!0),o)}function r(e){return{x:e.x,y:e.y}}function i(e,t,n){var a=(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);return 0===a?0:a>0?1:2}function l(e,t,n){return!!(t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y))}n.r(t),t.default={newHandle:function e(t,n){var o=n.length-1,i=r(n[o]),l=r(t);return a(n,i,l,[o])},end:function e(t){var n=t.length-1,o=r(t[n]),i=r(t[0]);return a(t,o,i,[n,0])},modify:function e(t,n){var o=r(t[n]),i=n-1;0===n&&(i=t.length-1);var l=r(t[i]);return!!a(t,o,l,[n,i])||(l=r(t[i=n===t.length-1?0:n+1]),a(t,o,l,[n,i]))}}},"./util/freehand/index.js":function(e,t,n){n.r(t);var a=n(/*! ./calculateFreehandStatistics.js */ "./util/freehand/calculateFreehandStatistics.js"),o=n(/*! ./ClickedLineData.js */ "./util/freehand/ClickedLineData.js"),r=n(/*! ./freehandArea.js */ "./util/freehand/freehandArea.js"),i=n(/*! ./FreehandHandleData.js */ "./util/freehand/FreehandHandleData.js"),l=n(/*! ./freehandIntersect.js */ "./util/freehand/freehandIntersect.js"),s=n(/*! ./FreehandLineFinder.js */ "./util/freehand/FreehandLineFinder.js"),u=n(/*! ./insertOrDelete.js */ "./util/freehand/insertOrDelete.js"),d=n(/*! ./pointInFreehand.js */ "./util/freehand/pointInFreehand.js"),c=n(/*! ./addLine.js */ "./util/freehand/addLine.js");t.default={calculateFreehandStatistics:a.default,ClickedLineData:o.default,freehandArea:r.default,FreehandHandleData:i.default,freehandIntersect:l.default,FreehandLineFinder:s.default,insertOrDelete:u.default,pointInFreehand:d.default,addLine:c.default}},"./util/freehand/insertOrDelete.js":function(e,t,n){n.r(t);var a=n(/*! ./FreehandLineFinder.js */ "./util/freehand/FreehandLineFinder.js"),o=n(/*! ./FreehandHandleData.js */ "./util/freehand/FreehandHandleData.js"),r=n(/*! ../../stateManagement/toolState.js */ "./stateManagement/toolState.js"),i=n(/*! ../../externalModules.js */ "./externalModules.js"),l=n(/*! ./addLine.js */ "./util/freehand/addLine.js");function s(e,t){var n=Object(r.getToolState)(e.element,this.name);if(void 0!==n){var a=t.handleIndex,o=t.toolIndex,l=n.data[o],s=l.handles.points;!(s.length<=3)&&(a===s.length-1?(s[a-1].lines.pop(),s[a-1].lines.push(s[0])):0===a?(s[s.length-1].lines.pop(),s[s.length-1].lines.push(s[a+1])):(s[a-1].lines.pop(),s[a-1].lines.push(s[a+1])),s.splice(a,1),l.invalidated=!0,l.active=!0,l.highlight=!0,i.default.cornerstone.updateImage(e.element))}}function u(e,t){var n=Object(r.getToolState)(e.element,this.name);if(void 0!==n){var a=n.data[t.toolIndex],s=function e(t){for(var n=t.handleIndexArray,a=1/0,o=n.includes(0),r=0;r<n.length;r++){var i=n[r];0!==i&&i<a&&(a=i)}return o&&1===a&&(a=0),++a}(t);if(s!==1/0){var u=new o.default(e.currentPoints.image),d=a.handles.points;d.splice(s,0,u),d[s-1].lines.pop(),d[s-1].lines.push(e.currentPoints.image),Object(l.default)(d,s),a.active=!0,a.highlight=!0,a.invalidated=!0,i.default.cornerstone.updateImage(e.element)}}}t.default=function(e,t){var n=e.detail;if(t&&null!==t.handleNearby){var o={toolIndex:t.toolIndex,handleIndex:t.handleNearby};s.call(this,n,o)}else{var r=new a.default(n,this.name).findLine();r&&u.call(this,n,r)}}},"./util/freehand/pointInFreehand.js":function(e,t,n){n.r(t),t.default=function(e,t){for(var n=!1,o=e.length-1,r=0;r<e.length;r++)a(t,e[r],e[o])&&(n=!n),o=r;return n};function a(e,t,n){var a,o,r;return a=e.y,o=t.y,r=n.y,!!((o<a&&a<r||r<a&&a<o)&&function e(t,n,a){if(n.x>t.x&&a.x>t.x)return!0;if(n.x===a.x)return t.x<n.x;if(n.x>a.x){var o=n;n=a,a=o}var r,i,l,s,u=(r=t,i=n,l=a,s=(l.y-i.y)/(l.x-i.x),{value:i.x+s*(r.x-i.x),gradient:s});return Math.sign(u.gradient)*t.y>u.value}(e,t,n))}},"./util/getActiveTool.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return i});var a=n(/*! ../store */ "./store/index.js"),o=n(/*! ../store/getActiveToolsForElement */ "./store/getActiveToolsForElement.js"),r=n(/*! ../store/filterToolsUsableWithMultiPartTools */ "./store/filterToolsUsableWithMultiPartTools.js");function i(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";if("touch"===i?n=(n=Object(o.default)(e,a.getters.touchTools())).filter(function(e){return e.options.isTouchActive}):(n=(n=Object(o.default)(e,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&t&&e.options.mouseButtonMask.includes(t)&&e.options.isMouseActive}),a.state.isMultiPartToolActive&&(n=Object(r.default)(n))),0!==n.length)return n[0]}},"./util/getDefault.js":function(e,t,n){n.r(t),t.default=function(e,t){return void 0===e?t:e}},"./util/getKeyFromKeyCode.js":function(e,t,n){n.r(t),t.default=function(e){return a[e]};var a={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",13:"RETURN",8:"BACKSPACE",9:"TAB",46:"DELETE",12:"DELETE",27:"ESCAPE",20:"CAPSLOCK",173:"-",189:"-",109:"-",61:"+",187:"+",107:"+",219:"[",221:"]",59:";",186:";",188:",",190:".",199:"/"}},"./util/getLuminance.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n,o,r){if(!e)throw Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,l,s,u=a.default.cornerstone.getEnabledElement(e).image,d=[],c=0,f=u.getPixelData();if(u.color)for(l=0;l<r;l++)for(s=0;s<o;s++){var h=f[i=((l+n)*u.columns+(s+t))*4],m=f[i+1],g=f[i+2];d[c++]=.2126*h+.7152*m+.0722*g}else for(l=0;l<r;l++)for(s=0;s<o;s++)i=(l+n)*u.columns+(s+t),d[c++]=f[i]*u.slope+u.intercept;return d}},"./util/getMaxSimultaneousRequests.js":function(e,t,n){n.r(t),n.d(t,"getDefaultSimultaneousRequests",function(){return s}),n.d(t,"getMaxSimultaneousRequests",function(){return l}),n.d(t,"setMaxSimultaneousRequests",function(){return i}),n.d(t,"getBrowserInfo",function(){return r}),n.d(t,"isMobileDevice",function(){return u});var a,o={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function r(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE ".concat(e[1]||"")):"Chrome"===n[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}function i(e){a=e}function l(){return a||s()}function s(){var e=r().split(" "),t=e[0],n=e[1],a=o[t];return a?a[n]?a[n]:a.default:o.default}function u(){return RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},"./util/getPixelSpacing.js":function(e,t,n){n.r(t),n.d(t,"default",function(){return o});var a=n(/*! ../externalModules */ "./externalModules.js");function o(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId);return t?{rowPixelSpacing:t.rowPixelSpacing||t.rowImagePixelSpacing,colPixelSpacing:t.columnPixelSpacing||t.colImagePixelSpacing}:{rowPixelSpacing:e.rowPixelSpacing,colPixelSpacing:e.columnPixelSpacing}}},"./util/getRGBPixels.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n,o,r){if(!e)throw Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,l,s,u=a.default.cornerstone.getEnabledElement(e),d=[],c=0,f=u.image.getPixelData();if(u.image.color)for(l=0;l<r;l++)for(s=0;s<o;s++){var h=f[i=((l+n)*u.image.columns+(s+t))*4],m=f[i+1],g=f[i+2],v=f[i+3];d[c++]=h,d[c++]=m,d[c++]=g,d[c++]=v}return d}},"./util/getROITextBoxCoords.js":function(e,t,n){function a(e,t){var n,a,o,r,i,l,s=(n=t,a=[n.start,n.end].sort(function e(t,n){return t.x<n.x?-1:1}),o=[n.start,n.end].sort(function e(t,n){return t.y<n.y?-1:1}),r=a[0],i=a[a.length-1],{top:o[0],left:r,bottom:o[o.length-1],right:i}),u=(s.left.x+s.right.x)/2,d=(s.top.y+s.bottom.y)/2,c={};return e.rotation>=0&&e.rotation<90&&(c.x=e.hflip?s.left.x:s.right.x,c.y=d),e.rotation>=90&&e.rotation<180&&(c.x=u,c.y=e.vflip?s.bottom.y:s.top.y),e.rotation>=180&&e.rotation<270&&(c.x=e.hflip?s.right.x:s.left.x,c.y=d),e.rotation>=270&&e.rotation<360&&(c.x=u,c.y=e.vflip?s.top.y:s.bottom.y),c}n.r(t),n.d(t,"default",function(){return a})},"./util/isObject.js":function(e,t,n){n.r(t);var a=n(/*! @babel/runtime/helpers/typeof */ "../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(a);t.default=function e(t){var n=o()(t);return null!==t&&("object"===n||"function"===n)}},"./util/lineSegDistance.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n,o){var r=a.default.cornerstone,i={start:r.pixelToCanvas(e,t),end:r.pixelToCanvas(e,n)};return a.default.cornerstoneMath.lineSegment.distanceToPoint(i,o)}},"./util/logger.js":function(e,t,n){n.r(t),n.d(t,"getLogger",function(){return i}),n.d(t,"enable",function(){return l}),n.d(t,"disable",function(){return s});var a=n(/*! ./debugLib/index.js */ "./util/debugLib/index.js"),o="cornerstoneTools",r=Object(a.default)(o);r.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var i=function e(t){var n;return{log:r.extend(t),warn:console.warn.bind(console),error:console.error.bind(console)}},l=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(o,":*");return a.default.enable(t)},s=function e(){return a.default.disable()}},"./util/makeUnselectable.js":function(e,t,n){n.r(t),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(e,t,n){n.r(t),t.default=function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},"./util/pointInsideBoundingBox.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t){if(e.boundingBox)return a.default.cornerstoneMath.point.insideRect(t,e.boundingBox)}},"./util/pointProjector.js":function(e,t,n){n.r(t),n.d(t,"projectPatientPointToImagePlane",function(){return r}),n.d(t,"imagePointToPatientPoint",function(){return i}),n.d(t,"planePlaneIntersection",function(){return l}),n.d(t,"rotatePoint",function(){return s});var a=n(/*! ../externalModules.js */ "./externalModules.js"),o=n(/*! ../util/convertToVector3.js */ "./util/convertToVector3.js");function r(e,t){var n=Object(o.default)(t.rowCosines),a=Object(o.default)(t.columnCosines),r=Object(o.default)(t.imagePositionPatient),i=e.clone().sub(r),l=n.dot(i)/t.columnPixelSpacing,s=a.dot(i)/t.rowPixelSpacing;return{x:l,y:s}}function i(e,t){var n=Object(o.default)(t.rowCosines),a=Object(o.default)(t.columnCosines),r=Object(o.default)(t.imagePositionPatient),i=n.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var l=a.clone().multiplyScalar(e.y);l.multiplyScalar(t.rowPixelSpacing);var s=i.add(l);return s.add(r),s}function l(e,t){var n=Object(o.default)(e.rowCosines),r=Object(o.default)(e.columnCosines),l=Object(o.default)(e.imagePositionPatient),s=Object(o.default)(t.rowCosines),u=Object(o.default)(t.columnCosines),d=Object(o.default)(t.imagePositionPatient),c=n.clone().cross(r),f=new a.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(c,l);var h=s.clone().cross(u),m=new a.default.cornerstoneMath.Plane;m.setFromNormalAndCoplanarPoint(h,d);var g,v,$,p,_,y=m.clone().intersectPlane(f),x=y.origin,T=y.direction,b=i({x:t.columns,y:t.rows},t),w=d.distanceTo(b),C=new a.default.cornerstoneMath.Line3;C.start=x,C.end=x.clone().add(T.multiplyScalar(w));var E,j,S,I=(g=t,v=i({x:0,y:0},g),$=i({x:g.columns,y:0},g),p=i({x:0,y:g.rows},g),_=i({x:g.columns,y:g.rows},g),{top:new a.default.cornerstoneMath.Line3(v,$),left:new a.default.cornerstoneMath.Line3(v,p),right:new a.default.cornerstoneMath.Line3($,_),bottom:new a.default.cornerstoneMath.Line3(p,_)}),P=(E=C,j=I,S=[],Object.keys(j).forEach(function(e){var t=j[e],n=E.intersectLine(t);n&&S.push(n)}),S);if(2===P.length)return{start:P[0],end:P[1]}}function s(e,t,n){var a=n*(Math.PI/180),o=Math.cos(a)*(e.x-t.x)-Math.sin(a)*(e.y-t.y)+t.x,r=Math.sin(a)*(e.x-t.x)+Math.cos(a)*(e.y-t.y)+t.y;return{x:o,y:r}}},"./util/roundToDecimal.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},"./util/scroll.js":function(e,t,n){n.r(t);var a=n(/*! ./scrollToIndex.js */ "./util/scrollToIndex.js"),o=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),r=n(/*! ./clip.js */ "./util/clip.js"),i=n(/*! ./../externalModules.js */ "./externalModules.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=Object(o.getToolState)(e,"stack");if(s&&s.data&&s.data.length){var u=s.data[0];u.pending||(u.pending=[]);var d=u.currentImageIdIndex+t;if(n?d%=u.imageIds.length:d=Object(r.default)(d,0,u.imageIds.length-1),l)Object(a.default)(e,d);else{var c={index:d};u.pending.push(c),function e(t,n,o){if(t.pending[0]===n){if(t.currentImageIdIndex===n.index){t.pending.splice(t.pending.indexOf(n),1),t.pending.length>0&&e(t,t.pending[0],o);return}var r=function a(r){t.imageIds.indexOf(r.detail.image.imageId)===n.index&&(t.pending.splice(t.pending.indexOf(n),1),o.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,a),t.pending.length>0&&e(t,t.pending[0],o))};o.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,r),Object(a.default)(o,n.index)}}(u,c,e)}}}},"./util/scrollToIndex.js":function(e,t,n){n.r(t);var a=n(/*! ../events.js */ "./events.js"),o=n(/*! ../externalModules.js */ "./externalModules.js"),r=n(/*! ../stateManagement/toolState.js */ "./stateManagement/toolState.js"),i=n(/*! ../requestPool/requestPoolManager.js */ "./requestPool/requestPoolManager.js"),l=n(/*! ../stateManagement/loadHandlerManager.js */ "./stateManagement/loadHandlerManager.js"),s=n(/*! ../util/triggerEvent.js */ "./util/triggerEvent.js");t.default=function(e,t){var n,u,d=Object(r.getToolState)(e,"stack");if(d&&d.data&&d.data.length){var c=o.default.cornerstone;if(d.data.length>1){var f=Object(r.getToolState)(e,"stackRenderer");f&&f.data&&f.data.length&&(n=f.data[0])}var h=d.data[0];t<0&&(t+=h.imageIds.length);var m=l.default.getStartLoadHandler(e),g=l.default.getEndLoadHandler(e),v=l.default.getErrorLoadingHandler(e);if(t!==h.currentImageIdIndex){m&&m(e);var $={newImageIdIndex:t,direction:t-h.currentImageIdIndex};h.currentImageIdIndex=t;var p=h.imageIds[t];(u=Boolean(h.preventCache)?c.loadImage(p):c.loadAndCacheImage(p)).then(function a(o){if(h.currentImageIdIndex===t){try{c.getEnabledElement(e)}catch(r){return}n?(n.currentImageIdIndex=t,n.render(e,d.data)):c.displayImage(e,o),g&&g(e,o)}},function n(a){var o=h.imageIds[t];v&&v(e,o,a)}),i.default.startGrabbing(),Object(s.default)(e,a.default.STACK_SCROLL,$)}}}},"./util/setContextToDisplayFontSize.js":function(e,t,n){n.r(t);var a=n(/*! ../externalModules.js */ "./externalModules.js");t.default=function(e,t,n){var o;return a.default.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:n/e.viewport.scale/.1,lineHeight:n/e.viewport.scale/.1,fontScale:.1}}},"./util/throttle.js":function(e,t,n){n.r(t);var a=n(/*! ./debounce.js */ "./util/debounce.js"),o=n(/*! ./isObject.js */ "./util/isObject.js");t.default=function e(t,n,r){var i=!0,l=!0;if("function"!=typeof t)throw TypeError("Expected a function");return Object(o.default)(r)&&(i="leading"in r?Boolean(r.leading):i,l="trailing"in r?Boolean(r.trailing):l),Object(a.default)(t,n,{leading:i,trailing:l,maxWait:n})}},"./util/triggerEvent.js":function(e,t,n){function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./util/wait.js":function(e,t,n){n.r(t),n.d(t,"wait",function(){return o}),n.d(t,"waitForEnabledElementImageToLoad",function(){return function e(t){try{var n=a.default.cornerstone.getEnabledElement(t);if(!n.image)return o(250).then(function(){return e(t)});return n}catch(r){return null}}});var a=n(/*! ./../externalModules.js */ "./externalModules.js"),o=function e(t){return new Promise(function(e){return setTimeout(e,t)})};t.default=o},"./util/zoom/changeViewportScale.js":function(e,t,n){n.r(t),t.default=function(e,t,n){var a,o=n.maxScale,r=n.minScale,i=Math.pow(1.7,Math.log(e.scale)/Math.log(1.7)+t);return o&&i>o?e.scale=o:r&&i<r?e.scale=r:e.scale=i,e}},"./util/zoom/correctShift.js":function(e,t,n){n.r(t),t.default=function(e,t){var n=t.hflip,a=t.vflip,o=t.rotation;if(e.x*=n?-1:1,e.y*=a?-1:1,0!==o){var r=o*Math.PI/180,i=Math.cos(r),l=Math.sin(r),s=e.x*i-e.y*l,u=e.x*l+e.y*i;e.x=s,e.y=u}return e}},"./util/zoom/index.js":function(e,t,n){n.r(t);var a=n(/*! ./changeViewportScale.js */ "./util/zoom/changeViewportScale.js");n.d(t,"changeViewportScale",function(){return a.default});var o=n(/*! ./correctShift.js */ "./util/zoom/correctShift.js");n.d(t,"correctShift",function(){return o.default}),t.default={changeViewportScale:a.default,correctShift:o.default}},"./version.js":function(e,t,n){n.r(t),t.default="3.19.3"}})},u.exports=c(),E.exports),S=t(j),I=function(){return(I=Object.assign||function e(t){for(var n,a=1,o=arguments.length;a<o;a++)for(var r in n=arguments[a])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},P={channel:4,width:null,height:null,schema:"base64://"},M=function(){function e(e,t){void 0===t&&(t=P),this._cornerstone=e,this._options=t,this._lastImageIdDrawn=null,this._UPNG=null,this._canvas=document.createElement("canvas"),this.arrayBufferToImage=this.arrayBufferToImage.bind(this),this.getArrayBuffer=this.getArrayBuffer.bind(this),this.decodeBase64=this.decodeBase64.bind(this),this.createImage=this.createImage.bind(this),this.imageLoader=this.imageLoader.bind(this),this.replaceImage=this.replaceImage.bind(this)}return e.prototype.arrayBufferToImage=function(e){return new Promise(function(t,n){var a=new Image,o=new Uint8Array(e),r=new Blob([o]),i=window.URL||window.webkitURL,l=i.createObjectURL(r);a.src=l,a.onload=function(){i.revokeObjectURL(l),t(a)},a.onerror=function(e){i.revokeObjectURL(l),n(e)}})},e.prototype.getArrayBuffer=function(e){var t=new ArrayBuffer(e.length),n=new Uint8Array(t);return Array.from(e).map(function(e,t){return n[t]=e.charCodeAt(0),e}),n},e.prototype.decodeBase64=function(e){var t=window.atob(e);return this.getArrayBuffer(t)},e.prototype.createImage=function(e,t){var n=this,a=e.naturalHeight,o=e.naturalWidth,r=function(){var a;return n._lastImageIdDrawn===t?a=n._canvas.getContext("2d"):(n._canvas.height=e.naturalHeight,n._canvas.width=e.naturalWidth,(a=n._canvas.getContext("2d")).drawImage(e,0,0),n._lastImageIdDrawn=t),a.getImageData(0,0,e.naturalWidth,e.naturalHeight)},i=function(){return r().data},l=function(){return n._lastImageIdDrawn===t?n._canvas:(n._canvas.height=e.naturalHeight,n._canvas.width=e.naturalWidth,n._canvas.getContext("2d").drawImage(e,0,0),n._lastImageIdDrawn=t,n._canvas)},s=function(e){void 0===e&&(e=null),n._lastImageIdDrawn=e};return{imageId:t,minPixelValue:0,maxPixelValue:255,slope:1,intercept:0,windowCenter:128,windowWidth:255,render:this.cornerstone.renderWebImage,getPixelData:i,getCanvas:l,getImage:function(){return e},setLastImageIdDrawn:s,rows:a,columns:o,height:a,width:o,color:!0,rgba:!1,columnPixelSpacing:null,rowPixelSpacing:null,invert:!1,sizeInBytes:a*o*this._options.channel}},e.prototype.imageLoader=function(e){var t,n=this,a=e.replace(this._options.schema,"");if(this._options.width&&this._options.height&&this._UPNG){var o=this._options.width,r=this._options.height;t=new Uint8Array(o*r*this._options.channel),t=this._UPNG.encode([t.buffer],o,r,0)}else t=this.decodeBase64(a);var i=this.arrayBufferToImage(t);return{promise:new Promise(function(t,a){i.then(function(a){var o;t(n.createImage(a,e))},a)})}},e.prototype.replaceImage=function(e,t){var n=this;if(!this._UPNG)return null;var a=this._UPNG.encode([t.buffer],e.image.columns,e.image.rows,0);return this.arrayBufferToImage(a).then(function(t){e.image=n.createImage(t,e.image.imageId)})},Object.defineProperty(e.prototype,"options",{get:function(){return I({},this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cornerstone",{get:function(){return this._cornerstone},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UPNG",{get:function(){return this._UPNG},enumerable:!0,configurable:!0}),e.prototype.setUPNG=function(e){this._UPNG=e},e.prototype.registerLoaders=function(){this.cornerstone.registerImageLoader("base64",this.imageLoader)},e}(),k=I({},P),D={external:{set cornerstone(cs){(v=new M(cs,k)).registerLoaders()},get cornerstone(){return v.cornerstone}}};S.external.cornerstoneMath=_,S.external.Hammer=T,S.external.cornerstone=C,D.external.cornerstone=C,S.init();class L{constructor(e,t="Reset W/L",n="Reset Zoom",a="Reset Pan",o="Reset Rotation",r="Reset All"){this.viewportOriginal=null,this.originalWindowWidth=null,this.originalWindowCenter=null,this.originalScale=null,this.originalTranslation=null,this.originalRotation=null;let i=document.querySelector(e);if(!i||!(i instanceof HTMLDivElement))throw Error(`Element "${e}" not found or is not a <div> element.`);i.addEventListener("contextmenu",function(e){e.preventDefault()}),this.element=document.createElement("div"),this.element.style.width="100%",this.element.style.height="90%",this.resetWLButton=document.createElement("button"),this.resetWLButton.innerText=t,this.resetWLButton.style.marginTop="10px",this.resetWLButton.style.padding="8px 12px",this.resetWLButton.style.cursor="pointer",this.resetWLButton.addEventListener("click",()=>this.resetWLEffect()),this.resetZoomButton=document.createElement("button"),this.resetZoomButton.innerText=n,this.resetZoomButton.style.marginTop="10px",this.resetZoomButton.style.padding="8px 12px",this.resetZoomButton.style.cursor="pointer",this.resetZoomButton.addEventListener("click",()=>this.resetZoomEffect()),this.resetPanButton=document.createElement("button"),this.resetPanButton.innerText=a,this.resetPanButton.style.marginTop="10px",this.resetPanButton.style.padding="8px 12px",this.resetPanButton.style.cursor="pointer",this.resetPanButton.addEventListener("click",()=>this.resetPanEffect()),this.resetRotationButton=document.createElement("button"),this.resetRotationButton.innerText=o,this.resetRotationButton.style.marginTop="10px",this.resetRotationButton.style.padding="8px 12px",this.resetRotationButton.style.cursor="pointer",this.resetRotationButton.addEventListener("click",()=>this.resetRotationEffect()),this.resetAllButton=document.createElement("button"),this.resetAllButton.innerText=r,this.resetAllButton.style.marginTop="10px",this.resetAllButton.style.padding="8px 12px",this.resetAllButton.style.cursor="pointer",this.resetAllButton.addEventListener("click",()=>this.resetAllEffect()),i.appendChild(this.element),i.appendChild(this.resetWLButton),i.appendChild(this.resetZoomButton),i.appendChild(this.resetPanButton),i.appendChild(this.resetRotationButton),i.appendChild(this.resetAllButton),this.initializeViewer()}initializeViewer(){C.enable(this.element);let e=S.ZoomMouseWheelTool;S.addTool(e),S.setToolActive("ZoomMouseWheel",{mouseButtonMask:1});let t=S.PanTool;S.addTool(t),S.setToolActive("Pan",{mouseButtonMask:1});let n=S.WwwcTool;S.addTool(n),S.setToolActive("Wwwc",{mouseButtonMask:2});let a=S.RotateTool;S.addTool(a),S.setToolActive("Rotate",{mouseButtonMask:4})}loadImage(e){var t,n,a,o;return t=this,n=void 0,a=void 0,o=function*(){try{let t=yield C.loadImage(e);C.displayImage(this.element,t),this.viewportOriginal=C.getViewport(this.element),this.originalWindowWidth=t.windowWidth,this.originalWindowCenter=t.windowCenter,this.originalScale=this.viewportOriginal.scale,this.originalRotation=this.viewportOriginal.rotation,null!=this.viewportOriginal.translation?this.originalTranslation={x:this.viewportOriginal.translation.x,y:this.viewportOriginal.translation.y}:console.error("Could not initialize translation.x and translation.y positions, because viewportOriginal.translation is null.")}catch(n){console.error("Error loading image:",n)}},new(a||(a=Promise))(function(e,r){function i(e){try{s(o.next(e))}catch(t){r(t)}}function l(e){try{s(o.throw(e))}catch(t){r(t)}}function s(t){var n;t.done?e(t.value):((n=t.value)instanceof a?n:new a(function(e){e(n)})).then(i,l)}s((o=o.apply(t,n||[])).next())})}resetWLEffect(){let e=C.getViewport(this.element);e?(null!=this.originalWindowWidth&&null!=this.originalWindowCenter&&(e.voi.windowWidth=this.originalWindowWidth,e.voi.windowCenter=this.originalWindowCenter),C.setViewport(this.element,e)):console.error("Tried to reset W/L effect, but current viewport is null!")}resetZoomEffect(){let e=C.getViewport(this.element);e?(null!=this.originalScale&&(e.scale=this.originalScale),C.setViewport(this.element,e)):console.error("Tried to reset scale parameter, but current viewport is null!")}resetPanEffect(){let e=C.getViewport(this.element);e?null!=this.originalTranslation?(null!=this.originalTranslation.x&&(e.translation.x=this.originalTranslation.x),null!=this.originalTranslation.y&&(e.translation.y=this.originalTranslation.y),C.setViewport(this.element,e)):console.error("Could not reset translation, because the old translation settings are null!"):console.error("Tried to reset translation parameter, but current viewport is null!")}resetRotationEffect(){let e=C.getViewport(this.element);e?(null!=this.originalScale&&(e.rotation=this.originalRotation),C.setViewport(this.element,e)):console.error("Tried to reset translation parameter, but current viewport is null!")}resetAllEffect(){let e=C.getViewport(this.element);e?(this.resetZoomEffect(),this.resetPanEffect(),this.resetRotationEffect(),this.resetWLEffect()):console.error("Tried to reset all tool parameters, but current viewport is null!")}}"undefined"!=typeof window&&(window.MedicalImageViewer=L),e.MedicalImageViewer=L});